//>>built
require({cache:{"widgets/Print/Print":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin esri/tasks/PrintTask esri/tasks/PrintParameters esri/tasks/PrintTemplate esri/request dojo/_base/lang dojo/_base/array dojo/_base/html dojo/dom-style dojo/dom-construct dojo/dom-class dojo/json jimu/portalUrlUtils dojo/text!./templates/Print.html dojo/text!./templates/PrintResult.html dojo/aspect jimu/LayerInfos/LayerInfos jimu/dijit/LoadingShelter jimu/dijit/Message dijit/form/Form dijit/form/Select dijit/form/ValidationTextBox dijit/form/NumberTextBox dijit/form/Button dijit/form/CheckBox dijit/ProgressBar dijit/form/DropDownButton dijit/TooltipDialog dijit/form/RadioButton esri/IdentityManager dojo/store/Memory".split(" "),
function(e,l,m,n,s,k,h,f,d,b,g,a,c,q,G,w,t,r,B,v,x,D){t=e([l,m,n],{widgetsInTemplate:!0,templateString:t,map:null,count:1,results:[],authorText:null,copyrightText:null,defaultTitle:null,defaultFormat:null,defaultLayout:null,baseClass:"gis_PrintDijit",pdfIcon:require.toUrl("./widgets/Print/images/pdf.png"),imageIcon:require.toUrl("./widgets/Print/images/image.png"),printTaskURL:null,printTask:null,async:!1,postCreate:function(){this.inherited(arguments);var a="json";this.printTask=new s(this.printTaskURL,
{async:this.async});this.printparams=new k;this.printparams.map=this.map;this.printparams.outSpatialReference=this.map.spatialReference;this.shelter=new x({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this.shelter.show();this.titleNode.set("value",this.defaultTitle);this.authorNode.set("value",this.defaultAuthor);this.copyrightNode.set("value",this.defaultCopyright);var b=w.setHttpProtocol(this.printTaskURL),f=w.getNewPrintUrl(this.appConfig.portalUrl);if(b===f||/sharing\/tools\/newPrint$/.test(b))a=
"text";v.getInstance(this.map,this.map.itemInfo).then(d.hitch(this,function(b){this.layerInfosObj=b;return this._getPrintTaskInfo(a)})).always(d.hitch(this,function(){this.shelter.hide()}));this.printTask._getPrintDefinition&&B.after(this.printTask,"_getPrintDefinition",d.hitch(this,"printDefInspector"),!1);this.printTask._createOperationalLayers&&B.after(this.printTask,"_createOperationalLayers",d.hitch(this,"_excludeInvalidLegend"))},_getPrintTaskInfo:function(a){return f({url:this.printTaskURL,
content:{f:"json"},callbackParamName:"callback",handleAs:a||"json",timeout:6E4}).then(d.hitch(this,"_handlePrintInfo"),d.hitch(this,"_handleError"))},_excludeInvalidLegend:function(a){function f(a){return b.filter(a.subLayerIds,d.hitch(this,function(u){return(u=this.layerInfosObj.getLayerInfoById(a.id+"_"+u))&&u.getShowLegendOfWebmap()}))}if(this.printTask.allLayerslegend){for(var c=this.printTask.allLayerslegend,y=[],h=0;h<c.length;h++){var F=c[h],g=this.map.getLayer(F.id),k=this.layerInfosObj.getLayerInfoById(F.id),
q=g&&g.declaredClass&&"esri.layers.GraphicsLayer"!==g.declaredClass,g=!g.renderer||g.renderer&&!g.renderer.hasVisualVariables(),k=k&&k.getShowLegendOfWebmap();q&&(g&&k)&&(F.subLayerIds&&(F.subLayerIds=d.hitch(this,f,F)()),y.push(F))}this.printTask.allLayerslegend=y}return a},printDefInspector:function(a){"force"===this.preserve.preserveScale&&(a.mapOptions.scale=this.preserve.forcedScale);return a},_handleError:function(a){console.log("print widget load error: ",a);new D({message:a.message||a})},
_handlePrintInfo:function(A){var d=null;try{if(d="string"===typeof A?G.parse(A):A,d.error&&d.error.code){this._getPrintTaskInfo("json");return}}catch(f){d=w.setHttpProtocol(this.printTaskURL);A=w.getNewPrintUrl(this.appConfig.portalUrl);d===A||/sharing\/tools\/newPrint$/.test(d)?(a.set(this.layoutDijit.domNode.parentNode.parentNode,"display","none"),a.set(this.formatDijit.domNode.parentNode.parentNode,"display","none"),a.set(this.advancedButtonDijit.domNode,"display","none")):this._handleError(f);
return}a.set(this.layoutDijit.domNode.parentNode.parentNode,"display","");a.set(this.formatDijit.domNode.parentNode.parentNode,"display","");a.set(this.advancedButtonDijit.domNode,"display","");A=b.filter(d.parameters,function(a){return"Layout_Template"===a.name});if(0===A.length)console.log('print service parameters name for templates must be "Layout_Template"');else{var y=b.map(A[0].choiceList,function(a){return{label:a,value:a}});y.sort(function(a,b){return a.label>b.label?1:b.label>a.label?-1:
0});this.layoutDijit.addOption(y);this.defaultLayout?this.layoutDijit.set("value",this.defaultLayout):this.layoutDijit.set("value",A[0].defaultValue);d=b.filter(d.parameters,function(a){return"Format"===a.name});0===d.length?console.log('print service parameters name for format must be "Format"'):(A=b.map(d[0].choiceList,function(a){return{label:a,value:a}}),A.sort(function(a,b){return a.label>b.label?1:b.label>a.label?-1:0}),this.formatDijit.addOption(A),this.defaultFormat?this.formatDijit.set("value",
this.defaultFormat):this.formatDijit.set("value",d[0].defaultValue))}},print:function(){if(this.printSettingsFormDijit.isValid()){var b=this.printSettingsFormDijit.get("value");d.mixin(b,this.layoutMetadataDijit.get("value"));this.preserve=this.preserveFormDijit.get("value");d.mixin(b,this.preserve);this.layoutForm=this.layoutFormDijit.get("value");var f=this.mapQualityFormDijit.get("value"),c=this.mapOnlyFormDijit.get("value");d.mixin(c,f);f=new h;f.format=b.format;f.layout=b.layout;f.preserveScale=
"true"===b.preserveScale||"force"===b.preserveScale;f.label=b.title;f.exportOptions=c;f.layoutOptions={authorText:b.author,copyrightText:b.copyright,legendLayers:0<this.layoutForm.legend.length&&this.layoutForm.legend[0]?null:[],titleText:b.title};this.printparams.template=f;this.printparams.extraParameters={printFlag:!0};c=this.printTask.execute(this.printparams);(new E({count:this.count.toString(),icon:"PDF"===b.format?this.pdfIcon:this.imageIcon,docName:b.title,title:b.format+", "+b.layout,fileHandle:c,
nls:this.nls})).placeAt(this.printResultsNode,"last").startup();a.set(this.clearActionBarNode,"display","block");this.count++}else this.printSettingsFormDijit.validate()},clearResults:function(){c.empty(this.printResultsNode);a.set(this.clearActionBarNode,"display","none");this.count=1},updateAuthor:function(a){(a=a||"")&&this.authorTB.set("value",a)},getCurrentMapScale:function(){this.forceScaleNTB.set("value",this.map.getScale())}});var E=e([l,m,n],{widgetsInTemplate:!0,templateString:r,url:null,
postCreate:function(){this.inherited(arguments);this.fileHandle.then(d.hitch(this,"_onPrintComplete"),d.hitch(this,"_onPrintError"))},_onPrintComplete:function(a){a.url?(this.url=a.url,g.setStyle(this.progressBar.domNode,"display","none"),g.setStyle(this.successNode,"display","inline-block"),q.add(this.resultNode,"printResultHover")):this._onPrintError(this.nls.printError)},_onPrintError:function(a){console.log(a);g.setStyle(this.progressBar.domNode,"display","none");g.setStyle(this.errNode,"display",
"block");q.add(this.resultNode,"printResultError");g.setAttr(this.domNode,"title",a.details||a.message||"")},_openPrint:function(){null!==this.url&&window.open(this.url)}});return t})},"esri/tasks/PrintTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/Deferred dojo/has ../kernel ../lang ../layerUtils ../deferredUtils ../Color ./Task ../geometry/Polygon ../renderers/SimpleRenderer ../geometry/scaleUtils ../symbols/FillSymbol ./Geoprocessor ./PrintTemplate dojo/dom-attr dojo/dom-construct dojox/gfx/_base dojox/gfx/canvas dojox/json/query require require".split(" "),
function(e,l,m,n,s,k,h,f,d,b,g,a,c,q,G,w,t,r,B,v,x,D,E){return e(a,{declaredClass:"esri.tasks.PrintTask",constructor:function(a,b){this.url=a;this.printGp=new t(this.url);this._handler=l.hitch(this,this._handler);b&&b.async&&(this.async=b.async);this._colorEvaluator=E("$..color")},_handler:function(a,b,d,y,f){try{var c;this.async?"esriJobSucceeded"===a.jobStatus&&this.printGp.getResultData(a.jobId,"Output_File",l.hitch(this,function(a){c=a.value;this._successHandler([c],"onComplete",d,f)})):(c=a[0].value,
this._successHandler([c],"onComplete",d,f))}catch(h){this._errorHandler(h,y,f)}},execute:function(a,d,c){var y=this._handler,h=this._errorHandler,g=a.template||new r,k=g.exportOptions,q;k&&(q={outputSize:[k.width,k.height],dpi:k.dpi});var k=g.layoutOptions,e,t=[];if(k){this.legendAll=!1;k.legendLayers?m.forEach(k.legendLayers,function(a){var z={};z.id=a.layerId;a.subLayerIds&&(z.subLayerIds=a.subLayerIds);t.push(z)}):this.legendAll=!0;var u,C;if("Miles"===k.scalebarUnit||"Kilometers"===k.scalebarUnit)u=
"esriKilometers",C="esriMiles";else if("Meters"===k.scalebarUnit||"Feet"===k.scalebarUnit)u="esriMeters",C="esriFeet";e={esriMiles:"mi",esriKilometers:"km",esriFeet:"ft",esriMeters:"m"};e={titleText:k.titleText,authorText:k.authorText,copyrightText:k.copyrightText,customTextElements:k.customTextElements,scaleBarOptions:{metricUnit:u,metricLabel:e[u],nonMetricUnit:C,nonMetricLabel:e[C]},legendOptions:{operationalLayers:t}}}u=this._getPrintDefinition(a.map,g);a.outSpatialReference&&(u.mapOptions.spatialReference=
a.outSpatialReference.toJson());a.template&&f.isDefined(a.template.showAttribution)&&(u.mapOptions.showAttribution=a.template.showAttribution);l.mixin(u,{exportOptions:q,layoutOptions:e});this.allLayerslegend&&l.mixin(u.layoutOptions,{legendOptions:{operationalLayers:this.allLayerslegend}});g={Web_Map_as_JSON:n.toJson(f.fixJson(u)),Format:g.format,Layout_Template:g.layout};a.extraParameters&&(g=l.mixin(g,a.extraParameters));var z=new s(b._dfdCanceller);a=function(a,u){y(a,u,d,c,z)};q=function(a){h(a,
c,z)};z._pendingDfd=this.async?this.printGp.submitJob(g,a,null,q):this.printGp.execute(g,a,q);return z},onComplete:function(){},_createMultipointLayer:function(){return{layerDefinition:{name:"multipointLayer",geometryType:"esriGeometryMultipoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryMultipoint",features:[]}}},_createPolygonLayer:function(){return{layerDefinition:{name:"polygonLayer",geometryType:"esriGeometryPolygon",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolygon",
features:[]}}},_createPointLayer:function(){return{layerDefinition:{name:"pointLayer",geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}}},_createPolylineLayer:function(){return{layerDefinition:{name:"polylineLayer",geometryType:"esriGeometryPolyline",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolyline",features:[]}}},_convertSvgSymbol:function(a){if(!(8>=k("ie"))&&a.path){this._canvasHolder||(this._canvasHolder=
v.create("div"),this._canSurface=D.createSurface(this._canvasHolder,200,200));var b=this._canSurface.createObject(D.Path,a.path).setFill(a.color).setStroke(a.outline);"pendingRender"in this._canSurface&&this._canSurface._render(!0);var d=this._canSurface.rawNode.getContext("2d"),y=Math.ceil(b.getBoundingBox().width+b.getBoundingBox().x),f=Math.ceil(b.getBoundingBox().height+b.getBoundingBox().y),c=d.getImageData(b.getBoundingBox().x,b.getBoundingBox().y,y,f);d.canvas.width=y;d.canvas.height=f;d.putImageData(c,
0,0);d=d.canvas.toDataURL("image/png");return{type:"esriPMS",imageData:d.substr(22,d.length),angle:-a.angle,contentType:"image/png",height:a.size?a.size:f-b.getBoundingBox().y,width:a.size?a.size:y-b.getBoundingBox().x,xoffset:a.xoffset,yoffset:a.yoffset}}},_convertSvgRenderer:function(a){"simple"===a.type&&a.symbol&&a.symbol.path?a.symbol=this._convertSvgSymbol(a.symbol):"uniqueValue"===a.type?(a.defaultSymbol&&a.defaultSymbol.path&&(a.defaultSymbol=this._convertSvgSymbol(a.defaultSymbol)),a.uniqueValueInfos&&
m.forEach(a.uniqueValueInfos,function(a){a.symbol.path&&(a.symbol=this._convertSvgSymbol(a.symbol))},this)):"classBreaks"===a.type&&(a.defaultSymbol&&a.defaultSymbol.path&&(a.defaultSymbol=this._convertSvgSymbol(a.defaultSymbol)),a.classBreakInfos&&m.forEach(a.classBreakInfos,function(a){a.symbol.path&&(a.symbol=this._convertSvgSymbol(a.symbol))},this))},_createFeatureCollection:function(a,b,d){var y=this._createPolygonLayer(),f=this._createPolylineLayer(),h=this._createPointLayer(),g=this._createMultipointLayer(),
k=this._createPointLayer();k.layerDefinition.name="textLayer";delete k.layerDefinition.drawingInfo;if("esri.layers.FeatureLayer"===a.declaredClass||"esri.layers.StreamLayer"===a.declaredClass)y.layerDefinition.name=f.layerDefinition.name=h.layerDefinition.name=g.layerDefinition.name=l.getObject("arcgisProps.title",!1,a)||a.name||a.id;if(a.renderer&&!l.isFunction(a.renderer.attributeField)){var q=a.renderer.toJson();if("temporal"===q.type){var q={latestObservationRenderer:q.latestObservationRenderer,
trackLinesRenderer:q.trackRenderer,observationAger:q.observationAger,renderer:q.observationRenderer},e={};a._trackIdField&&(e.trackIdField=a._trackIdField);a._startTimeField&&(e.startTimeField=a._startTimeField);a._endTimeField&&(e.endTimeField=a._endTimeField);y.layerDefinition.drawingInfo=q;y.layerDefinition.timeInfo=e;f.layerDefinition.drawingInfo=q;f.layerDefinition.timeInfo=e;h.layerDefinition.drawingInfo=q;h.layerDefinition.timeInfo=e;g.layerDefinition.drawingInfo=q;g.layerDefinition.timeInfo=
e}else y.layerDefinition.drawingInfo.renderer=q,f.layerDefinition.drawingInfo.renderer=q,h.layerDefinition.drawingInfo.renderer=q,g.layerDefinition.drawingInfo.renderer=q}else delete y.layerDefinition.drawingInfo,delete f.layerDefinition.drawingInfo,delete h.layerDefinition.drawingInfo,delete g.layerDefinition.drawingInfo;q=a.fields;!q&&(a.renderer&&!l.isFunction(a.renderer.attributeField))&&("esri.renderer.ClassBreaksRenderer"===a.renderer.declaredClass?(q=[{name:a.renderer.attributeField,type:"esriFieldTypeDouble"}],
a.renderer.normalizationField&&q.push({name:a.renderer.normalizationField,type:"esriFieldTypeDouble"})):"esri.renderer.UniqueValueRenderer"===a.renderer.declaredClass&&(q=[{name:a.renderer.attributeField,type:"esriFieldTypeString"}],a.renderer.attributeField2&&q.push({name:a.renderer.attributeField2,type:"esriFieldTypeString"}),a.renderer.attributeField3&&q.push({name:a.renderer.attributeField3,type:"esriFieldTypeString"})));q&&(y.layerDefinition.fields=q,f.layerDefinition.fields=q,h.layerDefinition.fields=
q,g.layerDefinition.fields=q);var q=a.graphics.length,u;for(u=0;u<q;u++){var C=a.graphics[u];if(!1!==C.visible&&C.geometry&&(e=C.toJson(),!e.symbol||!(e.symbol.outline&&"esriCLS"===e.symbol.outline.type))){e.symbol&&(e.symbol.outline&&e.symbol.outline.color&&e.symbol.outline.color[3])&&(e.symbol.outline.color[3]=255);if(a.renderer&&!e.symbol&&(l.isFunction(a.renderer.attributeField)||a.renderer.hasVisualVariables()||"esri.renderer.DotDensityRenderer"===a.renderer.declaredClass||d)){d=d||a.renderer;
var z=d.getSymbol(C);if(!z)continue;e.symbol=z.toJson();d.hasVisualVariables()&&this._applyVisualVariables(e.symbol,{renderer:d,graphic:C,symbol:z,mapResolution:b&&b.getResolutionInMeters(),mapScale:b&&b.getScale()})}e.symbol&&(e.symbol.path?e.symbol=this._convertSvgSymbol(e.symbol):e.symbol.text&&delete e.attributes);switch(C.geometry.type){case "polygon":y.featureSet.features.push(e);break;case "polyline":f.featureSet.features.push(e);break;case "point":e.symbol&&e.symbol.text?k.featureSet.features.push(e):
h.featureSet.features.push(e);break;case "multipoint":g.featureSet.features.push(e);break;case "extent":e.geometry=c.fromExtent(C.geometry).toJson(),y.featureSet.features.push(e)}}}b=[];0<y.featureSet.features.length&&b.push(y);0<f.featureSet.features.length&&b.push(f);0<g.featureSet.features.length&&b.push(g);0<h.featureSet.features.length&&b.push(h);0<k.featureSet.features.length&&b.push(k);m.forEach(b,function(a){a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.renderer&&this._convertSvgRenderer(a.layerDefinition.drawingInfo.renderer)},
this);return{id:a.id,opacity:a.opacity,minScale:a.minScale||0,maxScale:a.maxScale||0,featureCollection:{layers:b}}},_getPrintDefinition:function(a,b){var d={operationalLayers:this._createOperationalLayers(a,b)},f=a.extent,c=a.spatialReference;a.spatialReference._isWrappable()&&(f=f._normalize(!0),c=f.spatialReference);f={mapOptions:{showAttribution:a.showAttribution,extent:f.toJson(),spatialReference:c.toJson()}};b.preserveScale&&l.mixin(f.mapOptions,{scale:b.outScale||G.getScale(a)});a.timeExtent&&
l.mixin(f.mapOptions,{time:[a.timeExtent.startTime.getTime(),a.timeExtent.endTime.getTime()]});c={};l.mixin(c,f,d);return c},_createOperationalLayers:function(a,b){var f,c,h,g,k=[];this.allLayerslegend=this.legendAll?[]:null;var e=m.map(a.layerIds,a.getLayer,a);a._mapImageLyr&&e.push(a._mapImageLyr);for(f=0;f<e.length;f++)if(c=e[f],c.loaded&&c.visible)switch(h=c.declaredClass,g={id:c.id,title:l.getObject("arcgisProps.title",!1,c)||c.id,opacity:c.opacity,minScale:c.minScale||0,maxScale:c.maxScale||
0},g=l.mixin(g,this._getUrlAndToken(c)),c.getNode()&&B.get(c.getNode(),"data-reference")&&(g._isRefLayer=!0),h){case "esri.layers.ArcGISDynamicMapServiceLayer":var s=[];h=!!c._params.layers;if(c._params.dynamicLayers)h=n.fromJson(c._params.dynamicLayers),m.forEach(h,function(a){s.push({id:a.id,name:a.name,layerDefinition:a});delete a.id;delete a.name;delete a.maxScale;delete a.minScale});else if(c.supportsDynamicLayers){if(h||c.layerDefinitions||c.layerTimeOptions){var r=c.createDynamicLayerInfosFromLayerInfos(),
u=null;h&&(u=c.visibleLayers);var u=d._getVisibleLayers(r,u),C=d._getLayersForScale(b.outScale||a.getScale(),r);m.forEach(r,function(a){if(!a.subLayerIds){var b=a.id;-1<m.indexOf(u,b)&&-1<m.indexOf(C,b)&&(a={source:a.source.toJson()},c.layerDefinitions&&c.layerDefinitions[b]&&(a.definitionExpression=c.layerDefinitions[b]),c.layerTimeOptions&&c.layerTimeOptions[b]&&(a.layerTimeOptions=c.layerTimeOptions[b].toJson()),s.push({id:b,layerDefinition:a}))}});0===s.length&&(g.visibleLayers=[-1])}}else m.forEach(c.layerInfos,
function(a){var u={id:a.id,layerDefinition:{}};c.layerDefinitions&&c.layerDefinitions[a.id]&&(u.layerDefinition.definitionExpression=c.layerDefinitions[a.id]);c.layerTimeOptions&&c.layerTimeOptions[a.id]&&(u.layerDefinition.layerTimeOptions=c.layerTimeOptions[a.id].toJson());(u.layerDefinition.definitionExpression||u.layerDefinition.layerTimeOptions)&&s.push(u)}),h&&(g.visibleLayers=c.visibleLayers);s.length&&(g.layers=s);k.push(g);this.allLayerslegend&&this.allLayerslegend.push({id:c.id,subLayerIds:c.visibleLayers});
break;case "esri.layers.ArcGISImageServiceLayer":g=l.mixin(g,{url:c.url,bandIds:c.bandIds,compressionQuality:c.compressionQuality,format:c.format,interpolation:c.interpolation});c.mosaicRule&&l.mixin(g,{mosaicRule:c.mosaicRule.toJson()});c.renderingRule&&l.mixin(g,{renderingRule:c.renderingRule.toJson()});k.push(g);this.allLayerslegend&&this.allLayerslegend.push({id:c.id});break;case "esri.layers.WMSLayer":g=l.mixin(g,{url:c.url,title:c.title,type:"wms",version:c.version,transparentBackground:c.imageTransparency,
visibleLayers:c.visibleLayers});k.push(g);this.allLayerslegend&&this.allLayerslegend.push({id:c.id,subLayerIds:c.visibleLayers});break;case "esri.virtualearth.VETiledLayer":h=c.mapStyle;"aerialWithLabels"===h&&(h="Hybrid");g=l.mixin(g,{visibility:c.visible,type:"BingMaps"+h,culture:c.culture,key:c.bingMapsKey});k.push(g);break;case "esri.layers.OpenStreetMapLayer":g=l.mixin(g,{type:"OpenStreetMap",url:c.tileServers[0]});k.push(g);break;case "esri.layers.WMTSLayer":g=l.mixin(g,{url:c.url,type:"wmts",
layer:c._identifier,style:c._style,format:c.format,tileMatrixSet:c._tileMatrixSetId});k.push(g);break;case "esri.layers.MapImageLayer":h=c.getImages();m.forEach(h,function(a,u){a.href&&(g={id:c.id+"_image"+u,type:"image",title:c.id,minScale:c.minScale||0,maxScale:c.maxScale||0,opacity:c.opacity*a.opacity,extent:a.extent.toJson()},"data:image/png;base64,"===a.href.substr(0,22)?g.imageData=a.href.substr(22):g.url=a.href,k.push(g))});break;case "esri.layers.WebTiledLayer":h=c.url.replace(/\$\{/g,"{");
g=l.mixin(g,{type:"WebTiledLayer",urlTemplate:h,credits:c.copyright});c.subDomains&&0<c.subDomains.length&&(g.subDomains=c.subDomains);k.push(g);break;default:if(c.getTileUrl||c.getImageUrl)g=l.mixin(g,{url:c.url}),k.push(g)}for(f=0;f<a.graphicsLayerIds.length;f++)if(c=a.getLayer(a.graphicsLayerIds[f]),c.loaded&&c.visible)switch(h=c.declaredClass,h){case "esri.layers.FeatureLayer":case "esri.layers.LabelLayer":case "esri.layers.CSVLayer":case "esri.layers.StreamLayer":if("esri.layers.LabelLayer"===
h&&!b.showLabels||c.renderer&&"esri.renderer.HeatmapRenderer"===c.renderer.declaredClass)continue;e=null;c.url&&c.renderer&&("esri.renderer.ScaleDependentRenderer"===c.renderer.declaredClass?"scale"===c.renderer.rangeType?e=c.renderer.getRendererInfoByScale(a.getScale())&&c.renderer.getRendererInfoByScale(a.getScale()).renderer:"zoom"===c.renderer.rangeType&&(e=c.renderer.getRendererInfoByZoom(a.getZoom())&&c.renderer.getRendererInfoByZoom(a.getZoom()).renderer):e=c.renderer);if(e&&("esri.renderer.SimpleRenderer"===
e.declaredClass||"esri.renderer.TemporalRenderer"===e.declaredClass||l.isString(e.attributeField)&&c._getField(e.attributeField,!0))&&!e.hasVisualVariables()&&"esri.renderer.DotDensityRenderer"!==e.declaredClass&&"esri.layers.CSVLayer"!==c.declaredClass&&"esri.layers.StreamLayer"!==c.declaredClass)if(g={id:c.id,title:l.getObject("arcgisProps.title",!1,c)||c.id,opacity:c.opacity,minScale:c.minScale||0,maxScale:c.maxScale||0,layerDefinition:{drawingInfo:{renderer:e.toJson()}}},g=l.mixin(g,this._getUrlAndToken(c)),
"esri.renderer.TemporalRenderer"===e.declaredClass&&(h=g.layerDefinition.drawingInfo,h.latestObservationRenderer=h.renderer.latestObservationRenderer,h.trackLinesRenderer=h.renderer.trackRenderer,h.observationAger=h.renderer.observationAger,h.renderer=h.renderer.observationRenderer,c._trackIdField&&(g.layerDefinition.timeInfo={trackIdField:c._trackIdField})),this._convertSvgRenderer(g.layerDefinition.drawingInfo.renderer),1>c.opacity||"esri.renderer.TemporalRenderer"===e.declaredClass||this._updateLayerOpacity(g))if(c._params.source&&
(e=c._params.source.toJson(),l.mixin(g.layerDefinition,{source:e})),c.getDefinitionExpression()&&l.mixin(g.layerDefinition,{definitionExpression:c.getDefinitionExpression()}),2!==c.mode)0<c.getSelectedFeatures().length&&(e=m.map(c.getSelectedFeatures(),function(a){return a.attributes[c.objectIdField]}),0<e.length&&c.getSelectionSymbol()&&l.mixin(g,{selectionObjectIds:e,selectionSymbol:c.getSelectionSymbol().toJson()}));else{e=m.map(c.getSelectedFeatures(),function(a){return a.attributes[c.objectIdField]});
if(0===e.length||!c._params.drawMode)break;l.mixin(g.layerDefinition,{objectIds:e});e=null;c.getSelectionSymbol()&&(e=new q(c.getSelectionSymbol()));l.mixin(g.layerDefinition.drawingInfo,{renderer:e&&e.toJson()})}else g=this._createFeatureCollection(c);else g=e&&(e.hasVisualVariables()||"esri.renderer.DotDensityRenderer"===e.declaredClass)?this._createFeatureCollection(c,a,e):this._createFeatureCollection(c);k.push(g);this.allLayerslegend&&this.allLayerslegend.push({id:c.id});break;case "esri.layers.GraphicsLayer":g=
this._createFeatureCollection(c),k.push(g),this.allLayerslegend&&this.allLayerslegend.push({id:c.id})}a.graphics&&0<a.graphics.graphics.length&&(g=this._createFeatureCollection(a.graphics),k.push(g));a._labels&&b.showLabels&&(g=this._createFeatureCollection(a._labels),k.push(g));m.forEach(k,function(a,u,C){a._isRefLayer&&(delete a._isRefLayer,C.splice(u,1),C.push(a))});return k},_getUrlAndToken:function(a){return{token:a._getToken(),url:a._url?a._url.path:null}},_updateLayerOpacity:function(a){var c=
this._colorEvaluator(a),c=m.filter(c,function(a){return l.isArray(a)&&4===a.length}),b=!0;if(c.length){var d=c[0][3],g;for(g=1;g<c.length;g++)if(d!==c[g][3]){b=!1;break}if(b){a.opacity=d/255;for(g=0;g<c.length;g++)c[g][3]=255}}return b},_getVariable:function(a,c,b){var d;a&&(d=(a=a.getVisualVariablesForType(c,b))&&a[0]);return d},_applyVisualVariables:function(a,c){var b=c.renderer,d=c.graphic,f=c.symbol,h=c.mapResolution,e=c.mapScale,k=f.type;if(!("textsymbol"===k||"shieldlabelsymbol"===k)){var q=
this._getVariable(b,"sizeInfo",!1),m=this._getVariable(b,"colorInfo",!1),u=this._getVariable(b,"opacityInfo",!1);f instanceof w&&(q=this._getVariable(b,"sizeInfo","outline")||q);q&&(f=b.getSize(d,{sizeInfo:q,shape:"simplemarkersymbol"===k?f.style:null,resolution:h,scale:e}),null!=f&&("simplemarkersymbol"===k?a.size=x.px2pt(f):"picturemarkersymbol"===k?(a.width=x.px2pt(f),a.height=x.px2pt(f)):"simplelinesymbol"===k?a.width=x.px2pt(f):a.outline&&(a.outline.width=x.px2pt(f))));if(m&&(m=b.getColor(d,
{colorInfo:m}))&&("simplemarkersymbol"===k||"simplelinesymbol"===k||"simplefillsymbol"===k))a.color=g.toJsonColor(m);u&&(b=b.getOpacity(d,{opacityInfo:u}),null!=b&&a.color&&(a.color[3]=Math.round(255*b)))}}})})},"esri/tasks/Geoprocessor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has dojo/io-query ../kernel ../request ../deferredUtils ../geometry/normalizeUtils ./Task ./FeatureSet ./JobInfo ./GPMessage ./LinearUnit ./DataFile ./RasterData ./Date ./ParameterValue ./GPResultImageLayer ../layers/ArcGISDynamicMapServiceLayer ../layers/MapImage".split(" "),
function(e,l,m,n,s,k,h,f,d,b,g,a,c,q,G,w,t,r,B,v,x,D,E){e=e(a,{declaredClass:"esri.tasks.Geoprocessor",_eventMap:{"execute-complete":["results","messages"],"get-result-data-complete":["result"],"get-result-image-complete":["mapImage"],"get-result-image-layer-complete":["layer"],"job-cancel":["jobInfo"],"job-complete":["jobInfo"],"status-update":["jobInfo"]},constructor:function(a){this._jobUpdateHandler=l.hitch(this,this._jobUpdateHandler);this._getJobStatus=l.hitch(this,this._getJobStatus);this._getResultDataHandler=
l.hitch(this,this._getResultDataHandler);this._getResultImageHandler=l.hitch(this,this._getResultImageHandler);this._executeHandler=l.hitch(this,this._executeHandler);this._updateTimers=[];this.registerConnectEvents()},updateDelay:1E3,processSpatialReference:null,outputSpatialReference:null,outSpatialReference:null,setUpdateDelay:function(a){this.updateDelay=a},setProcessSpatialReference:function(a){this.processSpatialReference=a},setOutputSpatialReference:function(a){this._setOutSR(a)},setOutSpatialReference:function(a){this._setOutSR(a)},
__msigns:[{n:"execute",c:3,a:[{i:0,p:["*"]}],e:2,f:1},{n:"submitJob",c:4,a:[{i:0,p:["*"]}],e:3}],_setOutSR:function(a){this.outSpatialReference=this.outputSpatialReference=a},_getOutSR:function(){return this.outSpatialReference||this.outputSpatialReference},_gpEncode:function(a,c,b){for(var d in a){var f=a[d];l.isArray(f)?a[d]=s.toJson(m.map(f,function(a){return this._gpEncode({item:a},!0).item},this)):f instanceof Date&&(a[d]=f.getTime())}return this._encode(a,c,b)},_decode:function(a){var b=a.dataType,
d=new v(a);if(-1!==m.indexOf(["GPBoolean","GPDouble","GPLong","GPString"],b))return d;if("GPLinearUnit"===b)d.value=new w(d.value);else if("GPFeatureRecordSetLayer"===b||"GPRecordSet"===b)d.value=new c(d.value);else if("GPDataFile"===b)d.value=new t(d.value);else if("GPDate"===b)a=d.value,l.isString(a)?d.value=new B({date:a}):d.value=new Date(a);else if("GPRasterData"===b||"GPRasterDataLayer"===b)a=a.value.mapImage,d.value=a?new E(a):new r(d.value);else if(-1!==b.indexOf("GPMultiValue:")){var f=b.split(":")[1];
a=d.value;d.value=m.map(a,function(a){return this._decode({paramName:"_name",dataType:f,value:a}).value},this)}else console.log(this.declaredClass+" : GP Data type not handled. : "+d.dataType),d=null;return d},submitJob:function(a,b,c,f,g){var h=this._getOutSR(),e=g.assembly;a=this._gpEncode(l.mixin({},this._url.query,{f:"json","env:outSR":h?h.wkid||s.toJson(h.toJson()):null,"env:processSR":this.processSpatialReference?this.processSpatialReference.wkid||s.toJson(this.processSpatialReference.toJson()):
null},a),null,e&&e[0]);var k=this._jobUpdateHandler,q=this._errorHandler;return d({url:this._url.path+"/submitJob",content:a,callbackParamName:"callback",load:function(a,u){k(a,u,!1,b,c,g.dfd)},error:function(a){q(a,f,g.dfd)}})},_jobUpdateHandler:function(a,b,c,d,f,g){var h=a.jobId;b=new q(a);this._successHandler([b],"onStatusUpdate",f,c&&g);if(!c)switch(clearTimeout(this._updateTimers[h]),this._updateTimers[h]=null,g&&g.progress(b),a.jobStatus){case q.STATUS_SUBMITTED:case q.STATUS_EXECUTING:case q.STATUS_WAITING:case q.STATUS_NEW:var e=
this._getJobStatus;this._updateTimers[h]=setTimeout(function(){e(h,c,d,f,g)},this.updateDelay);break;default:this._successHandler([b],"onJobComplete",d,g)}},_getJobStatus:function(a,b,c,f,g){var h=this._jobUpdateHandler;d({url:this._url.path+"/jobs/"+a,content:l.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:function(a,d){h(a,d,b,c,f,g)},error:this._errorHandler})},_getResultDataHandler:function(a,b,c,d,f){try{var g=this._decode(a);this._successHandler([g],"onGetResultDataComplete",
c,f)}catch(h){this._errorHandler(h,d,f)}},getResultData:function(a,c,f,g){var h=this._getResultDataHandler,e=this._errorHandler,k=new n(b._dfdCanceller);k._pendingDfd=d({url:this._url.path+"/jobs/"+a+"/results/"+c,content:l.mixin({},this._url.query,{f:"json",returnType:"data"}),callbackParamName:"callback",load:function(a,b){h(a,b,f,g,k)},error:function(a){e(a,g,k)}});return k},checkJobStatus:function(a,c,f){var g=this._jobUpdateHandler,h=this._errorHandler,e=new n(b._dfdCanceller);e._pendingDfd=
d({url:this._url.path+"/jobs/"+a,content:l.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:function(a,b){g(a,b,!0,null,c,e)},error:function(a){h(a,f,e)}});return e},cancelJob:function(a,c,f){var g=this._errorHandler,h=new n(b._dfdCanceller);h._pendingDfd=d({url:this._url.path+"/jobs/"+a+"/cancel",content:l.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:l.hitch(this,function(a,b){this._successHandler([a],"onJobCancel",c,h)}),error:function(a){g(a,f,h)}});
return h},execute:function(a,b,c,f){var g=this._getOutSR(),h=f.assembly;a=this._gpEncode(l.mixin({},this._url.query,{f:"json","env:outSR":g?g.wkid||s.toJson(g.toJson()):null,"env:processSR":this.processSpatialReference?this.processSpatialReference.wkid||s.toJson(this.processSpatialReference.toJson()):null},a),null,h&&h[0]);var e=this._executeHandler,k=this._errorHandler;return d({url:this._url.path+"/execute",content:a,callbackParamName:"callback",load:function(a,d){e(a,d,b,c,f.dfd)},error:function(a){k(a,
c,f.dfd)}})},_executeHandler:function(a,b,c,d,f){try{var g=a.results,h,e,k=a.messages;h=0;for(e=g.length;h<e;h++)g[h]=this._decode(g[h]);h=0;for(e=k.length;h<e;h++)k[h]=new G(k[h]);this._successHandler([g,k],"onExecuteComplete",c,f)}catch(q){this._errorHandler(q,d,f)}},_getResultImageHandler:function(a,c,b,d,f){try{var g=this._decode(a);this._successHandler([g],"onGetResultImageComplete",b,f)}catch(h){this._errorHandler(h,d,f)}},getResultImage:function(a,c,f,g,h){var e=this._getResultImageHandler,
k=this._errorHandler;f=this._gpEncode(l.mixin({},this._url.query,{f:"json"},f.toJson()));var q=new n(b._dfdCanceller);q._pendingDfd=d({url:this._url.path+"/jobs/"+a+"/results/"+c,content:f,callbackParamName:"callback",load:function(a,c){e(a,c,g,h,q)},error:function(a){k(a,h,q)}});return q},cancelJobStatusUpdates:function(a){clearTimeout(this._updateTimers[a]);this._updateTimers[a]=null},getResultImageLayer:function(a,c,b,d){if(null==c){var f=this._url.path.indexOf("/GPServer/");a=this._url.path.substring(0,
f)+"/MapServer/jobs/"+a}else a=this._url.path+"/jobs/"+a+"/results/"+c;this._url.query&&(a+="?"+h.objectToQuery(this._url.query));c=null==c?new D(a,{imageParameters:b}):new x(a,{imageParameters:b},!0);this.onGetResultImageLayerComplete(c);d&&d(c);return c},onStatusUpdate:function(){},onJobComplete:function(){},onExecuteComplete:function(){},onGetResultDataComplete:function(){},onGetResultImageComplete:function(){},onGetResultImageLayerComplete:function(){},onJobCancel:function(){}});g._createWrappers(e);
return e})},"esri/tasks/JobInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./GPMessage"],function(e,l,m,n,s){e=e(null,{declaredClass:"esri.tasks.JobInfo",constructor:function(e){this.messages=[];l.mixin(this,e);e=this.messages;var h,f=e.length;for(h=0;h<f;h++)e[h]=new s(e[h])},jobId:"",jobStatus:""});l.mixin(e,{STATUS_CANCELLED:"esriJobCancelled",STATUS_CANCELLING:"esriJobCancelling",STATUS_DELETED:"esriJobDeleted",STATUS_DELETING:"esriJobDeleting",STATUS_EXECUTING:"esriJobExecuting",
STATUS_FAILED:"esriJobFailed",STATUS_NEW:"esriJobNew",STATUS_SUBMITTED:"esriJobSubmitted",STATUS_SUCCEEDED:"esriJobSucceeded",STATUS_TIMED_OUT:"esriJobTimedOut",STATUS_WAITING:"esriJobWaiting"});return e})},"esri/tasks/GPMessage":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(e,l,m,n){e=e(null,{declaredClass:"esri.tasks.GPMessage",constructor:function(e){l.mixin(this,e)}});l.mixin(e,{TYPE_INFORMATIVE:"esriJobMessageTypeInformative",TYPE_PROCESS_DEFINITION:"esriJobMessageTypeProcessDefinition",
TYPE_PROCESS_START:"esriJobMessageTypeProcessStart",TYPE_PROCESS_STOP:"esriJobMessageTypeProcessStop",TYPE_WARNING:"esriJobMessageTypeWarning",TYPE_ERROR:"esriJobMessageTypeError",TYPE_EMPTY:"esriJobMessageTypeEmpty",TYPE_ABORT:"esriJobMessageTypeAbort"});return e})},"esri/tasks/LinearUnit":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(e,l,m,n){return e(null,{declaredClass:"esri.tasks.LinearUnit",constructor:function(e){e&&l.mixin(this,e)},distance:0,units:null,
toJson:function(){var e={};this.distance&&(e.distance=this.distance);this.units&&(e.units=this.units);return e}})})},"esri/tasks/DataFile":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(e,l,m,n){return e(null,{declaredClass:"esri.tasks.DataFile",constructor:function(e){e&&l.mixin(this,e)},url:null,itemID:null,toJson:function(){var e={};this.url&&(e.url=this.url);this.itemID&&(e.itemID=this.itemID);return e}})})},"esri/tasks/RasterData":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel"],function(e,l,m,n){return e(null,{declaredClass:"esri.tasks.RasterData",constructor:function(e){e&&l.mixin(this,e)},url:null,format:null,itemID:null,toJson:function(){var e={};this.url&&(e.url=this.url);this.format&&(e.format=this.format);this.itemID&&(e.itemID=this.itemID);return e}})})},"esri/tasks/Date":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/date/locale","dojo/has","../kernel"],function(e,l,m,n,s){return e(null,{declaredClass:"esri.tasks.Date",
constructor:function(e){e&&(e.format&&(this.format=e.format),this.date=m.parse(e.date,{selector:"date",datePattern:this.format}))},date:new Date,format:"EEE MMM dd HH:mm:ss zzz yyyy",toJson:function(){return{date:m.format(this.date,{selector:"date",datePattern:this.format}),format:this.format}}})})},"esri/tasks/ParameterValue":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(e,l,m,n){return e(null,{declaredClass:"esri.tasks.ParameterValue",constructor:function(e){l.mixin(this,
e)}})})},"esri/tasks/GPResultImageLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has dojo/io-query ../kernel ../layers/ArcGISDynamicMapServiceLayer".split(" "),function(e,l,m,n,s,k,h){return e(h,{declaredClass:"esri.tasks._GPResultImageLayer",constructor:function(f,d){d&&(d.imageParameters&&d.imageParameters.extent)&&(this.initialExtent=this.fullExtent=d.imageParameters.extent,this.spatialReference=this.initialExtent.spatialReference);this.getImageUrl=l.hitch(this,
this.getImageUrl);this.loaded=!0;this.onLoad(this)},getImageUrl:function(f,d,b,g){var a=f.spatialReference.wkid;g(this._url.path+"?"+s.objectToQuery(l.mixin(this._params,{f:"image",bbox:m.toJson(f.toJson()),bboxSR:a,imageSR:a,size:d+","+b})))}})})},"esri/tasks/PrintTemplate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(e,l,m,n){return e(null,{declaredClass:"esri.tasks.PrintTemplate",label:null,exportOptions:{width:800,height:1100,dpi:96},layoutOptions:null,
format:"PNG32",layout:"MAP_ONLY",outScale:0,preserveScale:!0,showAttribution:null,showLabels:!0})})},"dojox/gfx/canvas":function(){define("./_base dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/_base/window dojo/dom-geometry dojo/dom ./shape ./path ./arc ./matrix ./decompose ./bezierutils".split(" "),function(e,l,m,n,s,k,h,f,d,b,g,a,c){function q(a,c,b,d,f,g,e,h,k,q){var m,l,r=c.length,n=0;q?(l=q.l/f,n=q.i):l=c[0]/f;for(;g<e;)g+l>e&&(m={l:(g+l-e)*f,i:n},l=e-g),n%2||(a.beginPath(),a.arc(b,
d,f,g,g+l,h),k&&a.stroke()),g+=l,++n,l=c[n%r]/f;return m}function G(a,b,z,d){var f=0,g=0,e,h=0;d?(e=d.l,h=d.i):e=b[0];for(;1>g;)g=c.tAtLength(a,e),1==g&&(f=c.computeLength(a),f={l:e-f,i:h}),a=c.splitBezierAtT(a,g),h%2||z.push(a[0]),a=a[1],++h,e=b[h%b.length];return f}function w(a,c,b,d){var f=[c.last.x,c.last.y].concat(b),g=!(a instanceof Array);b=4===b.length?"quadraticCurveTo":"bezierCurveTo";var e=[];c=G(f,c.canvasDash,e,d);for(d=0;d<e.length;++d)f=e[d],g?(a.moveTo(f[0],f[1]),a[b].apply(a,f.slice(2))):
(a.push("moveTo",[f[0],f[1]]),a.push(b,f.slice(2)));return c}function t(a,b,z,d,f,g,e){var h=0,k=0,q=0,m=c.distance(z,d,f,g),l=0;b=b.canvasDash;var n=z,r=d,t,s=!(a instanceof Array);e?(q=e.l,l=e.i):q+=b[0];for(;0.01<Math.abs(1-k);)q>m&&(h={l:q-m,i:l},q=m),k=q/m,e=z+(f-z)*k,t=d+(g-d)*k,l++%2||(s?(a.moveTo(n,r),a.lineTo(e,t)):(a.push("moveTo",[n,r]),a.push("lineTo",[e,t]))),n=e,r=t,q+=b[l%b.length];return h}var r=e.canvas={},B=null,v=g.multiplyPoint,x=Math.PI,D=2*x,E=x/2;a=l.extend;if(s.global.CanvasRenderingContext2D){s=
s.doc.createElement("canvas").getContext("2d");var A="function"==typeof s.setLineDash,L="function"==typeof s.fillText}var K={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};r.Shape=n("dojox.gfx.canvas.Shape",f.Shape,{_render:function(a){a.save();this._renderTransform(a);this._renderClip(a);this._renderShape(a);this._renderFill(a,!0);this._renderStroke(a,
!0);a.restore()},_renderClip:function(a){this.canvasClip&&(this.canvasClip.render(a),a.clip())},_renderTransform:function(a){if("canvasTransform"in this){var c=this.canvasTransform;a.translate(c.dx,c.dy);a.rotate(c.angle2);a.scale(c.sx,c.sy);a.rotate(c.angle1)}},_renderShape:function(a){},_renderFill:function(a,c){if("canvasFill"in this){var b=this.fillStyle;if("canvasFillImage"in this){var d=b.width,f=b.height,g=this.canvasFillImage.width,e=this.canvasFillImage.height,h=Math.min(d==g?1:d/g,f==e?
1:f/e),k=(d-h*g)/2,q=(f-h*e)/2;B.width=d;B.height=f;var m=B.getContext("2d");m.clearRect(0,0,d,f);m.drawImage(this.canvasFillImage,0,0,g,e,k,q,h*g,h*e);this.canvasFill=a.createPattern(B,"repeat");delete this.canvasFillImage}a.fillStyle=this.canvasFill;c&&("pattern"===b.type&&(0!==b.x||0!==b.y)&&a.translate(b.x,b.y),a.fill())}else a.fillStyle="rgba(0,0,0,0.0)"},_renderStroke:function(a,c){var b=this.strokeStyle;b?(a.strokeStyle=b.color.toString(),a.lineWidth=b.width,a.lineCap=b.cap,"number"==typeof b.join?
(a.lineJoin="miter",a.miterLimit=b.join):a.lineJoin=b.join,this.canvasDash?A?(a.setLineDash(this.canvasDash),c&&a.stroke()):this._renderDashedStroke(a,c):c&&a.stroke()):c||(a.strokeStyle="rgba(0,0,0,0.0)")},_renderDashedStroke:function(a,b){},getEventSource:function(){return null},on:function(){},connect:function(){},disconnect:function(){},canvasClip:null,setClip:function(a){this.inherited(arguments);var b=a?"width"in a?"rect":"cx"in a?"ellipse":"points"in a?"polyline":"d"in a?"path":null:null;if(a&&
!b)return this;this.canvasClip=a?y(b,a):null;this.parent&&this.parent._makeDirty();return this}});var y=function(a,b){switch(a){case "ellipse":return{canvasEllipse:J({shape:b}),render:function(a){return r.Ellipse.prototype._renderShape.call(this,a)}};case "rect":return{shape:l.delegate(b,{r:0}),render:function(a){return r.Rect.prototype._renderShape.call(this,a)}};case "path":return{canvasPath:M(b),render:function(a){this.canvasPath._renderShape(a)}};case "polyline":return{canvasPolyline:b.points,
render:function(a){return r.Polyline.prototype._renderShape.call(this,a)}}}return null},M=function(a){var b=new dojox.gfx.canvas.Path;b.canvasPath=[];b._setPath(a.d);return b},F=function(a,b,c){var d=a.prototype[b];a.prototype[b]=c?function(){this.parent&&this.parent._makeDirty();d.apply(this,arguments);c.call(this);return this}:function(){this.parent&&this.parent._makeDirty();return d.apply(this,arguments)}};F(r.Shape,"setTransform",function(){this.matrix?this.canvasTransform=e.decompose(this.matrix):
delete this.canvasTransform});F(r.Shape,"setFill",function(){var a=this.fillStyle,b;if(a){if("object"==typeof a&&"type"in a){var c=this.surface.rawNode.getContext("2d");switch(a.type){case "linear":case "radial":b="linear"==a.type?c.createLinearGradient(a.x1,a.y1,a.x2,a.y2):c.createRadialGradient(a.cx,a.cy,0,a.cx,a.cy,a.r);m.forEach(a.colors,function(a){b.addColorStop(a.offset,e.normalizeColor(a.color).toString())});break;case "pattern":B||(B=document.createElement("canvas")),c=new Image,this.surface.downloadImage(c,
a.src),this.canvasFillImage=c}}else b=a.toString();this.canvasFill=b}else delete this.canvasFill});F(r.Shape,"setStroke",function(){var a=this.strokeStyle;if(a){var b=this.strokeStyle.style.toLowerCase();b in K&&(b=K[b]);if(b instanceof Array){this.canvasDash=b=b.slice();var c;for(c=0;c<b.length;++c)b[c]*=a.width;if("butt"!=a.cap){for(c=0;c<b.length;c+=2)b[c]-=a.width,1>b[c]&&(b[c]=1);for(c=1;c<b.length;c+=2)b[c]+=a.width}}else delete this.canvasDash}else delete this.canvasDash;this._needsDash=!A&&
!!this.canvasDash});F(r.Shape,"setShape");r.Group=n("dojox.gfx.canvas.Group",r.Shape,{constructor:function(){f.Container._init.call(this)},_render:function(a){a.save();this._renderTransform(a);this._renderClip(a);for(var b=0;b<this.children.length;++b)this.children[b]._render(a);a.restore()},destroy:function(){f.Container.clear.call(this,!0);r.Shape.prototype.destroy.apply(this,arguments)}});r.Rect=n("dojox.gfx.canvas.Rect",[r.Shape,f.Rect],{_renderShape:function(a){var b=this.shape,c=Math.min(b.r,
b.height/2,b.width/2),d=b.x,f=d+b.width,g=b.y,b=g+b.height,e=d+c,h=f-c,k=g+c,q=b-c;a.beginPath();a.moveTo(e,g);c?(a.arc(h,k,c,-E,0,!1),a.arc(h,q,c,0,E,!1),a.arc(e,q,c,E,x,!1),a.arc(e,k,c,x,x+E,!1)):(a.lineTo(h,g),a.lineTo(f,q),a.lineTo(e,b),a.lineTo(d,k));a.closePath()},_renderDashedStroke:function(a,b){var c=this.shape,d=Math.min(c.r,c.height/2,c.width/2),f=c.x,g=f+c.width,e=c.y,h=e+c.height,k=f+d,m=g-d,l=e+d,n=h-d;d?(a.beginPath(),c=t(a,this,k,e,m,e),b&&a.stroke(),c=q(a,this.canvasDash,m,l,d,-E,
0,!1,b,c),a.beginPath(),c=t(a,this,g,l,g,n,c),b&&a.stroke(),c=q(a,this.canvasDash,m,n,d,0,E,!1,b,c),a.beginPath(),c=t(a,this,m,h,k,h,c),b&&a.stroke(),c=q(a,this.canvasDash,k,n,d,E,x,!1,b,c),a.beginPath(),c=t(a,this,f,n,f,l,c),b&&a.stroke(),q(a,this.canvasDash,k,l,d,x,x+E,!1,b,c)):(a.beginPath(),c=t(a,this,k,e,m,e),c=t(a,this,m,e,g,n,c),c=t(a,this,g,n,k,h,c),t(a,this,k,h,f,l,c),b&&a.stroke())}});var H=[];(function(){var a=b.curvePI4;H.push(a.s,a.c1,a.c2,a.e);for(var c=45;360>c;c+=45){var d=g.rotateg(c);
H.push(v(d,a.c1),v(d,a.c2),v(d,a.e))}})();var J=function(a){var c,b,d,f=[],e=a.shape,h=g.normalize([g.translate(e.cx,e.cy),g.scale(e.rx,e.ry)]);c=v(h,H[0]);f.push([c.x,c.y]);for(e=1;e<H.length;e+=3)b=v(h,H[e]),d=v(h,H[e+1]),c=v(h,H[e+2]),f.push([b.x,b.y,d.x,d.y,c.x,c.y]);if(a._needsDash){c=[];b=f[0];for(e=1;e<f.length;++e)d=[],G(b.concat(f[e]),a.canvasDash,d),b=[f[e][4],f[e][5]],c.push(d);a._dashedPoints=c}return f};r.Ellipse=n("dojox.gfx.canvas.Ellipse",[r.Shape,f.Ellipse],{setShape:function(){this.inherited(arguments);
this.canvasEllipse=J(this);return this},setStroke:function(){this.inherited(arguments);A||(this.canvasEllipse=J(this));return this},_renderShape:function(a){var c=this.canvasEllipse,b;a.beginPath();a.moveTo.apply(a,c[0]);for(b=1;b<c.length;++b)a.bezierCurveTo.apply(a,c[b]);a.closePath()},_renderDashedStroke:function(a,c){var b=this._dashedPoints;a.beginPath();for(var d=0;d<b.length;++d)for(var f=b[d],e=0;e<f.length;++e){var g=f[e];a.moveTo(g[0],g[1]);a.bezierCurveTo(g[2],g[3],g[4],g[5],g[6],g[7])}c&&
a.stroke()}});r.Circle=n("dojox.gfx.canvas.Circle",[r.Shape,f.Circle],{_renderShape:function(a){var c=this.shape;a.beginPath();a.arc(c.cx,c.cy,c.r,0,D,1)},_renderDashedStroke:function(a,c){var b=this.shape,d=0,f,e=this.canvasDash.length;for(i=0;d<D;)f=this.canvasDash[i%e]/b.r,i%2||(a.beginPath(),a.arc(b.cx,b.cy,b.r,d,d+f,0),c&&a.stroke()),d+=f,++i}});r.Line=n("dojox.gfx.canvas.Line",[r.Shape,f.Line],{_renderShape:function(a){var c=this.shape;a.beginPath();a.moveTo(c.x1,c.y1);a.lineTo(c.x2,c.y2)},
_renderDashedStroke:function(a,c){var b=this.shape;a.beginPath();t(a,this,b.x1,b.y1,b.x2,b.y2);c&&a.stroke()}});r.Polyline=n("dojox.gfx.canvas.Polyline",[r.Shape,f.Polyline],{setShape:function(){this.inherited(arguments);var a=this.shape.points,c=a[0],b,d;this.bbox=null;this._normalizePoints();if(a.length)if("number"==typeof c)c=a;else{c=[];for(d=0;d<a.length;++d)b=a[d],c.push(b.x,b.y)}else c=[];this.canvasPolyline=c;return this},_renderShape:function(a){var c=this.canvasPolyline;if(c.length){a.beginPath();
a.moveTo(c[0],c[1]);for(var b=2;b<c.length;b+=2)a.lineTo(c[b],c[b+1])}},_renderDashedStroke:function(a,c){var b=this.canvasPolyline,d=0;a.beginPath();for(var f=0;f<b.length;f+=2)d=t(a,this,b[f],b[f+1],b[f+2],b[f+3],d);c&&a.stroke()}});r.Image=n("dojox.gfx.canvas.Image",[r.Shape,f.Image],{setShape:function(){this.inherited(arguments);var a=new Image;this.surface.downloadImage(a,this.shape.src);this.canvasImage=a;return this},_renderShape:function(a){var c=this.shape;a.drawImage(this.canvasImage,c.x,
c.y,c.width,c.height)}});r.Text=n("dojox.gfx.canvas.Text",[r.Shape,f.Text],{_setFont:function(){this.fontStyle?this.canvasFont=e.makeFontString(this.fontStyle):delete this.canvasFont},getTextWidth:function(){var a=this.shape,c=0,b;a.text&&(b=this.surface.rawNode.getContext("2d"),b.save(),this._renderTransform(b),this._renderFill(b,!1),this._renderStroke(b,!1),this.canvasFont&&(b.font=this.canvasFont),c=b.measureText(a.text).width,b.restore());return c},_render:function(a){a.save();this._renderTransform(a);
this._renderFill(a,!1);this._renderStroke(a,!1);this._renderShape(a);a.restore()},_renderShape:function(a){var c,b=this.shape;b.text&&(c="middle"===b.align?"center":b.align,a.textAlign=c,this.canvasFont&&(a.font=this.canvasFont),this.canvasFill&&a.fillText(b.text,b.x,b.y),this.strokeStyle&&(a.beginPath(),a.strokeText(b.text,b.x,b.y),a.closePath()))}});F(r.Text,"setFont");L||r.Text.extend({getTextWidth:function(){return 0},getBoundingBox:function(){return null},_renderShape:function(){}});var N={M:"_moveToA",
m:"_moveToR",L:"_lineToA",l:"_lineToR",H:"_hLineToA",h:"_hLineToR",V:"_vLineToA",v:"_vLineToR",C:"_curveToA",c:"_curveToR",S:"_smoothCurveToA",s:"_smoothCurveToR",Q:"_qCurveToA",q:"_qCurveToR",T:"_qSmoothCurveToA",t:"_qSmoothCurveToR",A:"_arcTo",a:"_arcTo",Z:"_closePath",z:"_closePath"};r.Path=n("dojox.gfx.canvas.Path",[r.Shape,d.Path],{constructor:function(){this.lastControl={}},setShape:function(){this.canvasPath=[];this._dashedPath=[];return this.inherited(arguments)},setStroke:function(){this.inherited(arguments);
A||(this.segmented=!1,this._confirmSegmented());return this},_setPath:function(){this._dashResidue=null;this.inherited(arguments)},_updateWithSegment:function(a){var c=l.clone(this.last);this[N[a.action]](this.canvasPath,a.action,a.args,this._needsDash?this._dashedPath:null);this.last=c;this.inherited(arguments)},_renderShape:function(a){var c=this.canvasPath;a.beginPath();for(var b=0;b<c.length;b+=2)a[c[b]].apply(a,c[b+1])},_renderDashedStroke:A?function(){}:function(a,c){var b=this._dashedPath;
a.beginPath();for(var d=0;d<b.length;d+=2)a[b[d]].apply(a,b[d+1]);c&&a.stroke()},_moveToA:function(a,c,b,d){a.push("moveTo",[b[0],b[1]]);d&&d.push("moveTo",[b[0],b[1]]);for(c=2;c<b.length;c+=2)a.push("lineTo",[b[c],b[c+1]]),d&&(this._dashResidue=t(d,this,b[c-2],b[c-1],b[c],b[c+1],this._dashResidue));this.last.x=b[b.length-2];this.last.y=b[b.length-1];this.lastControl={}},_moveToR:function(a,b,c,d){b="x"in this.last?[this.last.x+=c[0],this.last.y+=c[1]]:[this.last.x=c[0],this.last.y=c[1]];a.push("moveTo",
b);d&&d.push("moveTo",b);for(b=2;b<c.length;b+=2)a.push("lineTo",[this.last.x+=c[b],this.last.y+=c[b+1]]),d&&(this._dashResidue=t(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_lineToA:function(a,b,c,d){for(b=0;b<c.length;b+=2)d&&(this._dashResidue=t(d,this,this.last.x,this.last.y,c[b],c[b+1],this._dashResidue)),a.push("lineTo",[c[b],c[b+1]]);this.last.x=c[c.length-2];this.last.y=c[c.length-1];this.lastControl={}},_lineToR:function(a,b,c,
d){for(b=0;b<c.length;b+=2)a.push("lineTo",[this.last.x+=c[b],this.last.y+=c[b+1]]),d&&(this._dashResidue=t(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_hLineToA:function(a,b,c,d){for(b=0;b<c.length;++b)a.push("lineTo",[c[b],this.last.y]),d&&(this._dashResidue=t(d,this,d[d.length-1][0],d[d.length-1][1],c[b],this.last.y,this._dashResidue));this.last.x=c[c.length-1];this.lastControl={}},_hLineToR:function(a,b,c,d){for(b=0;b<c.length;++b)a.push("lineTo",
[this.last.x+=c[b],this.last.y]),d&&(this._dashResidue=t(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_vLineToA:function(a,b,c,d){for(b=0;b<c.length;++b)a.push("lineTo",[this.last.x,c[b]]),d&&(this._dashResidue=t(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,c[b],this._dashResidue));this.last.y=c[c.length-1];this.lastControl={}},_vLineToR:function(a,b,c,d){for(b=0;b<c.length;++b)a.push("lineTo",[this.last.x,this.last.y+=c[b]]),d&&
(this._dashResidue=t(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_curveToA:function(a,b,c,d){for(b=0;b<c.length;b+=6)a.push("bezierCurveTo",c.slice(b,b+6)),d&&(this._dashResidue=w(d,this,a[a.length-1],this._dashResidue));this.last.x=c[c.length-2];this.last.y=c[c.length-1];this.lastControl.x=c[c.length-4];this.lastControl.y=c[c.length-3];this.lastControl.type="C"},_curveToR:function(a,b,c,d){for(b=0;b<c.length;b+=6)a.push("bezierCurveTo",
[this.last.x+c[b],this.last.y+c[b+1],this.lastControl.x=this.last.x+c[b+2],this.lastControl.y=this.last.y+c[b+3],this.last.x+c[b+4],this.last.y+c[b+5]]),d&&(this._dashResidue=w(d,this,a[a.length-1],this._dashResidue)),this.last.x+=c[b+4],this.last.y+=c[b+5];this.lastControl.type="C"},_smoothCurveToA:function(a,b,c,d){for(b=0;b<c.length;b+=4){var f="C"==this.lastControl.type;a.push("bezierCurveTo",[f?2*this.last.x-this.lastControl.x:this.last.x,f?2*this.last.y-this.lastControl.y:this.last.y,c[b],c[b+
1],c[b+2],c[b+3]]);d&&(this._dashResidue=w(d,this,a[a.length-1],this._dashResidue));this.lastControl.x=c[b];this.lastControl.y=c[b+1];this.lastControl.type="C"}this.last.x=c[c.length-2];this.last.y=c[c.length-1]},_smoothCurveToR:function(a,b,c,d){for(b=0;b<c.length;b+=4){var f="C"==this.lastControl.type;a.push("bezierCurveTo",[f?2*this.last.x-this.lastControl.x:this.last.x,f?2*this.last.y-this.lastControl.y:this.last.y,this.last.x+c[b],this.last.y+c[b+1],this.last.x+c[b+2],this.last.y+c[b+3]]);d&&
(this._dashResidue=w(d,this,a[a.length-1],this._dashResidue));this.lastControl.x=this.last.x+c[b];this.lastControl.y=this.last.y+c[b+1];this.lastControl.type="C";this.last.x+=c[b+2];this.last.y+=c[b+3]}},_qCurveToA:function(a,b,c,d){for(b=0;b<c.length;b+=4)a.push("quadraticCurveTo",c.slice(b,b+4));d&&(this._dashResidue=w(d,this,a[a.length-1],this._dashResidue));this.last.x=c[c.length-2];this.last.y=c[c.length-1];this.lastControl.x=c[c.length-4];this.lastControl.y=c[c.length-3];this.lastControl.type=
"Q"},_qCurveToR:function(a,b,c,d){for(b=0;b<c.length;b+=4)a.push("quadraticCurveTo",[this.lastControl.x=this.last.x+c[b],this.lastControl.y=this.last.y+c[b+1],this.last.x+c[b+2],this.last.y+c[b+3]]),d&&(this._dashResidue=w(d,this,a[a.length-1],this._dashResidue)),this.last.x+=c[b+2],this.last.y+=c[b+3];this.lastControl.type="Q"},_qSmoothCurveToA:function(a,b,c,d){for(b=0;b<c.length;b+=2){var f="Q"==this.lastControl.type;a.push("quadraticCurveTo",[this.lastControl.x=f?2*this.last.x-this.lastControl.x:
this.last.x,this.lastControl.y=f?2*this.last.y-this.lastControl.y:this.last.y,c[b],c[b+1]]);d&&(this._dashResidue=w(d,this,a[a.length-1],this._dashResidue));this.lastControl.type="Q"}this.last.x=c[c.length-2];this.last.y=c[c.length-1]},_qSmoothCurveToR:function(a,b,c,d){for(b=0;b<c.length;b+=2){var f="Q"==this.lastControl.type;a.push("quadraticCurveTo",[this.lastControl.x=f?2*this.last.x-this.lastControl.x:this.last.x,this.lastControl.y=f?2*this.last.y-this.lastControl.y:this.last.y,this.last.x+c[b],
this.last.y+c[b+1]]);d&&(this._dashResidue=w(d,this,a[a.length-1],this._dashResidue));this.lastControl.type="Q";this.last.x+=c[b];this.last.y+=c[b+1]}},_arcTo:function(a,c,d,f){c="a"==c;for(var e=0;e<d.length;e+=7){var g=d[e+5],h=d[e+6];c&&(g+=this.last.x,h+=this.last.y);var k=b.arcAsBezier(this.last,d[e],d[e+1],d[e+2],d[e+3]?1:0,d[e+4]?1:0,g,h);m.forEach(k,function(b){a.push("bezierCurveTo",b)});f&&(this._dashResidue=w(f,this,p,this._dashResidue));this.last.x=g;this.last.y=h}this.lastControl={}},
_closePath:function(a,b,c,d){a.push("closePath",[]);d&&(this._dashResidue=t(d,this,this.last.x,this.last.y,d[1][0],d[1][1],this._dashResidue));this.lastControl={}}});m.forEach("moveTo lineTo hLineTo vLineTo curveTo smoothCurveTo qCurveTo qSmoothCurveTo arcTo closePath".split(" "),function(a){F(r.Path,a)});r.TextPath=n("dojox.gfx.canvas.TextPath",[r.Shape,d.TextPath],{_renderShape:function(a){},_setText:function(){},_setFont:function(){}});r.Surface=n("dojox.gfx.canvas.Surface",f.Surface,{constructor:function(){f.Container._init.call(this);
this.pendingImageCount=0;this.makeDirty()},destroy:function(){f.Container.clear.call(this,!0);this.inherited(arguments)},setDimensions:function(a,b){this.width=e.normalizedLength(a);this.height=e.normalizedLength(b);if(!this.rawNode)return this;var c=!1;this.rawNode.width!=this.width&&(this.rawNode.width=this.width,c=!0);this.rawNode.height!=this.height&&(this.rawNode.height=this.height,c=!0);c&&this.makeDirty();return this},getDimensions:function(){return this.rawNode?{width:this.rawNode.width,height:this.rawNode.height}:
null},_render:function(a){if(this.rawNode&&(a||!this.pendingImageCount))a=this.rawNode.getContext("2d"),a.clearRect(0,0,this.rawNode.width,this.rawNode.height),this.render(a),"pendingRender"in this&&(clearTimeout(this.pendingRender),delete this.pendingRender)},render:function(a){a.save();for(var b=0;b<this.children.length;++b)this.children[b]._render(a);a.restore()},makeDirty:function(){!this.pendingImagesCount&&(!("pendingRender"in this)&&!this._batch)&&(this.pendingRender=setTimeout(l.hitch(this,
this._render),0))},downloadImage:function(a,b){var c=l.hitch(this,this.onImageLoad);!this.pendingImageCount++&&"pendingRender"in this&&(clearTimeout(this.pendingRender),delete this.pendingRender);a.onload=c;a.onerror=c;a.onabort=c;a.src=b},onImageLoad:function(){--this.pendingImageCount||(this.onImagesLoaded(),this._render())},onImagesLoaded:function(){},getEventSource:function(){return null},connect:function(){},disconnect:function(){},on:function(){}});r.createSurface=function(a,b,c){if(!b&&!c){var d=
k.position(a);b=b||d.w;c=c||d.h}"number"==typeof b&&(b+="px");"number"==typeof c&&(c+="px");d=new r.Surface;a=h.byId(a);var f=a.ownerDocument.createElement("canvas");f.width=e.normalizedLength(b);f.height=e.normalizedLength(c);a.appendChild(f);d.rawNode=f;d._parent=a;return d.surface=d};var I=f.Container;n={openBatch:function(){++this._batch;return this},closeBatch:function(){this._batch=0<this._batch?--this._batch:0;this._makeDirty();return this},_makeDirty:function(){this._batch||this.surface.makeDirty()},
add:function(a){this._makeDirty();return I.add.apply(this,arguments)},remove:function(a,b){this._makeDirty();return I.remove.apply(this,arguments)},clear:function(){this._makeDirty();return I.clear.apply(this,arguments)},getBoundingBox:I.getBoundingBox,_moveChildToFront:function(a){this._makeDirty();return I._moveChildToFront.apply(this,arguments)},_moveChildToBack:function(a){this._makeDirty();return I._moveChildToBack.apply(this,arguments)}};d={createObject:function(a,b){var c=new a;c.surface=this.surface;
c.setShape(b);this.add(c);return c}};a(r.Group,n);a(r.Group,f.Creator);a(r.Group,d);a(r.Surface,n);a(r.Surface,f.Creator);a(r.Surface,d);r.fixTarget=function(a,b){return!0};return r})},"dojox/gfx/shape":function(){define("./_base dojo/_base/lang dojo/_base/declare dojo/_base/kernel dojo/_base/sniff dojo/on dojo/_base/array dojo/dom-construct dojo/_base/Color ./matrix".split(" "),function(e,l,m,n,s,k,h,f,d,b){var g=e.shape={};g.Shape=m("dojox.gfx.shape.Shape",null,{constructor:function(){this.parentMatrix=
this.parent=this.bbox=this.strokeStyle=this.fillStyle=this.matrix=this.shape=this.rawNode=null;if(s("gfxRegistry")){var a=g.register(this);this.getUID=function(){return a}}},destroy:function(){s("gfxRegistry")&&g.dispose(this);this.rawNode&&"__gfxObject__"in this.rawNode&&(this.rawNode.__gfxObject__=null);this.rawNode=null},getNode:function(){return this.rawNode},getShape:function(){return this.shape},getTransform:function(){return this.matrix},getFill:function(){return this.fillStyle},getStroke:function(){return this.strokeStyle},
getParent:function(){return this.parent},getBoundingBox:function(){return this.bbox},getTransformedBoundingBox:function(){var a=this.getBoundingBox();if(!a)return null;var c=this._getRealMatrix();return[b.multiplyPoint(c,a.x,a.y),b.multiplyPoint(c,a.x+a.width,a.y),b.multiplyPoint(c,a.x+a.width,a.y+a.height),b.multiplyPoint(c,a.x,a.y+a.height)]},getEventSource:function(){return this.rawNode},setClip:function(a){this.clip=a},getClip:function(){return this.clip},setShape:function(a){this.shape=e.makeParameters(this.shape,
a);this.bbox=null;return this},setFill:function(a){if(!a)return this.fillStyle=null,this;var b=null;if("object"==typeof a&&"type"in a)switch(a.type){case "linear":b=e.makeParameters(e.defaultLinearGradient,a);break;case "radial":b=e.makeParameters(e.defaultRadialGradient,a);break;case "pattern":b=e.makeParameters(e.defaultPattern,a)}else b=e.normalizeColor(a);this.fillStyle=b;return this},setStroke:function(a){if(!a)return this.strokeStyle=null,this;if("string"==typeof a||l.isArray(a)||a instanceof
d)a={color:a};a=this.strokeStyle=e.makeParameters(e.defaultStroke,a);a.color=e.normalizeColor(a.color);return this},setTransform:function(a){this.matrix=b.clone(a?b.normalize(a):b.identity);return this._applyTransform()},_applyTransform:function(){return this},moveToFront:function(){var a=this.getParent();a&&(a._moveChildToFront(this),this._moveToFront());return this},moveToBack:function(){var a=this.getParent();a&&(a._moveChildToBack(this),this._moveToBack());return this},_moveToFront:function(){},
_moveToBack:function(){},applyRightTransform:function(a){return a?this.setTransform([this.matrix,a]):this},applyLeftTransform:function(a){return a?this.setTransform([a,this.matrix]):this},applyTransform:function(a){return a?this.setTransform([this.matrix,a]):this},removeShape:function(a){this.parent&&this.parent.remove(this,a);return this},_setParent:function(a,b){this.parent=a;return this._updateParentMatrix(b)},_updateParentMatrix:function(a){this.parentMatrix=a?b.clone(a):null;return this._applyTransform()},
_getRealMatrix:function(){for(var a=this.matrix,c=this.parent;c;)c.matrix&&(a=b.multiply(c.matrix,a)),c=c.parent;return a}});g._eventsProcessing={on:function(a,b){return k(this.getEventSource(),a,g.fixCallback(this,e.fixTarget,b))},connect:function(a,b,d){"on"==a.substring(0,2)&&(a=a.substring(2));return this.on(a,d?l.hitch(b,d):b)},disconnect:function(a){return a.remove()}};g.fixCallback=function(a,b,d,f){f||(f=d,d=null);if(l.isString(f)){d=d||n.global;if(!d[f])throw['dojox.gfx.shape.fixCallback: scope["',
f,'"] is null (scope\x3d"',d,'")'].join("");return function(e){return b(e,a)?d[f].apply(d,arguments||[]):void 0}}return!d?function(e){return b(e,a)?f.apply(d,arguments):void 0}:function(e){return b(e,a)?f.apply(d,arguments||[]):void 0}};l.extend(g.Shape,g._eventsProcessing);g.Container={_init:function(){this.children=[];this._batch=0},openBatch:function(){return this},closeBatch:function(){return this},add:function(a){var b=a.getParent();b&&b.remove(a,!0);this.children.push(a);return a._setParent(this,
this._getRealMatrix())},remove:function(a,b){for(var d=0;d<this.children.length;++d)if(this.children[d]==a){b||(a.parent=null,a.parentMatrix=null);this.children.splice(d,1);break}return this},clear:function(a){for(var b,d=0;d<this.children.length;++d)b=this.children[d],b.parent=null,b.parentMatrix=null,a&&b.destroy();this.children=[];return this},getBoundingBox:function(){if(this.children){var a=null;h.forEach(this.children,function(c){var d=c.getBoundingBox();d&&((c=c.getTransform())&&(d=b.multiplyRectangle(c,
d)),a?(a.x=Math.min(a.x,d.x),a.y=Math.min(a.y,d.y),a.endX=Math.max(a.endX,d.x+d.width),a.endY=Math.max(a.endY,d.y+d.height)):a={x:d.x,y:d.y,endX:d.x+d.width,endY:d.y+d.height})});a&&(a.width=a.endX-a.x,a.height=a.endY-a.y);return a}return null},_moveChildToFront:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]==a){this.children.splice(b,1);this.children.push(a);break}return this},_moveChildToBack:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]==a){this.children.splice(b,
1);this.children.unshift(a);break}return this}};g.Surface=m("dojox.gfx.shape.Surface",null,{constructor:function(){this._parent=this.rawNode=null;this._nodes=[];this._events=[]},destroy:function(){h.forEach(this._nodes,f.destroy);this._nodes=[];h.forEach(this._events,function(a){a&&a.remove()});this._events=[];this.rawNode=null;if(s("ie"))for(;this._parent.lastChild;)f.destroy(this._parent.lastChild);else this._parent.innerHTML="";this._parent=null},getEventSource:function(){return this.rawNode},
_getRealMatrix:function(){return null},isLoaded:!0,onLoad:function(a){},whenLoaded:function(a,b){var d=l.hitch(a,b);if(this.isLoaded)d(this);else k.once(this,"load",function(a){d(a)})}});l.extend(g.Surface,g._eventsProcessing);g.Rect=m("dojox.gfx.shape.Rect",g.Shape,{constructor:function(a){this.shape=e.getDefault("Rect");this.rawNode=a},getBoundingBox:function(){return this.shape}});g.Ellipse=m("dojox.gfx.shape.Ellipse",g.Shape,{constructor:function(a){this.shape=e.getDefault("Ellipse");this.rawNode=
a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-a.rx,y:a.cy-a.ry,width:2*a.rx,height:2*a.ry}}return this.bbox}});g.Circle=m("dojox.gfx.shape.Circle",g.Shape,{constructor:function(a){this.shape=e.getDefault("Circle");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-a.r,y:a.cy-a.r,width:2*a.r,height:2*a.r}}return this.bbox}});g.Line=m("dojox.gfx.shape.Line",g.Shape,{constructor:function(a){this.shape=e.getDefault("Line");this.rawNode=
a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:Math.min(a.x1,a.x2),y:Math.min(a.y1,a.y2),width:Math.abs(a.x2-a.x1),height:Math.abs(a.y2-a.y1)}}return this.bbox}});g.Polyline=m("dojox.gfx.shape.Polyline",g.Shape,{constructor:function(a){this.shape=e.getDefault("Polyline");this.rawNode=a},setShape:function(a,b){a&&a instanceof Array?(this.inherited(arguments,[{points:a}]),b&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.inherited(arguments,[a]);
return this},_normalizePoints:function(){var a=this.shape.points,b=a&&a.length;if(b&&"number"==typeof a[0]){for(var d=[],f=0;f<b;f+=2)d.push({x:a[f],y:a[f+1]});this.shape.points=d}},getBoundingBox:function(){if(!this.bbox&&this.shape.points.length){for(var a=this.shape.points,b=a.length,d=a[0],f=d.x,e=d.y,g=d.x,h=d.y,k=1;k<b;++k)d=a[k],f>d.x&&(f=d.x),g<d.x&&(g=d.x),e>d.y&&(e=d.y),h<d.y&&(h=d.y);this.bbox={x:f,y:e,width:g-f,height:h-e}}return this.bbox}});g.Image=m("dojox.gfx.shape.Image",g.Shape,
{constructor:function(a){this.shape=e.getDefault("Image");this.rawNode=a},getBoundingBox:function(){return this.shape},setStroke:function(){return this},setFill:function(){return this}});g.Text=m(g.Shape,{constructor:function(a){this.fontStyle=null;this.shape=e.getDefault("Text");this.rawNode=a},getFont:function(){return this.fontStyle},setFont:function(a){this.fontStyle="string"==typeof a?e.splitFontString(a):e.makeParameters(e.defaultFont,a);this._setFont();return this},getBoundingBox:function(){var a=
null;this.getShape().text&&(a=e._base._computeTextBoundingBox(this));return a}});g.Creator={createShape:function(a){switch(a.type){case e.defaultPath.type:return this.createPath(a);case e.defaultRect.type:return this.createRect(a);case e.defaultCircle.type:return this.createCircle(a);case e.defaultEllipse.type:return this.createEllipse(a);case e.defaultLine.type:return this.createLine(a);case e.defaultPolyline.type:return this.createPolyline(a);case e.defaultImage.type:return this.createImage(a);
case e.defaultText.type:return this.createText(a);case e.defaultTextPath.type:return this.createTextPath(a)}return null},createGroup:function(){return this.createObject(e.Group)},createRect:function(a){return this.createObject(e.Rect,a)},createEllipse:function(a){return this.createObject(e.Ellipse,a)},createCircle:function(a){return this.createObject(e.Circle,a)},createLine:function(a){return this.createObject(e.Line,a)},createPolyline:function(a){return this.createObject(e.Polyline,a)},createImage:function(a){return this.createObject(e.Image,
a)},createText:function(a){return this.createObject(e.Text,a)},createPath:function(a){return this.createObject(e.Path,a)},createTextPath:function(a){return this.createObject(e.TextPath,{}).setText(a)},createObject:function(a,b){return null}};return g})},"dojox/gfx/path":function(){define(["./_base","dojo/_base/lang","dojo/_base/declare","./matrix","./shape"],function(e,l,m,n,s){s=m("dojox.gfx.path.Path",s.Shape,{constructor:function(k){this.shape=l.clone(e.defaultPath);this.segments=[];this.tbbox=
null;this.absolute=!0;this.last={};this.rawNode=k;this.segmented=!1},setAbsoluteMode:function(e){this._confirmSegmented();this.absolute="string"==typeof e?"absolute"==e:e;return this},getAbsoluteMode:function(){this._confirmSegmented();return this.absolute},getBoundingBox:function(){this._confirmSegmented();return this.bbox&&"l"in this.bbox?{x:this.bbox.l,y:this.bbox.t,width:this.bbox.r-this.bbox.l,height:this.bbox.b-this.bbox.t}:null},_getRealBBox:function(){this._confirmSegmented();if(this.tbbox)return this.tbbox;
var e=this.bbox,h=this._getRealMatrix();this.bbox=null;for(var f=0,d=this.segments.length;f<d;++f)this._updateWithSegment(this.segments[f],h);h=this.bbox;this.bbox=e;return this.tbbox=h?[{x:h.l,y:h.t},{x:h.r,y:h.t},{x:h.r,y:h.b},{x:h.l,y:h.b}]:null},getLastPosition:function(){this._confirmSegmented();return"x"in this.last?this.last:null},_applyTransform:function(){this.tbbox=null;return this.inherited(arguments)},_updateBBox:function(e,h,f){f&&(h=n.multiplyPoint(f,e,h),e=h.x,h=h.y);this.bbox&&"l"in
this.bbox?(this.bbox.l>e&&(this.bbox.l=e),this.bbox.r<e&&(this.bbox.r=e),this.bbox.t>h&&(this.bbox.t=h),this.bbox.b<h&&(this.bbox.b=h)):this.bbox={l:e,b:h,r:e,t:h}},_updateWithSegment:function(k,h){var f=k.args,d=f.length,b;switch(k.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(b=0;b<d;b+=2)this._updateBBox(f[b],f[b+1],h);this.last.x=f[d-2];this.last.y=f[d-1];this.absolute=!0;break;case "H":for(b=0;b<d;++b)this._updateBBox(f[b],this.last.y,h);this.last.x=f[d-1];this.absolute=!0;
break;case "V":for(b=0;b<d;++b)this._updateBBox(this.last.x,f[b],h);this.last.y=f[d-1];this.absolute=!0;break;case "m":b=0;"x"in this.last||(this._updateBBox(this.last.x=f[0],this.last.y=f[1],h),b=2);for(;b<d;b+=2)this._updateBBox(this.last.x+=f[b],this.last.y+=f[b+1],h);this.absolute=!1;break;case "l":case "t":for(b=0;b<d;b+=2)this._updateBBox(this.last.x+=f[b],this.last.y+=f[b+1],h);this.absolute=!1;break;case "h":for(b=0;b<d;++b)this._updateBBox(this.last.x+=f[b],this.last.y,h);this.absolute=!1;
break;case "v":for(b=0;b<d;++b)this._updateBBox(this.last.x,this.last.y+=f[b],h);this.absolute=!1;break;case "c":for(b=0;b<d;b+=6)this._updateBBox(this.last.x+f[b],this.last.y+f[b+1],h),this._updateBBox(this.last.x+f[b+2],this.last.y+f[b+3],h),this._updateBBox(this.last.x+=f[b+4],this.last.y+=f[b+5],h);this.absolute=!1;break;case "s":case "q":for(b=0;b<d;b+=4)this._updateBBox(this.last.x+f[b],this.last.y+f[b+1],h),this._updateBBox(this.last.x+=f[b+2],this.last.y+=f[b+3],h);this.absolute=!1;break;
case "A":for(b=0;b<d;b+=7)this._updateBBox(f[b+5],f[b+6],h);this.last.x=f[d-2];this.last.y=f[d-1];this.absolute=!0;break;case "a":for(b=0;b<d;b+=7)this._updateBBox(this.last.x+=f[b+5],this.last.y+=f[b+6],h);this.absolute=!1}var g=[k.action];for(b=0;b<d;++b)g.push(e.formatNumber(f[b],!0));if("string"==typeof this.shape.path)this.shape.path+=g.join("");else{b=0;for(d=g.length;b<d;++b)this.shape.path.push(g[b])}},_validSegments:{m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},_pushSegment:function(e,h){this.tbbox=
null;var f=this._validSegments[e.toLowerCase()];"number"==typeof f&&(f?h.length>=f&&(f={action:e,args:h.slice(0,h.length-h.length%f)},this.segments.push(f),this._updateWithSegment(f)):(f={action:e,args:[]},this.segments.push(f),this._updateWithSegment(f)))},_collectArgs:function(e,h){for(var f=0;f<h.length;++f){var d=h[f];"boolean"==typeof d?e.push(d?1:0):"number"==typeof d?e.push(d):d instanceof Array?this._collectArgs(e,d):"x"in d&&"y"in d&&e.push(d.x,d.y)}},moveTo:function(){this._confirmSegmented();
var e=[];this._collectArgs(e,arguments);this._pushSegment(this.absolute?"M":"m",e);return this},lineTo:function(){this._confirmSegmented();var e=[];this._collectArgs(e,arguments);this._pushSegment(this.absolute?"L":"l",e);return this},hLineTo:function(){this._confirmSegmented();var e=[];this._collectArgs(e,arguments);this._pushSegment(this.absolute?"H":"h",e);return this},vLineTo:function(){this._confirmSegmented();var e=[];this._collectArgs(e,arguments);this._pushSegment(this.absolute?"V":"v",e);
return this},curveTo:function(){this._confirmSegmented();var e=[];this._collectArgs(e,arguments);this._pushSegment(this.absolute?"C":"c",e);return this},smoothCurveTo:function(){this._confirmSegmented();var e=[];this._collectArgs(e,arguments);this._pushSegment(this.absolute?"S":"s",e);return this},qCurveTo:function(){this._confirmSegmented();var e=[];this._collectArgs(e,arguments);this._pushSegment(this.absolute?"Q":"q",e);return this},qSmoothCurveTo:function(){this._confirmSegmented();var e=[];this._collectArgs(e,
arguments);this._pushSegment(this.absolute?"T":"t",e);return this},arcTo:function(){this._confirmSegmented();var e=[];this._collectArgs(e,arguments);this._pushSegment(this.absolute?"A":"a",e);return this},closePath:function(){this._confirmSegmented();this._pushSegment("Z",[]);return this},_confirmSegmented:function(){if(!this.segmented){var e=this.shape.path;this.shape.path=[];this._setPath(e);this.shape.path=this.shape.path.join("");this.segmented=!0}},_setPath:function(k){k=l.isArray(k)?k:k.match(e.pathSvgRegExp);
this.segments=[];this.absolute=!0;this.bbox={};this.last={};if(k){for(var h="",f=[],d=k.length,b=0;b<d;++b){var g=k[b],a=parseFloat(g);isNaN(a)?(h&&this._pushSegment(h,f),f=[],h=g):f.push(a)}this._pushSegment(h,f)}},setShape:function(k){this.inherited(arguments,["string"==typeof k?{path:k}:k]);this.segmented=!1;this.segments=[];e.lazyPathSegmentation||this._confirmSegmented();return this},_2PI:2*Math.PI});m=m("dojox.gfx.path.TextPath",s,{constructor:function(k){"text"in this||(this.text=l.clone(e.defaultTextPath));
"fontStyle"in this||(this.fontStyle=l.clone(e.defaultFont))},getText:function(){return this.text},setText:function(k){this.text=e.makeParameters(this.text,"string"==typeof k?{text:k}:k);this._setText();return this},getFont:function(){return this.fontStyle},setFont:function(k){this.fontStyle="string"==typeof k?e.splitFontString(k):e.makeParameters(e.defaultFont,k);this._setFont();return this}});return e.path={Path:s,TextPath:m}})},"dojox/gfx/arc":function(){define(["./_base","dojo/_base/lang","./matrix"],
function(e,l,m){function n(b){var d=Math.cos(b);b=Math.sin(b);var a={x:d+4/3*(1-d),y:b-4/3*d*(1-d)/b};return{s:{x:d,y:-b},c1:{x:a.x,y:-a.y},c2:a,e:{x:d,y:b}}}var s=2*Math.PI,k=Math.PI/4,h=Math.PI/8,f=k+h,d=n(h);return e.arc={unitArcAsBezier:n,curvePI4:d,arcAsBezier:function(b,e,a,c,q,l,w,t){q=Boolean(q);l=Boolean(l);var r=m._degToRad(c);c=e*e;var B=a*a,v=m.multiplyPoint(m.rotate(-r),{x:(b.x-w)/2,y:(b.y-t)/2}),x=v.x*v.x,D=v.y*v.y;c=Math.sqrt((c*B-c*D-B*x)/(c*D+B*x));isNaN(c)&&(c=0);c={x:c*e*v.y/a,
y:-c*a*v.x/e};q==l&&(c={x:-c.x,y:-c.y});c=m.multiplyPoint([m.translate((b.x+w)/2,(b.y+t)/2),m.rotate(r)],c);e=m.normalize([m.translate(c.x,c.y),m.rotate(r),m.scale(e,a)]);c=m.invert(e);b=m.multiplyPoint(c,b);t=m.multiplyPoint(c,w,t);w=Math.atan2(b.y,b.x);t=Math.atan2(t.y,t.x);c=w-t;l&&(c=-c);0>c?c+=s:c>s&&(c-=s);a=h;t=d;a=l?a:-a;b=[];for(q=c;0<q;q-=k)q<f&&(a=q/2,t=n(a),a=l?a:-a,q=0),v=m.normalize([e,m.rotate(w+a)]),l?(c=m.multiplyPoint(v,t.c1),r=m.multiplyPoint(v,t.c2),v=m.multiplyPoint(v,t.e)):(c=
m.multiplyPoint(v,t.c2),r=m.multiplyPoint(v,t.c1),v=m.multiplyPoint(v,t.s)),b.push([c.x,c.y,r.x,r.y,v.x,v.y]),w+=2*a;return b}}})},"dojox/gfx/decompose":function(){define(["./_base","dojo/_base/lang","./matrix"],function(e,l,m){function n(d,b){return Math.abs(d-b)<=1E-6*(Math.abs(d)+Math.abs(b))}function s(d,b,e,a){if(isFinite(d)){if(!isFinite(e))return d}else return e;b=Math.abs(b);a=Math.abs(a);return(b*d+a*e)/(b+a)}function k(d){d=m.normalize(d);var b=-d.xx-d.yy,e=d.xx*d.yy-d.xy*d.yx,a=Math.sqrt(b*
b-4*e),b=-(b+(0>b?-a:a))/2,e=e/b,a=d.xy/(b-d.xx),c=1,f=d.xy/(e-d.xx),h=1;n(b,e)&&(a=1,f=c=0,h=1);isFinite(a)||(a=1,c=(b-d.xx)/d.xy,isFinite(c)||(a=(b-d.yy)/d.yx,c=1,isFinite(a)||(a=1,c=d.yx/(b-d.yy))));isFinite(f)||(f=1,h=(e-d.xx)/d.xy,isFinite(h)||(f=(e-d.yy)/d.yx,h=1,isFinite(f)||(f=1,h=d.yx/(e-d.yy))));d=Math.sqrt(a*a+c*c);var k=Math.sqrt(f*f+h*h);if(!isFinite(a/=d))a=0;if(!isFinite(c/=d))c=0;if(!isFinite(f/=k))f=0;if(!isFinite(h/=k))h=0;return{value1:b,value2:e,vector1:{x:a,y:c},vector2:{x:f,
y:h}}}function h(d,b){var e=0>d.xx*d.yy||0<d.xy*d.yx?-1:1,a=b.angle1=(Math.atan2(d.yx,d.yy)+Math.atan2(-e*d.xy,e*d.xx))/2,e=Math.cos(a),a=Math.sin(a);b.sx=s(d.xx/e,e,-d.xy/a,a);b.sy=s(d.yy/e,e,d.yx/a,a);return b}function f(d,b){var e=0>d.xx*d.yy||0<d.xy*d.yx?-1:1,a=b.angle2=(Math.atan2(e*d.yx,e*d.xx)+Math.atan2(-d.xy,d.yy))/2,e=Math.cos(a),a=Math.sin(a);b.sx=s(d.xx/e,e,d.yx/a,a);b.sy=s(d.yy/e,e,-d.xy/a,a);return b}return e.decompose=function(d){var b=m.normalize(d);d={dx:b.dx,dy:b.dy,sx:1,sy:1,angle1:0,
angle2:0};if(n(b.xy,0)&&n(b.yx,0))return l.mixin(d,{sx:b.xx,sy:b.yy});if(n(b.xx*b.yx,-b.xy*b.yy))return h(b,d);if(n(b.xx*b.xy,-b.yx*b.yy))return f(b,d);var e,a=new m.Matrix2D(b);e=l.mixin(a,{dx:0,dy:0,xy:a.yx,yx:a.xy});a=k([b,e]);e=k([e,b]);a=new m.Matrix2D({xx:a.vector1.x,xy:a.vector2.x,yx:a.vector1.y,yy:a.vector2.y});e=new m.Matrix2D({xx:e.vector1.x,xy:e.vector1.y,yx:e.vector2.x,yy:e.vector2.y});b=new m.Matrix2D([m.invert(a),b,m.invert(e)]);h(e,d);b.xx*=d.sx;b.yy*=d.sy;f(a,d);b.xx*=d.sx;b.yy*=d.sy;
return l.mixin(d,{sx:b.xx,sy:b.yy})}})},"dojox/gfx/bezierutils":function(){define(["./_base"],function(e){e=e.bezierutils={};e.tAtLength=function(e,f){var d=0,b=6==e.length,g=0,a=0,c=b?n:k,q=function(k,l){for(var n=0,r=0;r<k.length-2;r+=2)n+=m(k[r],k[r+1],k[r+2],k[r+3]);r=b?m(e[0],e[1],e[4],e[5]):m(e[0],e[1],e[6],e[7]);n-r>l||g+n>f+l?(++a,n=c(k,0.5),q(n[0],l),Math.abs(g-f)<=l||q(n[1],l)):(g+=n,d+=1/(1<<a))};f&&q(e,0.5);return d};var l=e.computeLength=function(e){for(var f=6==e.length,d=0,b=0;b<e.length-
2;b+=2)d+=m(e[b],e[b+1],e[b+2],e[b+3]);b=f?m(e[0],e[1],e[4],e[5]):m(e[0],e[1],e[6],e[7]);0.1<d-b&&(e=f?n(e,0.5):s(e,0.5),d=l(e[0],f),d+=l(e[1],f));return d},m=e.distance=function(e,f,d,b){return Math.sqrt((d-e)*(d-e)+(b-f)*(b-f))},n=function(e,f){var d=1-f,b=d*d,g=f*f,a=e[0],c=e[1],k=e[2],l=e[3],m=e[4],n=e[5],r=b*a+2*d*f*k+g*m,b=b*c+2*d*f*l+g*n;return[[a,c,d*a+f*k,d*c+f*l,r,b],[r,b,d*k+f*m,d*l+f*n,m,n]]},s=function(e,f){var d=1-f,b=d*d,g=b*d,a=f*f,c=a*f,k=e[0],l=e[1],m=e[2],n=e[3],r=e[4],s=e[5],v=
e[6],x=e[7],D=g*k+3*b*f*m+3*d*a*r+c*v,g=g*l+3*b*f*n+3*d*a*s+c*x;return[[k,l,d*k+f*m,d*l+f*n,b*k+2*d*f*m+a*r,b*l+2*d*f*n+a*s,D,g],[D,g,b*m+2*d*f*r+a*v,b*n+2*d*f*s+a*x,d*r+f*v,d*s+f*x,v,x]]},k=e.splitBezierAtT=function(e,f){return 6==e.length?n(e,f):s(e,f)};return e})},"dojox/json/query":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojox","dojo/_base/array"],function(e,l,m){l.getObject("json",!0,m);m.json._slice=function(e,l,k,h){var f=e.length,d=[];k=k||f;l=0>l?Math.max(0,l+f):Math.min(f,
l);for(k=0>k?Math.max(0,k+f):Math.min(f,k);l<k;l+=h)d.push(e[l]);return d};m.json._find=function(e,l){function k(d){l&&(!0===l&&!(d instanceof Array)?h.push(d):d[l]&&h.push(d[l]));for(var b in d){var e=d[b];l?e&&"object"==typeof e&&k(e):h.push(e)}}var h=[];if(l instanceof Array){if(1==l.length)return e[l[0]];for(var f=0;f<l.length;f++)h.push(e[l[f]])}else k(e);return h};m.json._distinctFilter=function(e,l){for(var k=[],h={},f=0,d=e.length;f<d;++f){var b=e[f];l(b,f,e)&&("object"==typeof b&&b?b.__included||
(b.__included=!0,k.push(b)):h[b+typeof b]||(h[b+typeof b]=!0,k.push(b)))}f=0;for(d=k.length;f<d;++f)k[f]&&delete k[f].__included;return k};return m.json.query=function(e,l){function k(a){b=a+"("+b}function h(a,b,e,f,g,h,k,l){return d[l].match(/[\*\?]/)||"~"==k?"/^"+d[l].substring(1,d[l].length-1).replace(/\\([btnfr\\"'])|([^\w\*\?])/g,"\\$1$2").replace(/([\*\?])/g,"[\\w\\W]$1")+("~"==k?"$/i":"$/")+".test("+b+")":a}var f=0,d=[];e=e.replace(/"(\\.|[^"\\])*"|'(\\.|[^'\\])*'|[\[\]]/g,function(a){f+="["==
a?1:"]"==a?-1:0;return"]"==a&&0<f?"`]":'"'==a.charAt(0)||"'"==a.charAt(0)?"`"+(d.push(a)-1):a});var b="";e.replace(/(\]|\)|push|pop|shift|splice|sort|reverse)\s*\(/,function(){throw Error("Unsafe function call");});e=e.replace(/([^<>=]=)([^=])/g,"$1\x3d$2").replace(/@|(\.\s*)?[a-zA-Z\$_]+(\s*:)?/g,function(a){return"."==a.charAt(0)?a:"@"==a?"$obj":(a.match(/:|^(\$|Math|true|false|null)$/)?"":"$obj.")+a}).replace(/\.?\.?\[(`\]|[^\]])*\]|\?.*|\.\.([\w\$_]+)|\.\*/g,function(a,b,d){return(b=a.match(/^\.?\.?(\[\s*\^?\?|\^?\?|\[\s*==)(.*?)\]?$/))?
(d="",a.match(/^\./)&&(k("dojox.json._find"),d=",true)"),k(b[1].match(/\=/)?"dojo.map":b[1].match(/\^/)?"dojox.json._distinctFilter":"dojo.filter"),d+",function($obj){return "+b[2]+"})"):(b=a.match(/^\[\s*([\/\\].*)\]/))?".concat().sort(function(a,b){"+b[1].replace(/\s*,?\s*([\/\\])\s*([^,\\\/]+)/g,function(a,b,c){return"var av\x3d "+c.replace(/\$obj/,"a")+",bv\x3d "+c.replace(/\$obj/,"b")+";if(av\x3ebv||bv\x3d\x3dnull){return "+("/"==b?1:-1)+";}\nif(bv\x3eav||av\x3d\x3dnull){return "+("/"==b?-1:
1)+";}\n"})+"return 0;})":(b=a.match(/^\[(-?[0-9]*):(-?[0-9]*):?(-?[0-9]*)\]/))?(k("dojox.json._slice"),","+(b[1]||0)+","+(b[2]||0)+","+(b[3]||1)+")"):a.match(/^\.\.|\.\*|\[\s*\*\s*\]|,/)?(k("dojox.json._find"),("."==a.charAt(1)?",'"+d+"'":a.match(/,/)?","+a:"")+")"):a}).replace(/(\$obj\s*((\.\s*[\w_$]+\s*)|(\[\s*`([0-9]+)\s*`\]))*)(==|~)\s*`([0-9]+)/g,h).replace(/`([0-9]+)\s*(==|~)\s*(\$obj\s*((\.\s*[\w_$]+)|(\[\s*`([0-9]+)\s*`\]))*)/g,function(a,b,d,e,f,g,k,l){return h(a,e,f,g,k,l,d,b)});e=b+("$"==
e.charAt(0)?"":"$")+e.replace(/`([0-9]+|\])/g,function(a,b){return"]"==b?"]":d[b]});for(var g=eval("1\x26\x26function($,$1,$2,$3,$4,$5,$6,$7,$8,$9){var $obj\x3d$;return "+e+"}"),a=0;a<arguments.length-1;a++)arguments[a]=arguments[a+1];return l?g.apply(this,arguments):g}})},"esri/tasks/PrintParameters":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(e,l,m,n){return e(null,{declaredClass:"esri.tasks.PrintParameters",map:null,template:null,outSpatialReference:null,
extraParameters:null})})},"dijit/form/Form":function(){define("dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/sniff ../_Widget ../_TemplatedMixin ./_FormMixin ../layout/_ContentPaneResizeMixin".split(" "),function(e,l,m,n,s,k,h,f){return e("dijit.form.Form",[s,k,h,f],{name:"",action:"",method:"",encType:"","accept-charset":"",accept:"",target:"",templateString:"\x3cform data-dojo-attach-point\x3d'containerNode' data-dojo-attach-event\x3d'onreset:_onReset,onsubmit:_onSubmit' ${!nameAttrSetting}\x3e\x3c/form\x3e",
postMixInProperties:function(){this.nameAttrSetting=this.name?"name\x3d'"+this.name+"'":"";this.inherited(arguments)},execute:function(){},onExecute:function(){},_setEncTypeAttr:function(d){l.set(this.domNode,"encType",d);n("ie")&&(this.domNode.encoding=d);this._set("encType",d)},reset:function(d){var b={returnValue:!0,preventDefault:function(){this.returnValue=!1},stopPropagation:function(){},currentTarget:d?d.target:this.domNode,target:d?d.target:this.domNode};!1!==this.onReset(b)&&b.returnValue&&
this.inherited(arguments,[])},onReset:function(){return!0},_onReset:function(d){this.reset(d);d.stopPropagation();d.preventDefault();return!1},_onSubmit:function(d){var b=this.constructor.prototype;if(this.execute!=b.execute||this.onExecute!=b.onExecute)m.deprecated("dijit.form.Form:execute()/onExecute() are deprecated. Use onSubmit() instead.","","2.0"),this.onExecute(),this.execute(this.getValues());!1===this.onSubmit(d)&&(d.stopPropagation(),d.preventDefault())},onSubmit:function(){return this.isValid()},
submit:function(){!1!==this.onSubmit()&&this.containerNode.submit()}})})},"dijit/ProgressBar":function(){define("require dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/number ./_Widget ./_TemplatedMixin dojo/text!./templates/ProgressBar.html".split(" "),function(e,l,m,n,s,k,h,f){return l("dijit.ProgressBar",[k,h],{progress:"0",value:"",maximum:100,places:0,indeterminate:!1,label:"",name:"",templateString:f,_indeterminateHighContrastImagePath:e.toUrl("./themes/a11y/indeterminate_progress.gif"),
postMixInProperties:function(){this.inherited(arguments);this.params&&"value"in this.params||(this.value=this.indeterminate?Infinity:this.progress)},buildRendering:function(){this.inherited(arguments);this.indeterminateHighContrastImage.setAttribute("src",this._indeterminateHighContrastImagePath.toString());this.update()},_setDirAttr:function(d){var b="rtl"==d.toLowerCase();m.toggle(this.domNode,"dijitProgressBarRtl",b);m.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&
b);this.inherited(arguments)},update:function(d){n.mixin(this,d||{});d=this.internalProgress;var b=this.domNode,e=1;this.indeterminate?b.removeAttribute("aria-valuenow"):(-1!=String(this.progress).indexOf("%")?(e=Math.min(parseFloat(this.progress)/100,1),this.progress=e*this.maximum):(this.progress=Math.min(this.progress,this.maximum),e=this.maximum?this.progress/this.maximum:0),b.setAttribute("aria-valuenow",this.progress));b.setAttribute("aria-labelledby",this.labelNode.id);b.setAttribute("aria-valuemin",
0);b.setAttribute("aria-valuemax",this.maximum);this.labelNode.innerHTML=this.report(e);m.toggle(this.domNode,"dijitProgressBarIndeterminate",this.indeterminate);m.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&!this.isLeftToRight());d.style.width=100*e+"%";this.onChange()},_setValueAttr:function(d){this._set("value",d);Infinity==d?this.update({indeterminate:!0}):this.update({indeterminate:!1,progress:d})},_setLabelAttr:function(d){this._set("label",d);this.update()},_setIndeterminateAttr:function(d){this._set("indeterminate",
d);this.update()},report:function(d){return this.label?this.label:this.indeterminate?"\x26#160;":s.format(d,{type:"percent",places:this.places,locale:this.lang})},onChange:function(){}})})},"dijit/form/RadioButton":function(){define(["dojo/_base/declare","./CheckBox","./_RadioButtonMixin"],function(e,l,m){return e("dijit.form.RadioButton",[l,m],{baseClass:"dijitRadio"})})},"dijit/form/_RadioButtonMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/lang dojo/query!css2 ../registry".split(" "),
function(e,l,m,n,s,k){return l("dijit.form._RadioButtonMixin",null,{type:"radio",_getRelatedWidgets:function(){var e=[];s("input[type\x3dradio]",this.focusNode.form||this.ownerDocument).forEach(n.hitch(this,function(f){f.name==this.name&&f.form==this.focusNode.form&&(f=k.getEnclosingWidget(f))&&e.push(f)}));return e},_setCheckedAttr:function(h){this.inherited(arguments);this._created&&h&&e.forEach(this._getRelatedWidgets(),n.hitch(this,function(e){e!=this&&e.checked&&e.set("checked",!1)}))},_getSubmitValue:function(e){return null==
e?"on":e},_onClick:function(h){return this.checked||this.disabled?(h.stopPropagation(),h.preventDefault(),!1):this.readOnly?(h.stopPropagation(),h.preventDefault(),e.forEach(this._getRelatedWidgets(),n.hitch(this,function(e){m.set(this.focusNode||this.domNode,"checked",e.checked)})),!1):this.inherited(arguments)}})})},"widgets/Print/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings","dojo/text!./config.json"],function(){})},"url:widgets/Print/templates/Print.html":'\x3cdiv class\x3d"gis_PrintDijit"\x3e\r\n    \x3cdiv class\x3d"formContainer"\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"printSettingsFormDijit"\x3e\r\n            \x3ctable cellspacing\x3d"5" style\x3d"width:100%;"\x3e\r\n                \x3ctr\x3e\r\n                    \x3ctd style\x3d"width:65px;"\x3e\r\n                        ${nls.title}:\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                        \x3cinput type\x3d"text" data-dojo-attach-point\x3d"titleNode" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"name:\'title\',trim:true,required:true,style:\'width:100%;\'" /\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3ctr style\x3d"display: none"\x3e\r\n                    \x3ctd\x3e\r\n                        ${nls.layout}:\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                        \x3cinput type\x3d"select" data-dojo-type\x3d"dijit/form/Select" data-dojo-props\x3d"name:\'layout\',style:\'width:100%;\'"\r\n                        data-dojo-attach-point\x3d"layoutDijit" /\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3ctr style\x3d"display: none"\x3e\r\n                    \x3ctd\x3e\r\n                        ${nls.format}:\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                        \x3cinput type\x3d"select" data-dojo-type\x3d"dijit/form/Select" data-dojo-props\x3d"name:\'format\',style:\'width:100%;\'"\r\n                        data-dojo-attach-point\x3d"formatDijit" /\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n            \x3c/table\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"buttonActionBar jimu-align-trailing"\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/form/DropDownButton" data-dojo-attach-point\x3d"advancedButtonDijit" data-dojo-props\x3d"iconClass:\'settingsIcon\',showLabel:true" style\x3d"display: none"\x3e\r\n            \x3cspan\x3e\r\n                ${nls.settings}\r\n            \x3c/span\x3e\r\n            \x3cdiv data-dojo-type\x3d"dijit/TooltipDialog" class\x3d"gis_PrintDijit"\x3e\r\n                \x3cdiv style\x3d"width:250px;"\x3e\r\n                    \x3cdiv style\x3d"font-weight:bold;"\x3e\r\n                        ${nls.mapScaleExtent}:\r\n                    \x3c/div\x3e\r\n                    \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"preserveFormDijit"\x3e\r\n                        \x3ctable cellspacing\x3d"5"\x3e\r\n                            \x3ctr\x3e\r\n                                \x3ctd style\x3d"vertical-align:middle;"\x3e\r\n                                    ${nls.preserve}:\r\n                                \x3c/td\x3e\r\n                                \x3ctd\x3e\r\n                                    \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"name:\'preserveScale\',checked:true,value:\'true\'"\r\n                                    /\x3e\r\n                                    ${nls.mapScale}\x26nbsp;\x26nbsp;\r\n                                    \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"name:\'preserveScale\',value:\'false\'"\r\n                                    /\x3e\r\n                                    ${nls.mapExtent}\r\n                                \x3c/td\x3e\r\n                                \x3ctr\x3e\r\n                                    \x3ctd\x3e\r\n                                        ${nls.forceScale}:\r\n                                    \x3c/td\x3e\r\n                                    \x3ctd\x3e\r\n                                        \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"name:\'preserveScale\',value:\'force\',checked:false"/\x3e \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'forcedScale\',required:false,style:\'width:100px;\'" data-dojo-attach-point\x3d"forceScaleNTB"/\x3e \x3ca href\x3d"#" data-dojo-attach-event\x3d"click:getCurrentMapScale"\x3e${nls.getCurrentScale}\x3c/a\x3e\r\n                                    \x3c/td\x3e\r\n                                \x3c/tr\x3e\r\n                            \x3c/tr\x3e\r\n                        \x3c/table\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv style\x3d"font-weight:bold;"\x3e\r\n                        ${nls.mapMetadata}:\r\n                    \x3c/div\x3e\r\n                    \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"layoutMetadataDijit"\x3e\r\n                        \x3ctable cellspacing\x3d"5" style\x3d"width:100%;"\x3e\r\n                            \x3ctr\x3e\r\n                                \x3ctd\x3e\r\n                                    ${nls.author}:\r\n                                \x3c/td\x3e\r\n                                \x3ctd\x3e\r\n                                    \x3cinput type\x3d"text" data-dojo-attach-point\x3d"authorNode" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"name:\'author\',trim:true,required:false,style:\'width:100%;\'" data-dojo-attach-point\x3d"authorTB"\r\n                                    /\x3e\r\n                                \x3c/td\x3e\r\n                            \x3c/tr\x3e\r\n                            \x3ctr\x3e\r\n                                \x3ctd\x3e\r\n                                    ${nls.copyright}:\r\n                                \x3c/td\x3e\r\n                                \x3ctd\x3e\r\n                                    \x3cinput type\x3d"text" data-dojo-attach-point\x3d"copyrightNode" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"name:\'copyright\',trim:true,required:false,style:\'width:100%;\'" /\x3e\r\n                                \x3c/td\x3e\r\n                            \x3c/tr\x3e\r\n                        \x3c/table\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"layoutFormDijit"\x3e\r\n                        \x3ctable cellspacing\x3d"5"\x3e\r\n                            \x3ctr\x3e\r\n                                \x3ctd\x3e\r\n                                    ${nls.lncludeLegend}:\r\n                                \x3c/td\x3e\r\n                                \x3ctd\x3e\r\n                                    \x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d"name:\'legend\',value:true,checked:true"\r\n                                    /\x3e\r\n                                \x3c/td\x3e\r\n                            \x3c/tr\x3e\r\n                        \x3c/table\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv style\x3d"font-weight:bold;"\x3e\r\n                        ${nls.mapOnlyOptions}:\r\n                    \x3c/div\x3e\r\n                    \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"mapOnlyFormDijit"\x3e\r\n                        \x3ctable cellspacing\x3d"5"\x3e\r\n                            \x3ctr\x3e\r\n                                \x3ctd\x3e\r\n                                    ${nls.width}:\r\n                                \x3c/td\x3e\r\n                                \x3ctd\x3e\r\n                                    \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'width\',required:true,value:670,style:\'width:100px;\'"\r\n                                    /\x3e\r\n                                \x3c/td\x3e\r\n                            \x3c/tr\x3e\r\n                            \x3ctr\x3e\r\n                                \x3ctd\x3e\r\n                                    ${nls.height}:\r\n                                \x3c/td\x3e\r\n                                \x3ctd\x3e\r\n                                    \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'height\',required:true,value:500,style:\'width:100px;\'"\r\n                                    /\x3e\r\n                                \x3c/td\x3e\r\n                            \x3c/tr\x3e\r\n                        \x3c/table\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv style\x3d"font-weight:bold;"\x3e\r\n                        ${nls.printQualityOptions}:\r\n                    \x3c/div\x3e\r\n                    \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"mapQualityFormDijit"\x3e\r\n                        \x3ctable cellspacing\x3d"5"\x3e\r\n                            \x3ctr\x3e\r\n                                \x3ctd\x3e\r\n                                    ${nls.dpi}:\r\n                                \x3c/td\x3e\r\n                                \x3ctd\x3e\r\n                                    \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'dpi\',required:true,value:96,style:\'width:100px;\'"\r\n                                    /\x3e\r\n                                \x3c/td\x3e\r\n                            \x3c/tr\x3e\r\n                        \x3c/table\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"busyLabel:\'printing\',iconClass:\'printIcon\'"\r\n        data-dojo-attach-event\x3d"onClick:print" data-dojo-attach-point\x3d"printButtonDijit"\x3e\r\n            ${nls.print}\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- \x3chr calss\x3d"spacer"\x3e --\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"printResultsNode" class\x3d"resultsContainer"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"clearActionBarNode" class\x3d"buttonActionBar"\r\n    style\x3d"display:none;padding:0;"\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'clearIcon\'"\r\n        data-dojo-attach-event\x3d"onClick:clearResults"\x3e\r\n            ${nls.clearList}\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/Print/templates/PrintResult.html":'\x3cdiv class\x3d"printResult" data-dojo-attach-point\x3d"resultNode" data-dojo-attach-event\x3d"onclick:_openPrint"\x3e\r\n  \x3ctable class\x3d"printResultTable"\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd width\x3d"25px"\x3e\r\n        \x3cspan class\x3d"bold"\x3e${count}.\x3c/span\x3e\r\n      \x3c/td\x3e\r\n      \x3ctd width\x3d"30px"\x3e\r\n        \x3cimg src\x3d"${icon}"\x3e\r\n      \x3c/td\x3e\r\n      \x3ctd data-dojo-attach-point\x3d"nameNode"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"progressBar" data-dojo-type\x3d"dijit/ProgressBar" data-dojo-props\x3d\'value:Infinity,label:"${nls.creatingPrint}"\'\x3e\x3c/div\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"successNode" class\x3d"bold" style\x3d"display:none;"\x3e${docName}\x3c/span\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"errNode" style\x3d"display:none;"\x3e\r\n          \x3cspan class\x3d"bold"\x3e${nls.printError}\x3c/span\x3e\r\n          \x3cdiv class\x3d"jimu-icon jimu-icon-error jimu-float-trailing"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/ProgressBar.html":'\x3cdiv class\x3d"dijitProgressBar dijitProgressBarEmpty" role\x3d"progressbar"\r\n\t\x3e\x3cdiv  data-dojo-attach-point\x3d"internalProgress" class\x3d"dijitProgressBarFull"\r\n\t\t\x3e\x3cdiv class\x3d"dijitProgressBarTile" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\x3e\x3cspan style\x3d"visibility:hidden"\x3e\x26#160;\x3c/span\r\n\t\x3e\x3c/div\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"labelNode" class\x3d"dijitProgressBarLabel" id\x3d"${id}_label"\x3e\x3c/div\r\n\t\x3e\x3cspan data-dojo-attach-point\x3d"indeterminateHighContrastImage"\r\n\t\t   class\x3d"dijitInline dijitProgressBarIndeterminateHighContrastImage"\x3e\x3c/span\r\n\x3e\x3c/div\x3e\r\n',
"url:widgets/Print/Widget.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"printNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/Print/css/style.css":".jimu-widget-print{width: 100%; height: 100%; position: relative;}.jimu-widget-print .dijitSelect{height: 20px; width: 100%;}.gis_PrintDijit {width: 100%;}.gis_PrintDijit .printResult {height: 28px; margin-bottom: -1px; width: 100%;}.gis_PrintDijit .printResult .printResultTable {width: 100%;}.gis_PrintDijit .printResult .bold {font-weight: bold;}.gis_PrintDijit .printResultError {font-weight: bold; color: red; cursor: help;}.gis_PrintDijit .printResultHover table:hover {background-color: #D4E7F8; cursor: pointer;}.gis_PrintDijit .buttonActionBar {padding: 3px 0px 2px 0px; width: 100%;}.gis_PrintDijit .formContainer {margin-bottom: -1px; width: 100%;}.gis_PrintDijit .resultsContainer {width: 100%; margin-top: 10px;}.gis_PrintDijit .printIcon {background-image: url(../images/print.png); width: 16px; height: 16px;}.gis_PrintDijit .clearIcon {background-image: url(../images/clear.png); width: 16px; height: 16px;}.gis_PrintDijit .settingsIcon {background-image: url(../images/settings.png); width: 16px; height: 16px;}.gis_PrintDijit .dijitArrowButtonContainer{width: 17px;}",
"url:widgets/Print/config.json":'{\r\n  "serviceURL": "",\r\n  "defaultTitle": "ArcGIS Web Map",\r\n  "defaultAuthor": "Web AppBuilder for ArcGIS",\r\n  "defaultCopyright": "",\r\n  "defaultFormat": "PDF",\r\n  "defaultLayout": "Letter ANSI A Landscape"\r\n}',"*now":function(e){e(['dojo/i18n!*preload*widgets/Print/nls/Widget*["ar","cs","da","de","en","el","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare jimu/BaseWidget jimu/portalUtils dojo/_base/lang dojo/Deferred jimu/dijit/Message jimu/dijit/LoadingShelter ./Print esri/request dojo/json jimu/portalUrlUtils".split(" "),function(e,l,m,n,s,k,h,f,d,b,g){return e([l],{baseClass:"jimu-widget-print",name:"Print",className:"esri.widgets.Print",_portalPrintTaskURL:null,postCreate:function(){this.inherited(arguments);this.shelter=new h({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup()},startup:function(){this.inherited(arguments);
this.shelter.show();this._initPrinter()},_initPrinter:function(){this._getPrintTaskURL(this.appConfig.portalUrl).then(n.hitch(this,function(a){this.shelter.show();this.isAsync(a).then(n.hitch(this,function(b){this.print=new f({map:this.map,appConfig:this.appConfig,printTaskURL:a,defaultAuthor:this.config.defaultAuthor,defaultCopyright:this.config.defaultCopyright,defaultTitle:this.config.defaultTitle,defaultFormat:this.config.defaultFormat,defaultLayout:this.config.defaultLayout,nls:this.nls,async:b});
this.print.placeAt(this.printNode);this.print.startup()}),n.hitch(this,function(a){new k({message:a.message})})).always(n.hitch(this,function(){this.shelter.hide()}))}),n.hitch(this,function(a){new k({message:a});console.error(a);this.shelter.hide()}))},_getPrintTaskURL:function(a){var b=new s;if(this.config&&this.config.serviceURL)return b.resolve(this.config.serviceURL),b;m.getPortalSelfInfo(a).then(n.hitch(this,function(a){(a=a&&a.helperServices&&a.helperServices.printTask&&a.helperServices.printTask.url)?
b.resolve(a):b.reject("error")}),n.hitch(this,function(a){new k({message:this.nls.portalConnectionError});b.reject("error");console.error(a)}));return b},isAsync:function(a){var c=new s,e="json",f=g.setHttpProtocol(a),h=g.getNewPrintUrl(this.appConfig.portalUrl);if(f===h||/sharing\/tools\/newPrint$/.test(f))e="text";d({url:a,content:{f:"json"},callbackParamName:"callback",handleAs:e||"json",timeout:6E4,load:n.hitch(this,function(d){var e=null;try{e="string"===typeof d?b.parse(d):d}catch(f){d=g.setHttpProtocol(a);
e=g.getNewPrintUrl(this.appConfig.portalUrl);d===e?c.resolve(!1):c.reject(f);return}"esriExecutionTypeAsynchronous"===e.executionType?c.resolve(!0):c.resolve(!1)}),error:n.hitch(this,function(a){c.reject(a)})});return c},onSignIn:function(a){a=a||{};a.userId&&this.print&&this.print.updateAuthor(a.userId)}})});