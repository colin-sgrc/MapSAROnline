//>>built
require({cache:{"widgets/Bookmark/ImageNode":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dojo/on dojo/query dojo/mouse".split(" "),function(h,e,d,b,l,k,f){return h([b,l],{templateString:'\x3cdiv class\x3d"jimu-img-node"\x3e\x3c/div\x3e',constructor:function(b,d){},postCreate:function(){this.box=d.create("div",{"class":"node-box"},this.domNode);d.create("img",{src:this.img},this.box);d.create("div",{"class":"node-label",innerHTML:this.label,
title:this.label},this.domNode);this.own(k(this.domNode,"click",e.hitch(this,this.onClick)))},onClick:function(){f(".jimu-img-node",this.getParent().domNode).removeClass("jimu-state-selected");f(this.domNode).addClass("jimu-state-selected")},highLight:function(){f(".jimu-img-node",this.getParent().domNode).removeClass("jimu-state-selected");f(this.domNode).addClass("jimu-state-selected")},startup:function(){}})})},"widgets/Bookmark/_build-generate_module":function(){define(["dojo/text!./Widget.html",
"dojo/text!./css/style.css","dojo/i18n!./nls/strings","dojo/text!./config.json"],function(){})},"url:widgets/Bookmark/Widget.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"jimu-r-row add-section"\x3e\r\n\t\t\x3cinput class\x3d"jimu-input input-bookmark-name" data-dojo-attach-point\x3d"bookmarkName" type\x3d"text" placeholder\x3d"${nls.placeholderBookmarkName}"\x3e\r\n\t\t\x3cdiv class\x3d"btn-add" data-dojo-attach-point\x3d"btnAdd" data-dojo-attach-event\x3d"onclick:_onAddBtnClicked"\x3e\x3cdiv class\x3d"jimu-center-img"\x3e\x3c/div\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"jimu-state-error" data-dojo-attach-point\x3d"errorNode"\x3e\x26nbsp;\x3c/div\x3e\t\t\r\n\t\x3cdiv class\x3d"bookmark-list" data-dojo-attach-point\x3d"bookmarkListNode"\x3e\r\n\t\t\r\n\t\x3c/div\x3e\r\n\r\n\t\x3cdiv class\x3d"jimu-r-row play-section"\x3e\r\n\t\t\x3cdiv class\x3d"col-1-2"\x3e\r\n\t\t\t\x3cdiv class\x3d"jimu-btn btn-play" data-dojo-attach-point\x3d"btnPlay" data-dojo-attach-event\x3d"onclick:_onPlayBtnClicked"\x3e${nls.labelPlay}\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"col-1-2"\x3e\r\n\t\t\t\x3cdiv class\x3d"jimu-btn btn-delete" data-dojo-attach-point\x3d"btnDelete" data-dojo-attach-event\x3d"onclick:_onDeleteBtnClicked"\x3e${nls.labelDelete}\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\r\n\x3c/div\x3e\r\n',
"url:widgets/Bookmark/css/style.css":".jimu-img-node{font-size: 12px; position: relative; float: left; border-radius: 4px; color: #686868; overflow: hidden;}.jimu-img-node .node-box{position: absolute; top: 0; bottom: 32px; left: 0; width: 100%; border-radius: 4px; overflow: hidden;}.jimu-img-node img{width: 100%; height: 100%; cursor: pointer;}.jimu-img-node .node-label{position: absolute; width: 100%; left: 0; bottom: 0; height: 30px; text-align: center; overflow: hidden; text-overflow: ellipsis;}.jimu-img-node:hover{color: #51b1fe;}.jimu-img-node.jimu-state-selected .node-label{background-color: #d9dde0;}.jimu-widget-bookmark{width: 100%; height: 100%; overflow: hidden;}.jimu-widget-bookmark .add-section{position: relative; height: 30px; margin-top: 7px; overflow: visible;}.jimu-widget-bookmark .input-bookmark-name{border-top-right-radius: 0; border-bottom-right-radius: 0; position: absolute; left: 0; top: 0; width: 100%;}.jimu-widget-bookmark .btn-add{position: absolute; right: 1px; top: 1px; bottom: 1px; width: 30px; z-index: 2; border-top-right-radius: 2px; border-bottom-right-radius: 2px; background-color: #d9dde0; cursor: pointer;}.jimu-widget-bookmark .btn-add .jimu-center-img{border-top: 1px solid rgba(255, 255, 255, 0.2); background-image: url(images/add.png);}.jimu-widget-bookmark .jimu-state-error{margin-top: 4px; visibility: hidden;}.jimu-widget-bookmark .play-section{overflow: hidden; margin-top: 20px;}.jimu-widget-bookmark .jimu-btn{float: none; margin: auto; width: 150px;}.FoldableTheme.green .jimu-widget-bookmark .btn-add{background-color: #80dbc5;}.FoldableTheme.cyan .jimu-widget-bookmark .btn-add{background-color: #d5d5d4;}.jimu-rtl .jimu-widget-bookmark .btn-add{left: 1px; right: auto;}",
"url:widgets/Bookmark/config.json":'{\r\n\t"bookmarks2D": [],\r\n\t"bookmarks3D": [],\r\n\t"flyTime": 3000\r\n}\r\n',"*now":function(h){h(['dojo/i18n!*preload*widgets/Bookmark/nls/Widget*["ar","cs","da","de","en","el","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html jimu/BaseWidget dojo/on dojo/aspect dojo/string esri/SpatialReference ./ImageNode jimu/dijit/TileLayoutContainer jimu/utils libs/storejs/store".split(" "),function(h,e,d,b,l,k,f,n,m,p,q,r,g){return h([l],{baseClass:"jimu-widget-bookmark",name:"Bookmark",bookmarks:[],currentIndex:-1,_canDelete:!1,_canPlay:!1,_playStatus:"none",startup:function(){this.inherited(arguments);this.bookmarkList=new q({strategy:"fixWidth",itemSize:{width:100,
height:92},hmargin:15,vmargin:5},this.bookmarkListNode);this.appConfig.map["3D"]?(b.setStyle(this.btnPlay,"display",""),f.after(this.map,"onCameraChangeEnd",e.hitch(this,this._onFlytoEnd),!0),f.after(this.map,"onCameraChangeBreak",e.hitch(this,this._onFlytoBreak),!0)):b.setStyle(this.btnPlay,"display","none");this.bookmarkList.startup();this.own(k(this.bookmarkName,"keydown",e.hitch(this,function(a){13===(void 0!==a.keyCode?a.keyCode:a.which)&&this._onAddBtnClicked()})))},onOpen:function(){var a=
this._getLocalCache();this.bookmarks=0<a.length?a:this.appConfig.map["3D"]?e.clone(this.config.bookmarks3D):e.clone(this.config.bookmarks2D);this._readBookmarksInWebmap();this.displayBookmarks()},onClose:function(){this.bookmarks=[];this.currentIndex=-1},onMinimize:function(){this.resize()},onMaximize:function(){this.resize()},resize:function(){var a=b.getMarginBox(this.domNode).h-37-21-61;0>a&&(a=0);b.setStyle(this.bookmarkListNode,"height",a+"px");this.bookmarkList&&this.bookmarkList.resize()},
destroy:function(){this.bookmarkList.destroy();this.inherited(arguments)},displayBookmarks:function(){var a=[];this.bookmarkList.empty();d.forEach(this.bookmarks,function(c){a.push(this._createBookMarkNode(c))},this);this.bookmarkList.addItems(a);this._switchDeleteBtn();this._switchPlayBtn();this.resize()},_readBookmarksInWebmap:function(){this.map.itemInfo&&(this.map.itemInfo.itemData&&this.map.itemInfo.itemData.bookmarks)&&d.forEach(this.map.itemInfo.itemData.bookmarks,function(a){a.isInWebmap=
!0;a.name=a.name;for(var c=0,b=0;b<this.bookmarks.length;b++)this.bookmarks[b].name===a.name&&c++;c||this.bookmarks.push(a)},this)},_switchDeleteBtn:function(){-1<this.currentIndex&&!this.bookmarks[this.currentIndex].isInWebmap?(b.removeClass(this.btnDelete,"jimu-state-disabled"),this._canDelete=!0):(b.addClass(this.btnDelete,"jimu-state-disabled"),this._canDelete=!1)},_switchPlayBtn:function(){1<this.bookmarks.length?(b.removeClass(this.btnPlay,"jimu-state-disabled"),this._canPlay=!0):(b.addClass(this.btnPlay,
"jimu-state-disabled"),this._canPlay=!1)},_switchPlayStatus:function(a){this._playStatus=a;this.btnPlay.innerHTML="none"===this._playStatus||"stop"===this._playStatus?this.nls.labelPlay:this.nls.labelStop},_createBookMarkNode:function(a){var c;c=a.thumbnail?r.processUrlInWidgetConfig(a.thumbnail,this.folderUrl):this.folderUrl+"images/thumbnail_default.png";c=new p({img:c,label:a.name});k(c.domNode,"click",e.hitch(this,e.partial(this._onBookmarkClick,a)));return c},_getKeysKey:function(){return this.appConfig.map["3D"]?
this.name+".3D":this.name+".2D"},_saveAllToLocalCache:function(){var a=[];d.forEach(g.get(this._getKeysKey()),function(a){g.remove(a)},this);d.forEach(this.bookmarks,function(c){if(!c.isInWebmap){var b=this._getKeysKey()+"."+c.name;a.push(b);g.set(b,c)}},this);g.set(this._getKeysKey(),a)},_getLocalCache:function(){var a=[];if(!g.get(this._getKeysKey()))return a;d.forEach(g.get(this._getKeysKey()),function(c){c.startWith(this._getKeysKey())&&a.push(g.get(c))},this);return a},_onFlytoEnd:function(a){"stop"===
this._playStatus||"none"===this._playStatus||(this.currentIndex+1===this.bookmarkList.items.length?this._switchPlayStatus("stop"):(this.currentIndex++,this.bookmarkList.items[this.currentIndex].highLight(),setTimeout(e.hitch(this,this._setCamera,this.bookmarks[this.currentIndex]),this.config.stopTime)))},_onFlytoBreak:function(){"playing"===this._playStatus&&this._switchPlayStatus("stop")},_onAddBtnClicked:function(){0===n.trim(this.bookmarkName.value).length?(b.setStyle(this.errorNode,{visibility:"visible"}),
this.errorNode.innerHTML=this.nls.errorNameNull):d.some(this.bookmarks,function(a){if(a.name===this.bookmarkName.value)return!0},this)?(b.setStyle(this.errorNode,{visibility:"visible"}),this.errorNode.innerHTML=this.nls.errorNameExist):(this._createBookmark(),b.setStyle(this.errorNode,{visibility:"hidden"}),this.errorNode.innerHTML="\x26nbsp;",this.bookmarkName.value="",this.displayBookmarks())},_onPlayBtnClicked:function(){this._canPlay&&("playing"===this._playStatus?this._switchPlayStatus("stop"):
(this._switchPlayStatus("playing"),this.currentIndex=0,this._switchDeleteBtn(),this.bookmarkList.items[this.currentIndex].highLight(),this._setCamera(this.bookmarks[this.currentIndex])))},_createBookmark:function(){var a;this.appConfig.map["3D"]?(a=this.map.getCamera(new m(4326)),a={name:this.bookmarkName.value,camera:[a.x,a.y,a.z,a.heading,a.tilt]}):a={name:this.bookmarkName.value,extent:this.map.extent.toJson()};this.bookmarks.push(a);this._createBookMarkNode(a);this._saveAllToLocalCache();this.resize()},
_onDeleteBtnClicked:function(){this._canDelete&&-1!==this.currentIndex&&(d.some(this.bookmarks,function(a,c){if(c===this.currentIndex)return this.bookmarks.splice(c,1),!0},this),this._saveAllToLocalCache(),this.resize(),this.currentIndex=-1,this.displayBookmarks())},_onBookmarkClick:function(a){d.some(this.bookmarks,function(c,b){if(c.name===a.name)return this.currentIndex=b,!0},this);this._switchDeleteBtn();this.appConfig.map["3D"]?this._setCamera(a):require(["esri/geometry/Extent"],e.hitch(this,
function(c){var b=a.extent;b.spatialReference?new m(b.spatialReference):new m({wkid:4326});this.map.setExtent(new c(b))}))},_setCamera:function(a){this.map.setCamera(a.camera,this.config.flyTime)}})});