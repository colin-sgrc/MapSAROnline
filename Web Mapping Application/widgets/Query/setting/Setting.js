//>>built
require({cache:{"jimu/dijit/_QueryableLayerSourcePopup":function(){define("dojo/_base/declare dojo/Evented dojo/on dojo/_base/lang dojo/_base/html jimu/dijit/Popup jimu/dijit/QueryableLayerSource jimu/dijit/LoadingIndicator esri/request".split(" "),function(l,n,t,q,k,e,c,g,b){return l([e,n],{width:830,height:560,titleLabel:"",dijitArgs:null,postCreate:function(){this.inherited(arguments);k.addClass(this.domNode,"jimu-queryable-layer-source-popup");this._initFls();this._initLoading()},getSelectedRadioType:function(){return this.sourceDijit.getSelectedRadioType()},
_initFls:function(){this.sourceDijit=new c(this.dijitArgs);this.sourceDijit.placeAt(this.contentContainerNode);this.sourceDijit.startup();this.own(t(this.sourceDijit,"ok",q.hitch(this,function(e){if(0!==e.length){var c=e[0];if(c.definition)try{c.definition.name=c.name,c.definition.url=c.url,this.emit("ok",c)}catch(g){console.error(g)}else this.loading.show(),b({url:c.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(q.hitch(this,function(b){if(this.domNode){this.loading.hide();
c.definition=b;try{c.definition.name=c.name,c.definition.url=c.url,this.emit("ok",c)}catch(a){console.error(a)}}}),q.hitch(this,function(b){console.error(b);this.domNode&&this.loading.hide()}))}})));this.own(t(this.sourceDijit,"cancel",q.hitch(this,function(){try{this.emit("cancel")}catch(b){console.error(b)}})))},_initLoading:function(){this.loading=new g({hidden:!0});this.loading.placeAt(this.domNode);this.loading.startup()}})})},"jimu/dijit/QueryableLayerSource":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/QueryableLayerSource.html dojo/_base/lang dojo/_base/html dojo/on dojo/Evented jimu/dijit/QueryableLayerChooserFromMap jimu/dijit/QueryableServiceChooserFromPortal jimu/dijit/_QueryableServiceChooserContent jimu/portalUrlUtils".split(" "),
function(l,n,t,q,k,e,c,g,b,f,m,s,u){var a=l([n,t,q,b],{baseClass:"jimu-layer-chooser-with-buttons jimu-queryable-layer-chooser-with-buttons",declaredClass:"jimu.dijit.QueryableLayerChooserWithButtons",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"chooser-container" data-dojo-attach-point\x3d"chooserContainer"\x3e\x3c/div\x3e\x3cdiv class\x3d"footer"\x3e\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel" data-dojo-attach-point\x3d"btnCancel"\x3e${nls.cancel}\x3c/div\x3e\x3cdiv class\x3d"jimu-btn jimu-float-trailing ok jimu-trailing-margin1 jimu-state-disabled" data-dojo-attach-point\x3d"btnOk"\x3e${nls.ok}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
queryableLayerChooserArgs:null,postMixInProperties:function(){this.nls=e.clone(window.jimuNls.common)},postCreate:function(){this.inherited(arguments);this.queryableLayerChooserFromMap=new f(this.queryableLayerChooserArgs);this.queryableLayerChooserFromMap.placeAt(this.chooserContainer);c.setStyle(this.queryableLayerChooserFromMap.domNode,{width:"100%",height:"100%"});this.own(g(this.queryableLayerChooserFromMap,"tree-click",e.hitch(this,function(){0<this.getSelectedItems().length?c.removeClass(this.btnOk,
"jimu-state-disabled"):c.addClass(this.btnOk,"jimu-state-disabled")})));this.own(g(this.btnOk,"click",e.hitch(this,function(){var a=this.getSelectedItems();0<a.length&&this.emit("ok",a)})));this.own(g(this.btnCancel,"click",e.hitch(this,function(){this.emit("cancel")})))},getSelectedItems:function(){return this.queryableLayerChooserFromMap.getSelectedItems()},startup:function(){this.inherited(arguments);this.queryableLayerChooserFromMap.startup()}});return l([n,t,q,b],{templateString:k,baseClass:"jimu-layer-source jimu-queryable-layer-source",
declaredClass:"jimu.dijit.QueryableLayerSource",nls:null,multiple:!1,createMapResponse:null,portalUrl:null,postMixInProperties:function(){this.nls=window.jimuNls.queryableLayerSource;this.portalUrl=u.getStandardPortalUrl(this.portalUrl)},postCreate:function(){this.inherited(arguments);this._initSelf()},getSelectedRadioType:function(){if(this.mapRadio.checked)return"map";if(this.portalRadio.checked)return"portal";if(this.urlRadio.checked)return"url"},getSelectedItems:function(){var a=[];this.mapRadio.checked?
a=this.queryableLayerChooserFromMap.getSelectedItems():this.portalRadio.checked?a=this.queryableServiceChooserFromPortal.getSelectedItems():this.urlRadio.checked&&(a=this.queryableServiceChooserContent.getSelectedItems());return a},startup:function(){this.inherited(arguments);this.queryableLayerChooserFromMap.startup();this.queryableServiceChooserFromPortal.startup();this.queryableServiceChooserContent.startup()},_initSelf:function(){this._initRadios();this._createQueryableLayerChooserWithButtons();
this._createQueryableServiceChooserFromPortal();this._createQueryableServiceChooserContent();this._onRadioClicked()},_createQueryableLayerChooserWithButtons:function(){this.queryableLayerChooserFromMap=new a({style:{width:"100%",height:"100%"},queryableLayerChooserArgs:{multiple:this.multiple,createMapResponse:this.createMapResponse}});this.queryableLayerChooserFromMap.operationTip=this.nls.selectLayer;this.queryableLayerChooserFromMap.placeAt(this.mapDijitContainer);this.own(g(this.queryableLayerChooserFromMap,
"ok",e.hitch(this,function(a){a&&0<a.length&&this.emit("ok",a)})));this.own(g(this.queryableLayerChooserFromMap,"cancel",e.hitch(this,function(){this.emit("cancel")})))},_createQueryableServiceChooserFromPortal:function(){this.queryableServiceChooserFromPortal=new m({multiple:this.multiple,portalUrl:this.portalUrl,style:{width:"100%",height:"100%"}});this.queryableServiceChooserFromPortal.operationTip=this.nls.chooseItem;this.queryableServiceChooserFromPortal.placeAt(this.portalDijitContainer);this.own(g(this.queryableServiceChooserFromPortal,
"next",e.hitch(this,function(){this.queryableServiceChooserFromPortal.operationTip=this.nls.chooseItem+" -\x3e "+this.nls.chooseLayer;this._updateOperationTip()})));this.own(g(this.queryableServiceChooserFromPortal,"back",e.hitch(this,function(){this.queryableServiceChooserFromPortal.operationTip=this.nls.chooseItem;this._updateOperationTip()})));this.own(g(this.queryableServiceChooserFromPortal,"ok",e.hitch(this,function(a){a&&0<a.length&&this.emit("ok",a)})));this.own(g(this.queryableServiceChooserFromPortal,
"cancel",e.hitch(this,function(){this.emit("cancel")})));0<=(this.portalUrl||"").toLowerCase().indexOf(".arcgis.com")?this.portalLabel.innerHTML=this.nls.selectFromOnline:this.portalLabel.innerHTML=this.nls.selectFromPortal},_createQueryableServiceChooserContent:function(){this.queryableServiceChooserContent=new s({multiple:this.multiple,style:{width:"100%",height:"100%"}});this.queryableServiceChooserContent.operationTip=this.nls.setServiceUrl;this.queryableServiceChooserContent.placeAt(this.urlDijitContainer);
this.own(g(this.queryableServiceChooserContent,"ok",e.hitch(this,function(a){a&&0<a.length&&this.emit("ok",a)})));this.own(g(this.queryableServiceChooserContent,"cancel",e.hitch(this,function(){this.emit("cancel")})))},_initRadios:function(){var a="queryableLayerSourceRadios_"+this._getRandomString();this.mapRadio.name=a;c.setAttr(this.mapRadio,"id","mapRadio_"+this._getRandomString());c.setAttr(this.mapLabel,"for",this.mapRadio.id);this.portalRadio.name=a;c.setAttr(this.portalRadio,"id","portalRadio_"+
this._getRandomString());c.setAttr(this.portalLabel,"for",this.portalRadio.id);this.urlRadio.name=a;c.setAttr(this.urlRadio,"id","urlRadio_"+this._getRandomString());c.setAttr(this.urlLabel,"for",this.urlRadio.id)},_getRandomString:function(){var a=Math.random().toString();return a=a.slice(2,a.length)},_onRadioClicked:function(){c.setStyle(this.mapDijitContainer,"display","none");c.setStyle(this.portalDijitContainer,"display","none");c.setStyle(this.urlDijitContainer,"display","none");this.mapRadio.checked?
(c.setStyle(this.mapDijitContainer,"display","block"),this.operationTip.innerHTML=this.nls.selectLayer):this.portalRadio.checked?(c.setStyle(this.portalDijitContainer,"display","block"),this.operationTip.innerHTML=this.nls.chooseItem):this.urlRadio.checked&&(c.setStyle(this.urlDijitContainer,"display","block"),this.operationTip.innerHTML=this.nls.setServiceUrl);this._updateOperationTip()},_updateOperationTip:function(){this.mapRadio.checked?this.operationTip.innerHTML=this.queryableLayerChooserFromMap.operationTip:
this.portalRadio.checked?this.operationTip.innerHTML=this.queryableServiceChooserFromPortal.operationTip:this.urlRadio.checked&&(this.operationTip.innerHTML=this.queryableServiceChooserContent.operationTip)}})})},"jimu/dijit/QueryableLayerChooserFromMap":function(){define(["dojo/_base/declare","./LayerChooserFromMap","dojo/_base/html"],function(l,n,t){return l([n],{baseClass:"jimu-queryable-layer-chooser-from-map",declaredClass:"jimu.dijit.QueryableLayerChooserFromMap",postMixInProperties:function(){this.inherited(arguments);
this.filter=n.createQueryableLayerFilter()},postCreate:function(){this.inherited(arguments);t.addClass(this.domNode,"jimu-basic-layer-chooser-from-map")},getHandledItem:function(l){var k=this.inherited(arguments),e=l&&l.layerInfo,e=e&&e.layerObject;k.url=e&&e.url||"";return k}})})},"jimu/dijit/LayerChooserFromMap":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/Evented dojo/on dojo/store/Memory dojo/Deferred dojo/store/Observable dijit/tree/ObjectStoreModel dojo/promise/all dojo/_base/lang dojo/_base/html dojo/_base/array jimu/utils jimu/dijit/_Tree jimu/LayerInfos/LayerInfos jimu/dijit/LoadingIndicator".split(" "),
function(l,n,t,q,k,e,c,g,b,f,m,s,u,a,r,v,d,p){var h=l([n,t,q,k],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"errorTipSection" class\x3d"error-tip-section"\x3e\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\x3cspan class\x3d"jimu-state-error-text" data-dojo-attach-point\x3d"errTip"\x3e${nls.noLayersTip}\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e',_store:null,_id:0,_treeClass:"layer-chooser-tree",createMapResponse:null,multiple:!1,postMixInProperties:function(){this.nls=
window.jimuNls.basicLayerChooserFromMap},postCreate:function(){this.inherited(arguments);u.addClass(this.domNode,"jimu-basic-layer-chooser-from-map");this.multiple=!!this.multiple;this.shelter=new p({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this._createTree();this.createMapResponse&&this.setCreateMapResponse(this.createMapResponse)},filter:function(a){a=new g;a.resolve(!0);return a},getSelectedItems:function(){var d=this.tree.getSelectedItems();return a.map(d,s.hitch(this,
function(a){return this.getHandledItem(a)}))},getAllItems:function(){var d=this.tree.getAllItems(),h=[];a.forEach(d,s.hitch(this,function(a){"root"!==a.id&&(a=this.getHandledItem(a),h.push(a))}));return h},getHandledItem:function(a){return{name:a.name,layerInfo:a.layerInfo}},_isLeafItem:function(a){return a.isLeaf},setCreateMapResponse:function(a){this.createMapResponse=a;d.getInstance(this.createMapResponse.map,this.createMapResponse.itemInfo).then(s.hitch(this,function(a){this.layerInfosObj=a;this.own(e(this.layerInfosObj,
"layerInfosChanged",s.hitch(this,this._onLayerInfosChanged)));this._buildTree(this.layerInfosObj)}))},_onLayerInfosChanged:function(a,d){this._buildTree(this.layerInfosObj)},_buildTree:function(d){this._clear();u.setStyle(this.errorTipSection,"display","block");d=d.getLayerInfoArray();0!==d.length&&(u.setStyle(this.errorTipSection,"display","none"),a.forEach(d,s.hitch(this,function(a){this._addDirectLayerInfo(a)})))},_addDirectLayerInfo:function(a){a&&a.getLayerObject().then(s.hitch(this,function(){this._addItem("root",
a)}),s.hitch(this,function(a){console.error(a)}))},_clear:function(){var d=this._store.query({parent:"root"});a.forEach(d,s.hitch(this,function(a){a&&"root"!==a.id&&this._store.remove(a.id)}))},_addItem:function(d,h){var p=null,b=h.getLayerType(),c=this.filter(h);m({layerType:b,valid:c}).then(s.hitch(this,function(b){if(b.valid){var c=s.hitch(this,function(a,c){this._id++;p={name:h.title||"",parent:d,layerInfo:h,type:b.layerType,layerClass:h.layerObject.declaredClass,id:this._id.toString(),isLeaf:a,
hasChildren:c};this._store.add(p)}),e=h.getSubLayers(),g=0===e.length;g?c(g,!1):(e=a.map(e,s.hitch(this,function(a){return this.filter(a)})),m(e).then(s.hitch(this,function(d){(d=a.some(d,function(a){return a}))&&c(g,d)})))}}))},_getRootItem:function(){return{id:"root",name:"Map Root",type:"root",isLeaf:!1,hasChildren:!0}},_createTree:function(){var a=this._getRootItem(),a=new c({data:[a],getChildren:function(a){return this.query({parent:a.id})}});this._store=new b(a);a=new f({store:this._store,query:{id:"root"},
mayHaveChildren:s.hitch(this,this._mayHaveChildren)});this.tree=new v({multiple:this.multiple,model:a,showRoot:!1,isLeafItem:s.hitch(this,this._isLeafItem),style:{width:"100%"},onOpen:s.hitch(this,function(a,d){"root"!==a.id&&this._onTreeOpen(a,d)}),onClick:s.hitch(this,function(a,d,h){this._onTreeClick(a,d,h);this.emit("tree-click",a,d,h)}),getIconStyle:s.hitch(this,function(a,d){var h=null;if(!a||"root"===a.id)return null;var p={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",
backgroundImage:""},b=window.location.protocol+"//"+window.location.host+require.toUrl("jimu"),c=this._getIconImageName(a,d);c&&(p.backgroundImage="url("+b+"/css/images/"+c+")",h=p);return h})});u.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.shelter.domNode,"before")},_mayHaveChildren:function(a){return a.hasChildren},_getIconImageName:function(a,d){var h="";if("ArcGISDynamicMapServiceLayer"===a.type||"ArcGISTiledMapServiceLayer"===a.type)h=d?"mapserver_open.png":"mapserver_close.png";
else if("GroupLayer"===a.type)h=d?"group_layer2.png":"group_layer1.png";else if("FeatureLayer"===a.type){var p=r.getTypeByGeometryType(a.layerInfo.layerObject.geometryType);"point"===p?h="point_layer1.png":"polyline"===p?h="line_layer1.png":"polygon"===p&&(h="polygon_layer1.png")}else h="ArcGISImageServiceLayer"===a.type||"ArcGISImageServiceVectorLayer"===a.type?"image_layer.png":d?"mapserver_open.png":"mapserver_close.png";return h},_onTreeOpen:function(d,h){if("root"!==d.id){var p=[],b=[],p=d.layerInfo.getSubLayers();
d.checked||(this.shelter.show(),b=a.map(p,s.hitch(this,function(a){return a.getLayerObject()})),m(b).then(s.hitch(this,function(){this.domNode&&(a.forEach(p,s.hitch(this,function(a){this._addItem(d.id,a)})),d.checked=!0,this.shelter.hide())}),s.hitch(this,function(a){console.error(a);this.shelter.hide()})))}},_onTreeClick:function(a,d,h){},destroy:function(){this.shelter&&this.shelter.destroy();this.tree&&this.tree.destroy();this.shelter=null;this.tree.destroy();this.inherited(arguments)}});h.createFilterByLayerType=
function(a){s.isArrayLike(a)||(a=[]);return function(d){var h=new g;if(0===a.length)h.resolve(!0);else{var p=[];d.traversal(function(a){p.push(a.getLayerType())});m(p).then(function(d){for(var p=0;p<d.length;p++)for(var b=0;b<a.length;b++)if(d[p]===a[b]){h.resolve(!0);return}h.resolve(!1)},function(a){console.error(a);h.reject(a)})}return h}};h.createFeaturelayerFilter=function(d,h){var p=["point","polyline","polygon"];d&&0<d.length?(d=a.filter(d,function(a){return 0<=p.indexOf(a)}),0===d.length&&
(d=p)):d=p;return function(p){var b=new g,c=p.getLayerType();p=p.getLayerObject();m({layerType:c,layerObject:p}).then(function(p){var c=p.layerType;p=p.layerObject;if("ArcGISDynamicMapServiceLayer"===c)b.resolve(!0);else if("ArcGISTiledMapServiceLayer"===c)b.resolve(!0);else if("GroupLayer"===c)b.resolve(!0);else if("FeatureCollection"===c)b.resolve(!0);else if("FeatureLayer"===c)if(c=r.getTypeByGeometryType(p.geometryType),c=0<=a.indexOf(d,c),p.url){var e=!1;p.url&&(e=r.isFeaturelayerUrlSupportQuery(p.url,
p.capabilities));b.resolve(c&&e)}else h?b.resolve(c):b.resolve(!1);else b.resolve(!1)},function(a){console.log(a);b.reject(a)});return b}};h.createImageServiceLayerFilter=function(a){return function(d){var h=new g,p=d.getLayerType();d=d.getLayerObject();m({layerType:p,layerObject:d}).then(function(d){var p=d.layerType;"ArcGISImageServiceLayer"===p||"ArcGISImageServiceVectorLayer"===p?a?r.isImageServiceSupportQuery(d.layerObject.capabilities)?h.resolve(!0):h.resolve(!1):h.resolve(!0):h.resolve(!1)},
function(a){console.log(a);h.reject(a)});return h}};h.createQueryableLayerFilter=function(){var a=h.createFeaturelayerFilter(["point","polyline","polygon"],!1),d=h.createImageServiceLayerFilter(!0);return h.orCombineFilters([a,d])};h.andCombineFilters=function(a){return h._combineFilters(a,!0)};h.orCombineFilters=function(a){return h._combineFilters(a,!1)};h._combineFilters=function(d,h){return function(p){var b=new g,c=a.map(d,function(a){return a(p)});m(c).then(function(d){var p=!1,p=h?a.every(d,
function(a){return a}):a.some(d,function(a){return a});b.resolve(p)},function(a){console.error(a);b.reject(a)});return b}};return h})},"dojo/store/Observable":function(){define(["../_base/kernel","../_base/lang","../when","../_base/array"],function(l,n,t,q){l=function(k){function e(b,c){var e=k[b];e&&(k[b]=function(a){var g;"put"===b&&(g=k.getIdentity(a));if(f)return e.apply(this,arguments);f=!0;try{var v=e.apply(this,arguments);t(v,function(d){c("object"==typeof d&&d||a,g)});return v}finally{f=!1}})}
var c=[],g=0;k=n.delegate(k);k.notify=function(b,e){g++;for(var f=c.slice(),a=0,r=f.length;a<r;a++)f[a](b,e)};var b=k.query;k.query=function(e,f){f=f||{};var u=b.apply(this,arguments);if(u&&u.forEach){var a=n.mixin({},f);delete a.start;delete a.count;var r=k.queryEngine&&k.queryEngine(e,a),v=g,d=[],p;u.observe=function(a,b){1==d.push(a)&&c.push(p=function(a,p){t(u,function(h){var c=h.length!=f.count,e,m;if(++v!=g)throw Error("Query is out of date, you must observe() the query prior to any data modifications");
var u,w=-1,l=-1;if(void 0!==p){e=0;for(m=h.length;e<m;e++){var n=h[e];if(k.getIdentity(n)==p){u=n;w=e;(r||!a)&&h.splice(e,1);break}}}if(r){if(a&&(r.matches?r.matches(a):r([a]).length))e=-1<w?w:h.length,h.splice(e,0,a),l=q.indexOf(r(h),a),h.splice(e,1),f.start&&0==l||!c&&l==h.length?l=-1:h.splice(l,0,a)}else a&&(void 0!==p?l=w:f.start||(l=k.defaultIndex||0,h.splice(l,0,a)));if((-1<w||-1<l)&&(b||!r||w!=l)){c=d.slice();for(e=0;h=c[e];e++)h(a||u,w,l)}})});var e={};e.remove=e.cancel=function(){var b=q.indexOf(d,
a);-1<b&&(d.splice(b,1),d.length||c.splice(q.indexOf(c,p),1))};return e}}return u};var f;e("put",function(b,c){k.notify(b,c)});e("add",function(b){k.notify(b)});e("remove",function(b){k.notify(void 0,b)});return k};n.setObject("dojo.store.Observable",l);return l})},"dijit/tree/ObjectStoreModel":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/_base/lang dojo/when ../Destroyable".split(" "),function(l,n,t,q,k,e,c){return t("dijit.tree.ObjectStoreModel",c,{store:null,
labelAttr:"name",labelType:"text",root:null,query:null,constructor:function(c){k.mixin(this,c);this.childrenCache={}},getRoot:function(c,b){if(this.root)c(this.root);else{var f=this.store.query(this.query);f.then&&this.own(f);e(f,k.hitch(this,function(b){if(1!=b.length)throw Error("dijit.tree.ObjectStoreModel: root query returned "+b.length+" items, but must return exactly one");this.root=b[0];c(this.root);f.observe&&f.observe(k.hitch(this,function(b){this.onChange(b)}),!0)}),b)}},mayHaveChildren:function(){return!0},
getChildren:function(c,b,f){var m=this.store.getIdentity(c);if(this.childrenCache[m])e(this.childrenCache[m],b,f);else{var s=this.childrenCache[m]=this.store.getChildren(c);s.then&&this.own(s);s.observe&&this.own(s.observe(k.hitch(this,function(b,a,f){this.onChange(b);a!=f&&e(s,k.hitch(this,"onChildrenChange",c))}),!0));e(s,b,f)}},isItem:function(){return!0},getIdentity:function(c){return this.store.getIdentity(c)},getLabel:function(c){return c[this.labelAttr]},newItem:function(c,b,e,m){return this.store.put(c,
{parent:b,before:m})},pasteItem:function(c,b,e,m,s,u){var a=new q;if(b===e&&!m&&!u)return a.resolve(!0),a;b&&!m?this.getChildren(b,k.hitch(this,function(r){r=[].concat(r);var m=l.indexOf(r,c);r.splice(m,1);this.onChildrenChange(b,r);a.resolve(this.store.put(c,{overwrite:!0,parent:e,oldParent:b,before:u}))})):a.resolve(this.store.put(c,{overwrite:!0,parent:e,oldParent:b,before:u}));return a},onChange:function(){},onChildrenChange:function(){},onDelete:function(){}})})},"jimu/dijit/_Tree":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_TreeNode.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/event dojo/query dojo/aspect dojo/on dojo/Evented dijit/registry dijit/Tree jimu/utils".split(" "),
function(l,n,t,q,k,e,c,g,b,f,m,s,u,a,r){var v=l([a._TreeNode,s],{templateString:q,declaredClass:"jimu._TreeNode",isLeaf:!1,groupId:"",postCreate:function(){this.inherited(arguments);e.addClass(this.domNode,"jimu-tree-node");this.isLeaf=!!this.isLeaf;this.groupId?(this.checkNode=e.toDom('\x3cinput type\x3d"radio" /\x3e'),this.checkNode.name=this.groupId):this.checkNode=e.toDom('\x3cinput type\x3d"checkbox" /\x3e');e.addClass(this.checkNode,"jimu-tree-check-node");e.place(this.checkNode,this.contentNode,
"first");this.own(m(this.checkNode,"click",k.hitch(this,this._onClick)));this.isLeaf?this.groupId?e.setStyle(this.checkNode,"display","none"):e.setStyle(this.checkNode,"display","inline"):e.setStyle(this.checkNode,"display","none");this.isLeaf?e.addClass(this.domNode,"jimu-tree-leaf-node"):e.addClass(this.domNode,"jimu-tree-not-leaf-node")},select:function(){this.isLeaf&&(this.checkNode.checked=!0,e.addClass(this.domNode,"jimu-tree-selected-leaf-node"))},unselect:function(){this.isLeaf&&(this.checkNode.checked=
!1,e.removeClass(this.domNode,"jimu-tree-selected-leaf-node"))},toggleSelect:function(){this.isLeaf&&(this.checkNode.checked?this.unselect():this.select())},_onClick:function(a){(a.target||a.srcElement)===this.checkNode?this.tree._onCheckNodeClick(this,this.checkNode.checked,a):this.tree._onClick(this,a)},_onChange:function(){this.isLeaf&&setTimeout(k.hitch(this,function(){this.checkNode.checked?this.emit("tn-select",this):this.emit("tn-unselect",this)}),100)},destroy:function(){delete this.tree;
this.inherited(arguments)}});return l([a,s],{declaredClass:"jimu._Tree",openOnClick:!0,multiple:!0,uniqueId:"",showRoot:!1,postMixInProperties:function(){this.inherited(arguments);this.uniqueId="tree_"+r.getRandomString()},postCreate:function(){this.inherited(arguments);e.addClass(this.domNode,"jimu-tree");this.own(f.before(this,"onClick",k.hitch(this,this._jimuBeforeClick)));this.rootLoadingIndicator&&e.setStyle(this.rootLoadingIndicator,"display","none")},removeItem:function(a){this.model.store.remove(a)},
getAllItems:function(){var a=this.getAllTreeNodeWidgets();return c.map(a,k.hitch(this,function(a){var d=a.item;d.selected=a.checkNode.checked;return d}))},getSelectedItems:function(){var a=this.getAllTreeNodeWidgets(),a=c.filter(a,k.hitch(this,function(a){return a.checkNode.checked}));return c.map(a,k.hitch(this,function(a){return a.item}))},getFilteredItems:function(a){var p=this.getAllTreeNodeWidgets(),p=c.map(p,k.hitch(this,function(a){var d=a.item;d.selected=a.checkNode.checked;return d}));return c.filter(p,
k.hitch(this,function(h){return a(h)}))},getTreeNodeByItemId:function(a){for(var p=this._getAllTreeNodeDoms(),h=0;h<p.length;h++){var b=u.byNode(p[h]);if(b.item.id.toString()===a.toString())return b}return null},selectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&this.selectNodeWidget(a)},unselectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&a.unselect()},getAllLeafTreeNodeWidgets:function(){var a=this.getAllTreeNodeWidgets();return c.filter(a,k.hitch(this,function(a){return a.isLeaf}))},
getAllTreeNodeWidgets:function(){var a=this._getAllTreeNodeDoms();return c.map(a,k.hitch(this,function(a){return u.byNode(a)}))},isLeafItem:function(a){return a&&a.isLeaf},_getAllTreeNodeDoms:function(){return b(".dijitTreeNode",this.domNode)},_createTreeNode:function(a){a.isLeaf=this.isLeafItem(a.item);this.multiple||(a.groupId=this.uniqueId);return new v(a)},_onTreeNodeSelect:function(a){this.emit("item-select",{item:a.item,treeNode:a})},_onTreeNodeUnselect:function(a){this.emit("item-unselect",
{item:a.item,treeNode:a})},selectNodeWidget:function(a){this.multiple||this.unselectAllLeafNodeWidgets();a.select()},_jimuBeforeClick:function(a,p,h){p.isLeaf&&(e.hasClass(h.target||h.srcElement,"jimu-tree-check-node")||(this.multiple?p.toggleSelect():this.selectNodeWidget(p)));return arguments},_onCheckNodeClick:function(a,p,h){!this.multiple&&p&&this.unselectAllLeafNodeWidgets();g.stop(h);this.focusNode(a);setTimeout(k.hitch(this,function(){p?this.selectNodeWidget(a):a.unselect();this.onClick(a.item,
a,h)}),0)},unselectAllLeafNodeWidgets:function(){var a=this.getAllLeafTreeNodeWidgets();c.forEach(a,k.hitch(this,function(a){a.unselect()}))}})})},"dijit/Tree":function(){define("dojo/_base/array dojo/aspect dojo/cookie dojo/_base/declare dojo/Deferred dojo/promise/all dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/errors/create dojo/fx dojo/has dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/topic dojo/touch dojo/when ./a11yclick ./focus ./registry ./_base/manager ./_Widget ./_TemplatedMixin ./_Container ./_Contained ./_CssStateMixin ./_KeyNavMixin dojo/text!./templates/TreeNode.html dojo/text!./templates/Tree.html ./tree/TreeStoreModel ./tree/ForestStoreModel ./tree/_dndSelector dojo/query!css2".split(" "),
function(l,n,t,q,k,e,c,g,b,f,m,s,u,a,r,v,d,p,h,C,w,A,y,D,E,G,H,J,F,I,K,L,O,M,N){function x(a){return v.delegate(a.promise||a,{addCallback:function(a){this.then(a)},addErrback:function(a){this.otherwise(a)}})}var B=q("dijit._TreeNode",[E,G,H,J,F],{item:null,isTreeNode:!0,label:"",_setLabelAttr:function(a){this.labelNode["html"==this.labelType?"innerHTML":"innerText"in this.labelNode?"innerText":"textContent"]=a;this._set("label",a)},labelType:"text",isExpandable:null,isExpanded:!1,state:"NotLoaded",
templateString:K,baseClass:"dijitTreeNode",cssStateNodes:{rowNode:"dijitTreeRow"},_setTooltipAttr:{node:"rowNode",type:"attribute",attribute:"title"},buildRendering:function(){this.inherited(arguments);this._setExpando();this._updateItemClasses(this.item);this.isExpandable&&this.labelNode.setAttribute("aria-expanded",this.isExpanded);this.setSelected(!1)},_setIndentAttr:function(a){var d=Math.max(a,0)*this.tree._nodePixelIndent+"px";f.set(this.domNode,"backgroundPosition",d+" 0px");f.set(this.rowNode,
this.isLeftToRight()?"paddingLeft":"paddingRight",d);l.forEach(this.getChildren(),function(d){d.set("indent",a+1)});this._set("indent",a)},markProcessing:function(){this.state="Loading";this._setExpando(!0)},unmarkProcessing:function(){this._setExpando(!1)},_updateItemClasses:function(a){var d=this.tree,h=d.model;d._v10Compat&&a===h.root&&(a=null);this._applyClassAndStyle(a,"icon","Icon");this._applyClassAndStyle(a,"label","Label");this._applyClassAndStyle(a,"row","Row");this.tree._startPaint(!0)},
_applyClassAndStyle:function(a,d,h){var b="_"+d+"Class";d+="Node";var p=this[b];this[b]=this.tree["get"+h+"Class"](a,this.isExpanded);g.replace(this[d],this[b]||"",p||"");f.set(this[d],this.tree["get"+h+"Style"](a,this.isExpanded)||{})},_updateLayout:function(){var a=this.getParent(),a=!a||!a.rowNode||"none"==a.rowNode.style.display;g.toggle(this.domNode,"dijitTreeIsRoot",a);g.toggle(this.domNode,"dijitTreeIsLast",!a&&!this.getNextSibling())},_setExpando:function(a){var d=["dijitTreeExpandoLoading",
"dijitTreeExpandoOpened","dijitTreeExpandoClosed","dijitTreeExpandoLeaf"];a=a?0:this.isExpandable?this.isExpanded?1:2:3;g.replace(this.expandoNode,d[a],d);this.expandoNodeText.innerHTML=["*","-","+","*"][a]},expand:function(){if(this._expandDeferred)return x(this._expandDeferred);this._collapseDeferred&&(this._collapseDeferred.cancel(),delete this._collapseDeferred);this.isExpanded=!0;this.labelNode.setAttribute("aria-expanded","true");(this.tree.showRoot||this!==this.tree.rootNode)&&this.containerNode.setAttribute("role",
"group");g.add(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","true");var a=s.wipeIn({node:this.containerNode,duration:D.defaultDuration}),d=this._expandDeferred=new k(function(){a.stop()});n.after(a,"onEnd",function(){d.resolve(!0)},!0);a.play();return x(d)},collapse:function(){if(this._collapseDeferred)return x(this._collapseDeferred);this._expandDeferred&&
(this._expandDeferred.cancel(),delete this._expandDeferred);this.isExpanded=!1;this.labelNode.setAttribute("aria-expanded","false");this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","false");g.remove(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);var a=s.wipeOut({node:this.containerNode,duration:D.defaultDuration}),d=this._collapseDeferred=new k(function(){a.stop()});n.after(a,"onEnd",function(){d.resolve(!0)},
!0);a.play();return x(d)},indent:0,setChildItems:function(a){var d=this.tree,h=d.model,b=[],p=d.focusedChild,f=this.getChildren();l.forEach(f,function(a){H.prototype.removeChild.call(this,a)},this);this.defer(function(){l.forEach(f,function(a){if(!a._destroyed&&!a.getParent()){d.dndController.removeTreeNode(a);var b=function(a){var p=h.getIdentity(a.item),c=d._itemNodesMap[p];1==c.length?delete d._itemNodesMap[p]:(p=l.indexOf(c,a),-1!=p&&c.splice(p,1));l.forEach(a.getChildren(),b)};b(a);if(d.persist){var e=
l.map(a.getTreePath(),function(a){return d.model.getIdentity(a)}).join("/"),f;for(f in d._openedNodes)f.substr(0,e.length)==e&&delete d._openedNodes[f];d._saveExpandedNodes()}d.lastFocusedChild&&!c.isDescendant(d.lastFocusedChild,d.domNode)&&delete d.lastFocusedChild;p&&!c.isDescendant(p,d.domNode)&&d.focus();a.destroyRecursive()}})});this.state="Loaded";a&&0<a.length?(this.isExpandable=!0,l.forEach(a,function(a){var p=h.getIdentity(a),c=d._itemNodesMap[p],e;if(c)for(var f=0;f<c.length;f++)if(c[f]&&
!c[f].getParent()){e=c[f];e.set("indent",this.indent+1);break}e||(e=this.tree._createTreeNode({item:a,tree:d,isExpandable:h.mayHaveChildren(a),label:d.getLabel(a),labelType:d.model&&d.model.labelType||"text",tooltip:d.getTooltip(a),ownerDocument:d.ownerDocument,dir:d.dir,lang:d.lang,textDir:d.textDir,indent:this.indent+1}),c?c.push(e):d._itemNodesMap[p]=[e]);this.addChild(e);(this.tree.autoExpand||this.tree._state(e))&&b.push(d._expandNode(e))},this),l.forEach(this.getChildren(),function(a){a._updateLayout()})):
this.isExpandable=!1;this._setExpando&&this._setExpando(!1);this._updateItemClasses(this.item);a=e(b);this.tree._startPaint(a);return x(a)},getTreePath:function(){for(var a=this,d=[];a&&a!==this.tree.rootNode;)d.unshift(a.item),a=a.getParent();d.unshift(this.tree.rootNode.item);return d},getIdentity:function(){return this.tree.model.getIdentity(this.item)},removeChild:function(a){this.inherited(arguments);var d=this.getChildren();0==d.length&&(this.isExpandable=!1,this.collapse());l.forEach(d,function(a){a._updateLayout()})},
makeExpandable:function(){this.isExpandable=!0;this._setExpando(!1)},setSelected:function(a){this.labelNode.setAttribute("aria-selected",a?"true":"false");g.toggle(this.rowNode,"dijitTreeRowSelected",a)},focus:function(){A.focus(this.focusNode)}});u("dojo-bidi")&&B.extend({_setTextDirAttr:function(a){if(a&&(this.textDir!=a||!this._created))this._set("textDir",a),this.applyTextDir(this.labelNode),l.forEach(this.getChildren(),function(d){d.set("textDir",a)},this)}});var z=q("dijit.Tree",[E,I,G,F],{baseClass:"dijitTree",
store:null,model:null,query:null,label:"",showRoot:!0,childrenAttr:["children"],paths:[],path:[],selectedItems:null,selectedItem:null,openOnClick:!1,openOnDblClick:!1,templateString:L,persist:!1,autoExpand:!1,dndController:N,dndParams:"onDndDrop itemCreator onDndCancel checkAcceptance checkItemAcceptance dragThreshold betweenThreshold".split(" "),onDndDrop:null,itemCreator:null,onDndCancel:null,checkAcceptance:null,checkItemAcceptance:null,dragThreshold:5,betweenThreshold:0,_nodePixelIndent:19,_publish:function(a,
d){p.publish(this.id,v.mixin({tree:this,event:a},d||{}))},postMixInProperties:function(){this.tree=this;this.autoExpand&&(this.persist=!1);this._itemNodesMap={};!this.cookieName&&this.id&&(this.cookieName=this.id+"SaveStateCookie");this.expandChildrenDeferred=new k;this.pendingCommandsPromise=this.expandChildrenDeferred.promise;this.inherited(arguments)},postCreate:function(){this._initState();var a=this;this.own(d(this.containerNode,d.selector(".dijitTreeNode",h.enter),function(d){a._onNodeMouseEnter(y.byNode(this),
d)}),d(this.containerNode,d.selector(".dijitTreeNode",h.leave),function(d){a._onNodeMouseLeave(y.byNode(this),d)}),d(this.containerNode,d.selector(".dijitTreeRow",w.press),function(d){a._onNodePress(y.getEnclosingWidget(this),d)}),d(this.containerNode,d.selector(".dijitTreeRow",w),function(d){a._onClick(y.getEnclosingWidget(this),d)}),d(this.containerNode,d.selector(".dijitTreeRow","dblclick"),function(d){a._onDblClick(y.getEnclosingWidget(this),d)}));this.model||this._store2model();this.own(n.after(this.model,
"onChange",v.hitch(this,"_onItemChange"),!0),n.after(this.model,"onChildrenChange",v.hitch(this,"_onItemChildrenChange"),!0),n.after(this.model,"onDelete",v.hitch(this,"_onItemDelete"),!0));this.inherited(arguments);if(this.dndController){v.isString(this.dndController)&&(this.dndController=v.getObject(this.dndController));for(var p={},b=0;b<this.dndParams.length;b++)this[this.dndParams[b]]&&(p[this.dndParams[b]]=this[this.dndParams[b]]);this.dndController=new this.dndController(this,p)}this._load();
this.onLoadDeferred=x(this.pendingCommandsPromise);this.onLoadDeferred.then(v.hitch(this,"onLoad"))},_store2model:function(){this._v10Compat=!0;a.deprecated("Tree: from version 2.0, should specify a model object rather than a store/query");var d={id:this.id+"_ForestStoreModel",store:this.store,query:this.query,childrenAttrs:this.childrenAttr};this.params.mayHaveChildren&&(d.mayHaveChildren=v.hitch(this,"mayHaveChildren"));this.params.getItemChildren&&(d.getChildren=v.hitch(this,function(a,d,h){this.getItemChildren(this._v10Compat&&
a===this.model.root?null:a,d,h)}));this.model=new M(d);this.showRoot=Boolean(this.label)},onLoad:function(){},_load:function(){this.model.getRoot(v.hitch(this,function(a){var d=this.rootNode=this.tree._createTreeNode({item:a,tree:this,isExpandable:!0,label:this.label||this.getLabel(a),labelType:this.model.labelType||"text",textDir:this.textDir,indent:this.showRoot?0:-1});this.showRoot?(this.domNode.setAttribute("aria-multiselectable",!this.dndController.singular),this.rootLoadingIndicator.style.display=
"none"):(d.rowNode.style.display="none",this.domNode.setAttribute("role","presentation"),this.domNode.removeAttribute("aria-expanded"),this.domNode.removeAttribute("aria-multiselectable"),this["aria-label"]?(d.containerNode.setAttribute("aria-label",this["aria-label"]),this.domNode.removeAttribute("aria-label")):this["aria-labelledby"]&&(d.containerNode.setAttribute("aria-labelledby",this["aria-labelledby"]),this.domNode.removeAttribute("aria-labelledby")),d.labelNode.setAttribute("role","presentation"),
d.containerNode.setAttribute("role","tree"),d.containerNode.setAttribute("aria-expanded","true"),d.containerNode.setAttribute("aria-multiselectable",!this.dndController.singular));this.containerNode.appendChild(d.domNode);a=this.model.getIdentity(a);this._itemNodesMap[a]?this._itemNodesMap[a].push(d):this._itemNodesMap[a]=[d];d._updateLayout();this._expandNode(d).then(v.hitch(this,function(){this._destroyed||(this.rootLoadingIndicator.style.display="none",this.expandChildrenDeferred.resolve(!0))}))}),
v.hitch(this,function(a){console.error(this,": error loading root: ",a)}))},getNodesByItem:function(a){if(!a)return[];a=v.isString(a)?a:this.model.getIdentity(a);return[].concat(this._itemNodesMap[a])},_setSelectedItemAttr:function(a){this.set("selectedItems",[a])},_setSelectedItemsAttr:function(a){var d=this;return this.pendingCommandsPromise=this.pendingCommandsPromise.always(v.hitch(this,function(){var h=l.map(a,function(a){return!a||v.isString(a)?a:d.model.getIdentity(a)}),b=[];l.forEach(h,function(a){b=
b.concat(d._itemNodesMap[a]||[])});this.set("selectedNodes",b)}))},_setPathAttr:function(a){return a.length?x(this.set("paths",[a]).then(function(a){return a[0]})):x(this.set("paths",[]).then(function(a){return a[0]}))},_setPathsAttr:function(a){function d(a,b){var p=a.shift(),c=l.filter(b,function(a){return a.getIdentity()==p})[0];if(c)return a.length?h._expandNode(c).then(function(){return d(a,c.getChildren())}):c;throw new z.PathError("Could not expand path at "+p);}var h=this;return x(this.pendingCommandsPromise=
this.pendingCommandsPromise.always(function(){return e(l.map(a,function(a){a=l.map(a,function(a){return v.isString(a)?a:h.model.getIdentity(a)});if(a.length)return d(a,[h.rootNode]);throw new z.PathError("Empty path");}))}).then(function(a){h.set("selectedNodes",a);return h.paths}))},_setSelectedNodeAttr:function(a){this.set("selectedNodes",[a])},_setSelectedNodesAttr:function(a){this.dndController.setSelection(a)},expandAll:function(){function a(h){return d._expandNode(h).then(function(){var d=l.filter(h.getChildren()||
[],function(a){return a.isExpandable});return e(l.map(d,a))})}var d=this;return x(a(this.rootNode))},collapseAll:function(){function a(h){var b=l.filter(h.getChildren()||[],function(a){return a.isExpandable}),b=e(l.map(b,a));return!h.isExpanded||h==d.rootNode&&!d.showRoot?b:b.then(function(){return d._collapseNode(h)})}var d=this;return x(a(this.rootNode))},mayHaveChildren:function(){},getItemChildren:function(){},getLabel:function(a){return this.model.getLabel(a)},getIconClass:function(a,d){return!a||
this.model.mayHaveChildren(a)?d?"dijitFolderOpened":"dijitFolderClosed":"dijitLeaf"},getLabelClass:function(){},getRowClass:function(){},getIconStyle:function(){},getLabelStyle:function(){},getRowStyle:function(){},getTooltip:function(){return""},_onDownArrow:function(a,d){var h=this._getNext(d);h&&h.isTreeNode&&this.focusNode(h)},_onUpArrow:function(a,d){var h=d.getPreviousSibling();if(h)for(d=h;d.isExpandable&&d.isExpanded&&d.hasChildren();)h=d.getChildren(),d=h[h.length-1];else if(h=d.getParent(),
this.showRoot||h!==this.rootNode)d=h;d&&d.isTreeNode&&this.focusNode(d)},_onRightArrow:function(a,d){d.isExpandable&&!d.isExpanded?this._expandNode(d):d.hasChildren()&&(d=d.getChildren()[0])&&d.isTreeNode&&this.focusNode(d)},_onLeftArrow:function(a,d){if(d.isExpandable&&d.isExpanded)this._collapseNode(d);else{var h=d.getParent();h&&(h.isTreeNode&&(this.showRoot||h!==this.rootNode))&&this.focusNode(h)}},focusLastChild:function(){var a=this._getLast();a&&a.isTreeNode&&this.focusNode(a)},_getFirst:function(){return this.showRoot?
this.rootNode:this.rootNode.getChildren()[0]},_getLast:function(){for(var a=this.rootNode;a.isExpanded;){var d=a.getChildren();if(!d.length)break;a=d[d.length-1]}return a},_getNext:function(a){if(a.isExpandable&&a.isExpanded&&a.hasChildren())return a.getChildren()[0];for(;a&&a.isTreeNode;){var d=a.getNextSibling();if(d)return d;a=a.getParent()}return null},childSelector:".dijitTreeRow",isExpandoNode:function(a,d){return c.isDescendant(a,d.expandoNode)||c.isDescendant(a,d.expandoNodeText)},_onNodePress:function(a,
d){this.focusNode(a)},__click:function(a,d,h,b){var p=this.isExpandoNode(d.target,a);a.isExpandable&&(h||p)?this._onExpandoClick({node:a}):(this._publish("execute",{item:a.item,node:a,evt:d}),this[b](a.item,a,d),this.focusNode(a));d.stopPropagation();d.preventDefault()},_onClick:function(a,d){this.__click(a,d,this.openOnClick,"onClick")},_onDblClick:function(a,d){this.__click(a,d,this.openOnDblClick,"onDblClick")},_onExpandoClick:function(a){a=a.node;this.focusNode(a);a.isExpanded?this._collapseNode(a):
this._expandNode(a)},onClick:function(){},onDblClick:function(){},onOpen:function(){},onClose:function(){},_getNextNode:function(d){a.deprecated(this.declaredClass+"::_getNextNode(node) is deprecated. Use _getNext(node) instead.","","2.0");return this._getNext(d)},_getRootOrFirstNode:function(){a.deprecated(this.declaredClass+"::_getRootOrFirstNode() is deprecated. Use _getFirst() instead.","","2.0");return this._getFirst()},_collapseNode:function(a){a._expandNodeDeferred&&delete a._expandNodeDeferred;
if("Loading"!=a.state&&a.isExpanded){var d=a.collapse();this.onClose(a.item,a);this._state(a,!1);this._startPaint(d);return d}},_expandNode:function(a){if(a._expandNodeDeferred)return a._expandNodeDeferred;var d=this.model,h=a.item,b=this;a._loadDeferred||(a.markProcessing(),a._loadDeferred=new k,d.getChildren(h,function(d){a.unmarkProcessing();a.setChildItems(d).then(function(){a._loadDeferred.resolve(d)})},function(d){console.error(b,": error loading "+a.label+" children: ",d);a._loadDeferred.reject(d)}));
d=a._loadDeferred.then(v.hitch(this,function(){var d=a.expand();this.onOpen(a.item,a);this._state(a,!0);return d}));this._startPaint(d);return d},focusNode:function(a){var d=this.domNode.scrollLeft;this.focusChild(a);this.domNode.scrollLeft=d},_onNodeMouseEnter:function(){},_onNodeMouseLeave:function(){},_onItemChange:function(a){var d=this.model.getIdentity(a);if(d=this._itemNodesMap[d]){var h=this.getLabel(a),b=this.getTooltip(a);l.forEach(d,function(d){d.set({item:a,label:h,tooltip:b});d._updateItemClasses(a)})}},
_onItemChildrenChange:function(a,d){var h=this.model.getIdentity(a);(h=this._itemNodesMap[h])&&l.forEach(h,function(a){a.setChildItems(d)})},_onItemDelete:function(a){a=this.model.getIdentity(a);var d=this._itemNodesMap[a];d&&(l.forEach(d,function(a){this.dndController.removeTreeNode(a);var d=a.getParent();d&&d.removeChild(a);this.lastFocusedChild&&!c.isDescendant(this.lastFocusedChild,this.domNode)&&delete this.lastFocusedChild;this.focusedChild&&!c.isDescendant(this.focusedChild,this.domNode)&&
this.focus();a.destroyRecursive()},this),delete this._itemNodesMap[a])},_initState:function(){this._openedNodes={};if(this.persist&&this.cookieName){var a=t(this.cookieName);a&&l.forEach(a.split(","),function(a){this._openedNodes[a]=!0},this)}},_state:function(a,d){if(!this.persist)return!1;var h=l.map(a.getTreePath(),function(a){return this.model.getIdentity(a)},this).join("/");if(1===arguments.length)return this._openedNodes[h];d?this._openedNodes[h]=!0:delete this._openedNodes[h];this._saveExpandedNodes()},
_saveExpandedNodes:function(){if(this.persist&&this.cookieName){var a=[],d;for(d in this._openedNodes)a.push(d);t(this.cookieName,a.join(","),{expires:365})}},destroy:function(){this._curSearch&&(this._curSearch.timer.remove(),delete this._curSearch);this.rootNode&&this.rootNode.destroyRecursive();this.dndController&&!v.isString(this.dndController)&&this.dndController.destroy();this.rootNode=null;this.inherited(arguments)},destroyRecursive:function(){this.destroy()},resize:function(a){a&&b.setMarginBox(this.domNode,
a);this._nodePixelIndent=b.position(this.tree.indentDetector).w||this._nodePixelIndent;this.expandChildrenDeferred.then(v.hitch(this,function(){this.rootNode.set("indent",this.showRoot?0:-1);this._adjustWidths()}))},_outstandingPaintOperations:0,_startPaint:function(a){this._outstandingPaintOperations++;this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);var d=v.hitch(this,function(){this._outstandingPaintOperations--;0>=this._outstandingPaintOperations&&(!this._adjustWidthsTimer&&
this._started)&&(this._adjustWidthsTimer=this.defer("_adjustWidths"))});C(a,d,d)},_adjustWidths:function(){this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);this.containerNode.style.width="auto";this.containerNode.style.width=this.domNode.scrollWidth>this.domNode.offsetWidth?"auto":"100%"},_createTreeNode:function(a){return new B(a)},focus:function(){this.lastFocusedChild?this.focusNode(this.lastFocusedChild):this.focusFirstChild()}});u("dojo-bidi")&&z.extend({_setTextDirAttr:function(a){a&&
this.textDir!=a&&(this._set("textDir",a),this.rootNode.set("textDir",a))}});z.PathError=m("TreePathError");z._TreeNode=B;return z})},"dijit/tree/TreeStoreModel":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang"],function(l,n,t,q){return t("dijit.tree.TreeStoreModel",null,{store:null,childrenAttrs:["children"],newItemIdAttr:"id",labelAttr:"",root:null,query:null,deferItemLoadingUntilExpand:!1,constructor:function(k){q.mixin(this,k);this.connects=[];k=this.store;
if(!k.getFeatures()["dojo.data.api.Identity"])throw Error("dijit.tree.TreeStoreModel: store must support dojo.data.Identity");k.getFeatures()["dojo.data.api.Notification"]&&(this.connects=this.connects.concat([n.after(k,"onNew",q.hitch(this,"onNewItem"),!0),n.after(k,"onDelete",q.hitch(this,"onDeleteItem"),!0),n.after(k,"onSet",q.hitch(this,"onSetItem"),!0)]))},destroy:function(){for(var k;k=this.connects.pop();)k.remove()},getRoot:function(k,e){this.root?k(this.root):this.store.fetch({query:this.query,
onComplete:q.hitch(this,function(c){if(1!=c.length)throw Error("dijit.tree.TreeStoreModel: root query returned "+c.length+" items, but must return exactly one");this.root=c[0];k(this.root)}),onError:e})},mayHaveChildren:function(k){return l.some(this.childrenAttrs,function(e){return this.store.hasAttribute(k,e)},this)},getChildren:function(k,e,c){var g=this.store;if(g.isItemLoaded(k)){for(var b=[],f=0;f<this.childrenAttrs.length;f++)var m=g.getValues(k,this.childrenAttrs[f]),b=b.concat(m);var s=0;
this.deferItemLoadingUntilExpand||l.forEach(b,function(a){g.isItemLoaded(a)||s++});0==s?e(b):l.forEach(b,function(a,f){g.isItemLoaded(a)||g.loadItem({item:a,onItem:function(a){b[f]=a;0==--s&&e(b)},onError:c})})}else{var u=q.hitch(this,arguments.callee);g.loadItem({item:k,onItem:function(a){u(a,e,c)},onError:c})}},isItem:function(k){return this.store.isItem(k)},fetchItemByIdentity:function(k){this.store.fetchItemByIdentity(k)},getIdentity:function(k){return this.store.getIdentity(k)},getLabel:function(k){return this.labelAttr?
this.store.getValue(k,this.labelAttr):this.store.getLabel(k)},newItem:function(k,e,c){var g={parent:e,attribute:this.childrenAttrs[0]},b;this.newItemIdAttr&&k[this.newItemIdAttr]?this.fetchItemByIdentity({identity:k[this.newItemIdAttr],scope:this,onItem:function(f){f?this.pasteItem(f,null,e,!0,c):(b=this.store.newItem(k,g))&&void 0!=c&&this.pasteItem(b,e,e,!1,c)}}):(b=this.store.newItem(k,g))&&void 0!=c&&this.pasteItem(b,e,e,!1,c)},pasteItem:function(k,e,c,g,b){var f=this.store,m=this.childrenAttrs[0];
e&&l.forEach(this.childrenAttrs,function(b){if(f.containsValue(e,b,k)){if(!g){var a=l.filter(f.getValues(e,b),function(a){return a!=k});f.setValues(e,b,a)}m=b}});if(c)if("number"==typeof b){var s=f.getValues(c,m).slice();s.splice(b,0,k);f.setValues(c,m,s)}else f.setValues(c,m,f.getValues(c,m).concat(k))},onChange:function(){},onChildrenChange:function(){},onDelete:function(){},onNewItem:function(k,e){e&&this.getChildren(e.item,q.hitch(this,function(c){this.onChildrenChange(e.item,c)}))},onDeleteItem:function(k){this.onDelete(k)},
onSetItem:function(k,e){if(-1!=l.indexOf(this.childrenAttrs,e))this.getChildren(k,q.hitch(this,function(c){this.onChildrenChange(k,c)}));else this.onChange(k)}})})},"dijit/tree/ForestStoreModel":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","./TreeStoreModel"],function(l,n,t,q,k){return n("dijit.tree.ForestStoreModel",k,{rootId:"$root$",rootLabel:"ROOT",query:null,constructor:function(e){this.root={store:this,root:!0,id:e.rootId,label:e.rootLabel,
children:e.rootChildren}},mayHaveChildren:function(e){return e===this.root||this.inherited(arguments)},getChildren:function(e,c,g){e===this.root?this.root.children?c(this.root.children):this.store.fetch({query:this.query,onComplete:q.hitch(this,function(b){this.root.children=b;c(b)}),onError:g}):this.inherited(arguments)},isItem:function(e){return e===this.root?!0:this.inherited(arguments)},fetchItemByIdentity:function(e){if(e.identity==this.root.id){var c=e.scope||t.global;e.onItem&&e.onItem.call(c,
this.root)}else this.inherited(arguments)},getIdentity:function(e){return e===this.root?this.root.id:this.inherited(arguments)},getLabel:function(e){return e===this.root?this.root.label:this.inherited(arguments)},newItem:function(e,c,g){return c===this.root?(this.onNewRootItem(e),this.store.newItem(e)):this.inherited(arguments)},onNewRootItem:function(){},pasteItem:function(e,c,g,b,f){if(c===this.root&&!b)this.onLeaveRoot(e);this.inherited(arguments,[e,c===this.root?null:c,g===this.root?null:g,b,
f]);if(g===this.root)this.onAddToRoot(e)},onAddToRoot:function(e){console.log(this,": item ",e," added to root")},onLeaveRoot:function(e){console.log(this,": item ",e," removed from root")},_requeryTop:function(){var e=this.root.children||[];this.store.fetch({query:this.query,onComplete:q.hitch(this,function(c){this.root.children=c;if(e.length!=c.length||l.some(e,function(e,b){return c[b]!=e}))this.onChildrenChange(this.root,c)})})},onNewItem:function(e,c){this._requeryTop();this.inherited(arguments)},
onDeleteItem:function(e){-1!=l.indexOf(this.root.children,e)&&this._requeryTop();this.inherited(arguments)},onSetItem:function(e,c,g,b){this._requeryTop();this.inherited(arguments)}})})},"dijit/tree/_dndSelector":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/dnd/common dojo/dom dojo/mouse dojo/on dojo/touch ../a11yclick ./_dndContainer".split(" "),function(l,n,t,q,k,e,c,g,b,f,m){return n("dijit.tree._dndSelector",m,{constructor:function(){this.selection=
{};this.anchor=null;this.events.push(g(this.tree.domNode,b.press,q.hitch(this,"onMouseDown")),g(this.tree.domNode,b.release,q.hitch(this,"onMouseUp")),g(this.tree.domNode,b.move,q.hitch(this,"onMouseMove")),g(this.tree.domNode,f.press,q.hitch(this,"onClickPress")),g(this.tree.domNode,f.release,q.hitch(this,"onClickRelease")))},singular:!1,getSelectedTreeNodes:function(){var b=[],c=this.selection,a;for(a in c)b.push(c[a]);return b},selectNone:function(){this.setSelection([]);return this},destroy:function(){this.inherited(arguments);
this.selection=this.anchor=null},addTreeNode:function(b,c){this.setSelection(this.getSelectedTreeNodes().concat([b]));c&&(this.anchor=b);return b},removeTreeNode:function(b){var c=l.filter(this.getSelectedTreeNodes(),function(a){return!e.isDescendant(a.domNode,b.domNode)});this.setSelection(c);return b},isTreeNodeSelected:function(b){return b.id&&!!this.selection[b.id]},setSelection:function(b){var c=this.getSelectedTreeNodes();l.forEach(this._setDifference(c,b),q.hitch(this,function(a){a.setSelected(!1);
this.anchor==a&&delete this.anchor;delete this.selection[a.id]}));l.forEach(this._setDifference(b,c),q.hitch(this,function(a){a.setSelected(!0);this.selection[a.id]=a}));this._updateSelectionProperties()},_setDifference:function(b,c){l.forEach(c,function(a){a.__exclude__=!0});var a=l.filter(b,function(a){return!a.__exclude__});l.forEach(c,function(a){delete a.__exclude__});return a},_updateSelectionProperties:function(){var b=this.getSelectedTreeNodes(),c=[],a=[];l.forEach(b,function(b){var e=b.getTreePath();
a.push(b);c.push(e)},this);b=l.map(a,function(a){return a.item});this.tree._set("paths",c);this.tree._set("path",c[0]||[]);this.tree._set("selectedNodes",a);this.tree._set("selectedNode",a[0]||null);this.tree._set("selectedItems",b);this.tree._set("selectedItem",b[0]||null)},onClickPress:function(b){if(!this.current||!this.current.isExpandable||!this.tree.isExpandoNode(b.target,this.current)){"mousedown"==b.type&&c.isLeft(b)&&b.preventDefault();var e="keydown"==b.type?this.tree.focusedChild:this.current;
if(e){var a=k.getCopyKeyState(b),f=e.id;!this.singular&&!b.shiftKey&&this.selection[f]?this._doDeselect=!0:(this._doDeselect=!1,this.userSelect(e,a,b.shiftKey))}}},onClickRelease:function(b){this._doDeselect&&(this._doDeselect=!1,this.userSelect("keyup"==b.type?this.tree.focusedChild:this.current,k.getCopyKeyState(b),b.shiftKey))},onMouseMove:function(){this._doDeselect=!1},onMouseDown:function(){},onMouseUp:function(){},_compareNodes:function(b,c){if(b===c)return 0;if("sourceIndex"in document.documentElement)return b.sourceIndex-
c.sourceIndex;if("compareDocumentPosition"in document.documentElement)return b.compareDocumentPosition(c)&2?1:-1;if(document.createRange){var a=doc.createRange();a.setStartBefore(b);var e=doc.createRange();e.setStartBefore(c);return a.compareBoundaryPoints(a.END_TO_END,e)}throw Error("dijit.tree._compareNodes don't know how to compare two different nodes in this browser");},userSelect:function(b,c,a){if(this.singular)this.anchor==b&&c?this.selectNone():(this.setSelection([b]),this.anchor=b);else if(a&&
this.anchor){c=this._compareNodes(this.anchor.rowNode,b.rowNode);a=this.anchor;0>c?c=a:(c=b,b=a);for(a=[];c!=b;)a.push(c),c=this.tree._getNext(c);a.push(b);this.setSelection(a)}else this.selection[b.id]&&c?this.removeTreeNode(b):c?this.addTreeNode(b,!0):(this.setSelection([b]),this.anchor=b)},getItem:function(b){return{data:this.selection[b],type:["treeNode"]}},forInSelectedItems:function(b,c){c=c||t.global;for(var a in this.selection)b.call(c,this.getItem(a),a,this)}})})},"dijit/tree/_dndContainer":function(){define("dojo/aspect dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/on dojo/touch".split(" "),
function(l,n,t,q,k,e){return n("dijit.tree._dndContainer",null,{constructor:function(c,g){this.tree=c;this.node=c.domNode;q.mixin(this,g);this.containerState="";t.add(this.node,"dojoDndContainer");this.events=[k(this.node,e.enter,q.hitch(this,"onOverEvent")),k(this.node,e.leave,q.hitch(this,"onOutEvent")),l.after(this.tree,"_onNodeMouseEnter",q.hitch(this,"onMouseOver"),!0),l.after(this.tree,"_onNodeMouseLeave",q.hitch(this,"onMouseOut"),!0),k(this.node,"dragstart, selectstart",function(b){b.preventDefault()})]},
destroy:function(){for(var c;c=this.events.pop();)c.remove();this.node=this.parent=null},onMouseOver:function(c){this.current=c},onMouseOut:function(){this.current=null},_changeState:function(c,e){var b="dojoDnd"+c,f=c.toLowerCase()+"State";t.replace(this.node,b+e,b+this[f]);this[f]=e},_addItemClass:function(c,e){t.add(c,"dojoDndItem"+e)},_removeItemClass:function(c,e){t.remove(c,"dojoDndItem"+e)},onOverEvent:function(){this._changeState("Container","Over")},onOutEvent:function(){this._changeState("Container",
"")}})})},"jimu/dijit/QueryableServiceChooserFromPortal":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/QueryableServiceChooserFromPortal.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query dojo/Deferred dojo/Evented dojo/promise/all jimu/dijit/ItemSelector jimu/dijit/QueryableServiceBrowser jimu/portalUrlUtils esri/request".split(" "),function(l,n,t,q,k,e,c,g,b,f,m,s,u,a,r,v,d){return l([n,t,q,
s],{templateString:k,declaredClass:"jimu.dijit.QueryableServiceChooserFromPortal",baseClass:"jimu-service-chooser-from-portal jimu-queryable-service-chooser-from-portal",_serviceBrowserDef:null,portalUrl:null,multiple:!1,postMixInProperties:function(){this.nls=e.mixin({},window.jimuNls.common);this.nls=e.mixin(this.nls,window.jimuNls.featureLayerChooserFromPortal);this.portalUrl=v.getStandardPortalUrl(this.portalUrl);this.multiple=!0===this.multiple?!0:!1},postCreate:function(){this.inherited(arguments);
this._initSelf()},getSelectedItems:function(){return this.serviceBrowser.getSelectedItems()},_initSelf:function(){this.selector=new a({portalUrl:this.portalUrl,itemTypes:["Feature Service","Map Service","Image Service"],onlyShowOnlineFeaturedItems:!1});this.own(b(this.selector,"item-selected",e.hitch(this,this._onItemSelected)));this.own(b(this.selector,"none-item-selected",e.hitch(this,this._onNoneItemSelected)));this.selector.placeAt(this.selectorContainer);this.selector.startup();this.serviceBrowser=
new r({multiple:this.multiple});this.own(b(this.serviceBrowser,"tree-click",e.hitch(this,this._onServiceBrowserClicked)));this.serviceBrowser.placeAt(this.serviceBrowserContainer);this.serviceBrowser.startup()},_onItemSelected:function(){c.removeClass(this.btnNext,"jimu-state-disabled")},_onNoneItemSelected:function(){c.addClass(this.btnNext,"jimu-state-disabled")},_onBtnBackClicked:function(){this._serviceBrowserDef&&!this._serviceBrowserDef.isFulfilled()&&this._serviceBrowserDef.cancel();c.setStyle(this.btnOk,
"display","none");c.setStyle(this.btnNext,"display","block");c.setStyle(this.btnBack,"display","none");c.addClass(this.btnOk,"jimu-state-disabled");c.setStyle(this.selectorContainer,"display","block");c.setStyle(this.serviceBrowserContainer,"display","none");this.serviceBrowser.reset();this.emit("back")},_onBtnOkClicked:function(){var a=this.getSelectedItems();0<a.length&&this.emit("ok",a)},_onBtnNextClicked:function(){var a=this.selector.getSelectedItem();a&&(c.setStyle(this.btnNext,"display","none"),
c.setStyle(this.btnBack,"display","block"),c.setStyle(this.btnOk,"display","block"),c.addClass(this.btnOk,"jimu-state-disabled"),c.setStyle(this.selectorContainer,"display","none"),c.setStyle(this.serviceBrowserContainer,"display","block"),this.serviceBrowser.reset(),this._serviceBrowserDef=this.serviceBrowser.setUrl(a.url||a.item),this._serviceBrowserDef.then(e.hitch(this,function(){this._serviceBrowserDef=null;this._setOkStateBySelectedItems()}),e.hitch(this,function(){this._serviceBrowserDef=null})),
this.emit("next"))},_setOkStateBySelectedItems:function(){0<this.serviceBrowser.getSelectedItems().length?c.removeClass(this.btnOk,"jimu-state-disabled"):c.addClass(this.btnOk,"jimu-state-disabled")},_onServiceBrowserClicked:function(){this._setOkStateBySelectedItems()},_onBtnCancelClicked:function(){this.emit("cancel")}})})},"jimu/dijit/ItemSelector":function(){define("dojo/_base/declare dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/ItemSelector.html dojo/Evented dojo/_base/lang dojo/_base/config dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/promise/all dojo/query dojo/on jimu/utils jimu/portalUtils jimu/tokenUtils jimu/portalUrlUtils jimu/dijit/ViewStack jimu/dijit/Search jimu/dijit/TabContainer3 jimu/dijit/_ItemTable".split(" "),
function(l,n,t,q,k,e,c,g,b,f,m,s,u,a,r,v,d,p,h,C,w,A,y){return l([t,q,k,c],{templateString:e,declaredClass:"jimu.dijit.ItemSelector",baseClass:"jimu-item-selector",tab:null,_user:null,_group:null,_allPublicPortalQuery:null,_filterPublicPortalQuery:null,_allPublicOnlineQuery:null,_filterPublicOnlineQuery:null,_allOrganizationQuery:null,_filterOrganizationQuery:null,_allMyContentQuery:null,_filterMyContentQuery:null,_allGroupQuery:null,_filterGroupQuery:null,_isPublicTabShow:!1,_signIn:!1,_itemTypeQueryString:"",
_typeKeywordQueryString:"",portalUrl:null,itemTypes:"",typeKeywords:"",showOnlineItems:!0,onlyShowOnlineFeaturedItems:!1,postMixInProperties:function(){this.portalUrl=h.getStandardPortalUrl(this.portalUrl);this.showOnlineItems=!1===this.showOnlineItems?!1:!0;this.itemTypes&&0<this.itemTypes.length||(this.itemTypes=[]);this._itemTypes="";f.forEach(this.itemTypes,g.hitch(this,function(a,d){this._itemTypes+='"'+a+'"';d!==this.itemTypes.length-1&&(this._itemTypes+=",")}));this._itemTypes="["+this._itemTypes+
"]";this.typeKeywords&&0<this.typeKeywords.length||(this.typeKeywords=[]);this._typeKeywords="";f.forEach(this.typeKeywords,g.hitch(this,function(a,d){this._typeKeywords+='"'+a+'"';d!==this.typeKeywords.length-1&&(this._typeKeywords+=",")}));this._typeKeywords="["+this._typeKeywords+"]";this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);var a=this._getPortalUrl();this.portal=d.getPortal(a);this._initOptions();this._initSearchQuery();this._initTabs();this._initPortalRadio();
this._initItemTables();this._initPublic();this._initPrivate();this._updateUIbySignIn()},_initOptions:function(){this._itemTypeQueryString=v.getItemQueryStringByTypes(this.itemTypes);this._typeKeywordQueryString=v.getItemQueryStringByTypeKeywords(this.typeKeywords)},_initTabs:function(){this.tab=new A({tabs:[{title:this.nls.myContent,content:this.mycontentTabNode},{title:this.nls.myOrganization,content:this.organizationTabNode},{title:this.nls.myGroup,content:this.groupTabNode},{title:this.nls.publicMap,
content:this.publicTabNode}]},this.tabNode);this.own(r(this.tab,"tabChanged",g.hitch(this,function(a){m.setStyle(this.signinSection,"display","none");a!==this.nls.publicMap?(this._isPublicTabShow=!1,this._updateUIbySignIn()):this._isPublicTabShow=!0})))},_updateUIbySignIn:function(){m.setStyle(this.signinSection,"display","none");var d=a(".organization-tab-content-main,.group-tab-content-main,.mycontent-tab-content-main",this.domNode);p.userHaveSignInPortal(this._getPortalUrl())?d.style("display",
"block"):(d.style("display","none"),this._isPublicTabShow||m.setStyle(this.signinSection,"display","block"))},_initPortalRadio:function(){v.combineRadioCheckBoxWithLabel(this.portalPublicRaido,this.portalPublicLabel);v.combineRadioCheckBoxWithLabel(this.onlinePublicRaido,this.onlinePublicLabel);var a=this._getPortalUrl(),a=h.getServerByUrl(a);this.portalPublicRaido.disabled=!1;this.onlinePublicRaido.disabled=!1;this.portalPublicRaido.checked=!0;var d=!1;h.isArcGIScom(a)?(d=!0,this.portalPublicLabel.innerHTML=
"ArcGIS.com"):(this.portalPublicLabel.innerHTML=a,d=this.showOnlineItems?!1:!0);d&&(this.onlinePublicRaido.disabled=!0,m.setStyle(this.onlinePublicRaido,"display","none"),m.setStyle(this.onlinePublicLabel,"display","none"))},_initSearchQuery:function(){var a="esri_"+(b.locale&&b.locale.slice(0,2)||"en").toLowerCase(),d=f.filter("esri_he esri_fr esri_ja esri_nl esri_th esri_tr esri_nb esri_ro esri_it esri_pl esri_po esri_ru esri_pt esri_en esri_ar esri_et esri_es esri_ko esri_cs esri_da esri_zh esri_sv esri_lt esri_fi esri_lv esri_de esri_vi".split(" "),
g.hitch(this,function(d){return d!==a})),h="";f.forEach(d,g.hitch(this,function(a){h+=" -owner:"+a+" "}));d=" ";this.portal&&(this.portal.user&&this.portal.user.orgId)&&(d=" orgid:"+this.portal.user.orgId+" ");d=d+this._itemTypeQueryString+" AND access:public "+h+" "+this._typeKeywordQueryString;this._allPublicPortalQuery=this._getQuery({sortField:"numViews",sortOrder:"desc",q:d});this._filterPublicPortalQuery=this._getQuery({q:d,basicQ:d});this._allPublicOnlineQuery=this._getQuery({sortField:"numViews",
sortOrder:"desc",q:(this.onlyShowOnlineFeaturedItems?' (group:"c755678be14e4a0984af36a15f5b643e"  OR group:"b8787a74b4d74f7fb9b8fac918735153") ':" ")+this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString});this._filterPublicOnlineQuery=this._getQuery({q:this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString});this._allOrganizationQuery=this._getQuery();this._filterOrganizationQuery=this._getQuery();this._allMyContentQuery=this._getQuery();this._filterMyContentQuery=
this._getQuery();this._allGroupQuery=this._getQuery();this._filterGroupQuery=this._getQuery()},_getQuery:function(a){return g.mixin({start:1,num:16,f:"json"},a||{})},_getPortalUrl:function(){return h.getStandardPortalUrl(this.portalUrl)},_initItemTables:function(){this.own(r(this.publicPortalItemTable,"item-dom-clicked",g.hitch(this,this._onItemDomClicked)));this.own(r(this.publicOnlineItemTable,"item-dom-clicked",g.hitch(this,this._onItemDomClicked)));this.own(r(this.organizationItemTable,"item-dom-clicked",
g.hitch(this,this._onItemDomClicked)));this.own(r(this.groupItemTable,"item-dom-clicked",g.hitch(this,this._onItemDomClicked)));this.own(r(this.mycontentItemTable,"item-dom-clicked",g.hitch(this,this._onItemDomClicked)));var a=this._getPortalUrl();this.portalPublicRaido.disabled||(this.publicPortalItemTable.set("portalUrl",a),this.publicPortalItemTable.searchAllItems(this._allPublicPortalQuery),this.publicPortalItemTable.set("filteredQuery",this._filterPublicPortalQuery));this.onlinePublicRaido.disabled||
(this.publicOnlineItemTable.set("portalUrl",window.location.protocol+"//www.arcgis.com"),this.publicOnlineItemTable.searchAllItems(this._allPublicOnlineQuery),this.publicOnlineItemTable.set("filteredQuery",this._filterPublicOnlineQuery))},_initPublic:function(){this.own(r(this.portalPublicRaido,"click",g.hitch(this,this._onPublicRaidoClicked)));this.own(r(this.onlinePublicRaido,"click",g.hitch(this,this._onPublicRaidoClicked)));this._onPublicRaidoClicked()},_onPublicRaidoClicked:function(){this.portalPublicRaido.checked?
(this.publicPortalItemTable.show(),this.publicOnlineItemTable.hide()):this.onlinePublicRaido.checked&&(this.publicPortalItemTable.hide(),this.publicOnlineItemTable.show())},_onPublicSearch:function(a){(a=a&&g.trim(a))?(this.publicPortalItemTable.showFilterItemsSection(),this.publicOnlineItemTable.showFilterItemsSection(),this.portalPublicRaido.checked?(this._filterPublicPortalQuery.q=a+" "+this._filterPublicPortalQuery.basicQ,this._filterPublicPortalQuery.start=1,this.publicPortalItemTable.searchFilteredItems(this._filterPublicPortalQuery)):
this.onlinePublicRaido.checked&&(this._filterPublicOnlineQuery.q=a+" "+this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString,this._filterPublicOnlineQuery.start=1,this.publicOnlineItemTable.searchFilteredItems(this._filterPublicOnlineQuery))):(this.publicPortalItemTable.showAllItemsSection(),this.publicOnlineItemTable.showAllItemsSection())},_initPrivate:function(){this._resetPortalMaps();this.own(r(this.groupsSelect,"change",g.hitch(this,this._onGroupsSelectChange)));var a=
h.getServerByUrl(this._getPortalUrl());h.isArcGIScom(a);p.userHaveSignInPortal(this._getPortalUrl())&&this._onSignIn()},_onOrganizationSearch:function(a){if(a=a&&g.trim(a)){if(this._allOrganizationQuery){var d=this._allOrganizationQuery.q;d&&(this._filterOrganizationQuery.q=a+" "+d,this._filterOrganizationQuery.start=1,this.organizationItemTable.searchFilteredItems(this._filterOrganizationQuery))}}else this.organizationItemTable.showAllItemsSection()},_onMyContentSearch:function(a){if(a=a&&g.trim(a)){if(this._allMyContentQuery){var d=
this._allMyContentQuery.q;d&&(this._filterMyContentQuery.q=a+" "+d,this._filterMyContentQuery.start=1,this.mycontentItemTable.searchFilteredItems(this._filterMyContentQuery))}}else this.mycontentItemTable.showAllItemsSection()},_onGroupSearch:function(a){if(a=a&&g.trim(a)){if(this._allGroupQuery){var d=this._allGroupQuery.q;d&&(this._filterGroupQuery.q=a+" "+d,this._filterGroupQuery.start=1,this.groupItemTable.searchFilteredItems(this._filterGroupQuery))}}else this.groupItemTable.showAllItemsSection()},
_onSignIn:function(){this._updateUIbySignIn();if(!this._signIn){this._signIn=!0;var a=this._getPortalUrl();d.getPortal(a).getUser().then(g.hitch(this,function(a){this.domNode&&(this._resetPortalMaps(),this._searchOrganization(a),this._searchMyContent(a),this._searchGroups(a))}))}},_onSignOut:function(){this._signIn=!1;this._resetPortalMaps();this._updateUIbySignIn()},_resetPortalMaps:function(){this.organizationItemTable.clear();this.mycontentItemTable.clear();this._resetGroupsSection()},_searchOrganization:function(a){this.organizationItemTable.clear();
a=" orgid:"+a.orgId+" AND "+this._itemTypeQueryString+" AND (access:org OR access:public) "+this._typeKeywordQueryString;var d=this._getPortalUrl();this._allOrganizationQuery=this._getQuery({q:a});this._filterOrganizationQuery=this._getQuery({q:a});this.organizationItemTable.set("portalUrl",d);this.organizationItemTable.searchAllItems(this._allOrganizationQuery)},_searchMyContent:function(a){this.mycontentItemTable.clear();var d=this._getPortalUrl();a="owner:"+a.username+" AND "+this._itemTypeQueryString+
" "+this._typeKeywordQueryString;this._allMyContentQuery=this._getQuery({q:a});this._filterMyContentQuery=this._getQuery({q:a});this.mycontentItemTable.set("portalUrl",d);this.mycontentItemTable.searchAllItems(this._allMyContentQuery)},_searchGroups:function(a){this._resetGroupsSection();m.setStyle(this.groupsSection,"display","block");a=a.getGroups();if(0<a.length){m.setStyle(this.groupSearch.domNode,"display","block");this.groupItemTable.show();m.empty(this.groupsSelect);for(var d=0;d<a.length;d++){var b=
a[d];m.create("option",{value:b.id,innerHTML:b.title},this.groupsSelect)}this._onGroupsSelectChange()}this._updateUIbyGroups(a.length)},_resetGroupsSection:function(){m.setStyle(this.groupsSection,"display","none");m.empty(this.groupsSelect);m.create("option",{value:"nodata",innerHTML:this.nls.noneGroups},this.groupsSelect);this.groupItemTable.clear();m.setStyle(this.groupSearch.domNode,"display","none");this.groupItemTable.hide();this._updateUIbyGroups(0)},_updateUIbyGroups:function(a){0===a?m.setStyle(this.groupsSection,
"top","15px"):m.setStyle(this.groupsSection,"top","50px")},_onGroupsSelectChange:function(){var a=this.groupsSelect.value;this.groupItemTable.clear();if("nodata"===a)m.setStyle(this.groupSearch,"display","none"),this.groupItemTable.hide();else{m.setStyle(this.groupSearch,"display","block");this.groupItemTable.show();var d=this._getPortalUrl(),a="group:"+a+" AND "+this._itemTypeQueryString+" "+this._typeKeywordQueryString;this._allGroupQuery=this._getQuery({q:a});this._filterGroupQuery=this._getQuery({q:a});
this.groupItemTable.set("portalUrl",d);this.groupItemTable.searchAllItems(this._allGroupQuery)}},_onItemDomClicked:function(d){var b=m.hasClass(d,"jimu-state-active");a(".item.jimu-state-active",this.domNode).removeClass("jimu-state-active");b&&m.addClass(d,"jimu-state-active");(d=this.getSelectedItem())?this.emit("item-selected",d):this.emit("none-item-selected")},getSelectedItem:function(){var d=null,b=a(".item.jimu-state-active",this.domNode);0<b.length&&(d=g.mixin({},b[0].item));return d}})})},
"jimu/dijit/_ItemTable":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_ItemTable.html dojo/Evented dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/query dojo/on jimu/utils jimu/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator".split(" "),function(l,n,t,q,k,e,c,g,b,f,m,s,u,a,r,v){return l([n,t,q,e],{templateString:k,declaredClass:"jimu.dijit.ItemTable",baseClass:"jimu-item-table",
query:null,filteredQuery:null,portalUrl:null,hidden:!1,nls:null,types:"",typeKeywords:"",_defaultThumbnail:{"Web Mapping Application":"webapp.png","Mobile Application":"mobileapp.png"},postMixInProperties:function(){this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);this._initSelf()},_initSelf:function(){this.types&&0<this.types.length||(this.types=[]);(this.hidden=!0===this.hidden)&&this.hide();this.portalUrl&&(this.portalUrl=r.getStandardPortalUrl(this.portalUrl));
this.showAllItemsSection();this.searchAllItems()},show:function(){b.setStyle(this.domNode,"display","block")},hide:function(){b.setStyle(this.domNode,"display","none")},searchAllItems:function(d){this.showAllItemsSection();d&&(this.query=c.mixin({},d),this.query.start=1,this.clearAllItemsSection());this.portalUrl&&this.query&&0<this.query.start&&(this.allItemsShelter.show(),a.getPortal(this.portalUrl).queryItems(this.query).then(c.hitch(this,function(a){this.domNode&&(this.allItemsShelter.hide(),
this.query.start=a.nextStart,this._createItems(a,this.allItemTbody))}),c.hitch(this,function(a){console.error(a);this.domNode&&this.allItemsShelter.hide()})))},searchFilteredItems:function(d){this.showFilterItemsSection();d&&(this.filteredQuery=c.clone(d),this.filteredQuery.start=1,this.clearFilteredItemsSection());this.portalUrl&&this.filteredQuery&&0<this.filteredQuery.start&&(this.filteredItemShelter.show(),a.getPortal(this.portalUrl).queryItems(this.filteredQuery).then(c.hitch(this,function(a){this.domNode&&
(this.showFilterItemsSection(),d&&this.clearFilteredItemsSection(),this.filteredQuery.start=a.nextStart,this._createItems(a,this.filteredItemsTbody),this._filterItemCallback())}),c.hitch(this,function(a){console.error(a);this.domNode&&this._filterItemCallback()})))},_filterItemCallback:function(){this.filteredItemShelter.hide();0<this._getItemCount(this.filteredItemsTbody)?(b.setStyle(this.filteredItemsTableDiv,"display","block"),b.setStyle(this.searchNoneTipSection,"display","none")):(b.setStyle(this.filteredItemsTableDiv,
"display","none"),b.setStyle(this.searchNoneTipSection,"display","block"))},clear:function(){this.clearAllItemsSection();this.clearFilteredItemsSection()},clearAllItemsSection:function(){b.empty(this.allItemTbody)},clearFilteredItemsSection:function(){b.empty(this.filteredItemsTbody)},showAllItemsSection:function(){b.setStyle(this.allItemsSection,"display","block");b.setStyle(this.filteredItemsSection,"display","none")},showFilterItemsSection:function(){b.setStyle(this.allItemsSection,"display","none");
b.setStyle(this.filteredItemsSection,"display","block");b.setStyle(this.filteredItemsTableDiv,"display","block");b.setStyle(this.searchNoneTipSection,"display","none")},_onAllItemsSectionScroll:function(){this._isScrollToBottom(this.allItemsTableDiv)&&this.searchAllItems()},_onFilteredItemsSectionScroll:function(){this._isScrollToBottom(this.filteredItemsTableDiv)&&this.searchFilteredItems()},_isScrollToBottom:function(a){return u.isScrollToBottom(a)},_createItems:function(a,p){var h=a.results,e=
g.map(this.types,c.hitch(this,function(a){return a.toLowerCase()})),h=g.filter(h,c.hitch(this,function(a){a=a.type&&a.type.toLowerCase()||"";return 0<=g.indexOf(e,a)}));if(0!==h.length){var f,r=m("td.empty",p),v;if(0<r.length){var k=Math.min(h.length,r.length),l=h.splice(0,k);for(v=0;v<k;v++){var s=r[v];f=this._createItem(l[v]);b.place(f,s);b.removeClass(s,"empty")}}if(0!==h.length){r=Math.ceil(h.length/2);for(v=0;v<r;v++){f=b.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e");
b.place(f,p);k=m("td",f);for(l=0;l<k.length;l++)s=k[l],(f=h[2*v+l])?(f=this._createItem(f),b.place(f,s)):b.addClass(s,"empty")}}}},_getItemCount:function(a){return m(".item",a).length},_createItem:function(a){var c=b.toDom('\x3cdiv class\x3d"item"\x3e\x3cdiv class\x3d"item-border"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-thumbnail jimu-auto-vertical"\x3e\x3cdiv class\x3d"none-thumbnail-tip jimu-auto-vertical-content"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"item-info"\x3e\x3cdiv class\x3d"item-name"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-type-owner"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-date"\x3e\x3c/div\x3e\x3ca class\x3d"item-details" target\x3d"_blank"\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e');
c.item=a;var h=m(".item-thumbnail",c)[0],e=m(".item-name",c)[0],f=m(".item-type-owner",c)[0],g=m(".item-date",c)[0],r=m(".item-details",c)[0],v=m(".none-thumbnail-tip",c)[0];if(!a.thumbnailUrl){var k=this._defaultThumbnail[a.type];k&&(a.thumbnailUrl=require.toUrl("jimu")+"/images/"+k)}a.thumbnailUrl?b.setStyle(h,"backgroundImage","url("+a.thumbnailUrl+")"):v.innerHTML=this.nls.noneThumbnail;e.innerHTML=a.title;e.title=e.innerHTML;f.innerHTML=a.type+" by "+a.owner;f.title=f.innerHTML;h=new Date;h.setTime(a.modified);
g.innerHTML=h.toLocaleString();g.title=g.innerHTML;r.innerHTML=this.nls.moreDetails;r.href=a.detailsPageUrl||"#";return c},_onItemsTableClicked:function(a){var c=a.target||a.srcElement;a=null;b.hasClass(c,"item-thumbnail")?a=c.parentNode:b.hasClass(c,"none-thumbnail-tip")&&(a=c.parentNode.parentNode);a&&(c=b.hasClass(a,"jimu-state-active"),m(".item.jimu-state-active",this.domNode).removeClass("jimu-state-active"),c?b.removeClass(a,"jimu-state-active"):b.addClass(a,"jimu-state-active"),this.emit("item-dom-clicked",
a))},getSelectedItem:function(){var a=null,b=m(".item.jimu-state-active",this.domNode);0<b.length&&(a=c.mixin({},b[0].item));return a}})})},"jimu/dijit/QueryableServiceBrowser":function(){define(["dojo/_base/declare","./_BasicServiceBrowser","dojo/_base/lang","dojo/_base/array","jimu/serviceBrowserRuleUtils"],function(l,n,t,q,k){return l([n],{baseClass:"jimu-queryable-service-browser",declaredClass:"jimu-service-chooser-from-portal jimu.dijit.QueryableServiceBrowser",url:"",multiple:!1,postMixInProperties:function(){this.inherited(arguments);
this.rule=k.getQueryableServiceBrowserRule()},getSelectedItems:function(){var e=this.inherited(arguments);return e=q.map(e,t.hitch(this,function(c){return{name:c.name,url:c.url,definition:c.definition}}))}})})},"jimu/dijit/_BasicServiceBrowser":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/Deferred dojo/promise/all dojo/store/Memory dojo/store/Observable dijit/tree/ObjectStoreModel jimu/utils jimu/dijit/_Tree jimu/dijit/Message jimu/dijit/LoadingShelter".split(" "),
function(l,n,t,q,k,e,c,g,b,f,m,s,u,a,r,v){return l([n,t,q,k],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"shelter"  data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\x3c/div\x3e',_store:null,_id:0,_currentUrl:"",_treeClass:"service-browser-tree",_def:null,url:"",multiple:!1,rule:null,postMixInProperties:function(){this.nls=window.jimuNls.basicServiceBrowser},postCreate:function(){this.inherited(arguments);c.addClass(this.domNode,
"jimu-basic-service-browser");this.multiple=!!this.multiple;this._createTree();this.url&&"string"===typeof this.url&&this.setUrl(this.url)},reset:function(){this.url="";this._clear()},getSelectedItems:function(){return this.tree.getSelectedItems()},setUrl:function(d){this._def&&(this._def.isFulfilled()||this._def.cancel(),this._def=null);this._def=new b;(!d||!("string"===typeof d&&d.replace(/\/*$/g,"")))&&this._def.reject();d=d.replace(/\/*$/g,"");d=e.trim(d);var c=d.match(/^http(s?):\/\//gi);c&&
0<c.length||(d="http://"+d);if(!(0>=d.search(/\/rest\/services/i))&&(this._clear(),this._currentUrl=d))return d=this._getRootItem(),(a.isStringEndWith(this._currentUrl,"rest/services")?this._searchBaseServiceUrl(this._currentUrl,d):this._isUrlContainsServiceType(this._currentUrl)?this._searchServiceUrl(this._currentUrl,d):this._searchFolderServiceUrl(this._currentUrl,d)).then(e.hitch(this,function(a){var d=this.tree.getAllLeafTreeNodeWidgets();1===d.length&&d[0].select();this._def.resolve(a)}),e.hitch(this,
function(a){a&&(a.errorCode&&"NETWORK_ERROR"===a.errorCode)&&this._showRequestError();this._def.reject(a)})),this._def;this._def.reject()},_getItem:function(a){return this.rule.getItem(a)},_getSubItemUrls:function(a){return this.rule.getSubItemUrls(a)},_getSubItems:function(a){var c=new b;this._getSubItemUrls(a).then(e.hitch(this,function(a){a=g.map(a,e.hitch(this,function(a){return this._getItem(a)}));f(a).then(e.hitch(this,function(a){a=g.filter(a,e.hitch(this,function(a){return a&&"object"===typeof a}));
c.resolve(a)}),e.hitch(this,function(a){c.reject(a)}))}),e.hitch(this,function(a){c.reject(a)}));return c},_selectFirstLeafTreeNodeWidget:function(){var a=this.tree.getAllLeafTreeNodeWidgets();1===a.length&&a[0].select()},isLeafItem:function(a){return 0<=this.rule.leafTypes.indexOf(a.type)},isServiceTypeSupported:function(a){return this.rule.isServiceTypeSupported(a)},_getStringEndWith:function(a,b){var h="",c=a.indexOf(b);0<=c&&(h=a.slice(0,c+b.length));return h},_isUrlContainsServiceType:function(a){return this.rule.isUrlContainsServiceType(a)},
_getBaseServiceUrl:function(){return this._getStringEndWith(this._currentUrl,"rest/services")},_getServiceName:function(a){var b="";a=a.split("/");return b=a[a.length-1]},_searchBaseServiceUrl:function(a,c){this.shelter.show();var h=new b;this._getRestInfo(a).then(e.hitch(this,function(m){if(this.domNode){var r=[];g.map(m.folders,e.hitch(this,function(h){var f={name:h,type:"folder",url:a+"/"+h,parent:c.id};this._addItem(f);var m=new b;this._doSearchFolderServiceUrl(f.url,f.id).then(e.hitch(this,function(a){0<
a.length?g.forEach(a,e.hitch(this,function(a){a.parent=f.id;this._addItem(a)})):this._removeItem(f.id);m.resolve()}),e.hitch(this,function(a){m.reject(a)}));r.push(m);return m}));g.forEach(m.services,e.hitch(this,function(h){if(this.isServiceTypeSupported(h.type)){h=a+"/"+h.name+"/"+h.type;var f=new b;this.rule.getItem(h).then(e.hitch(this,function(a){a&&(a.parent=c.id,this._addItem(a));f.resolve()}),e.hitch(this,function(a){console.error(a);f.reject(a)}));r.push(f)}}));f(r).then(e.hitch(this,function(){this.domNode&&
(this.shelter.hide(),h.resolve())}),e.hitch(this,function(a){console.error(a);this.domNode&&(this.shelter.hide(),h.reject(a))}))}}),e.hitch(this,function(a){console.error(a);this.domNode&&(this.shelter.hide(),h.reject({errorCode:"NETWORK_ERROR",error:a}))}));return h},_searchFolderServiceUrl:function(a,c){var h=new b;this.shelter.show();this._doSearchFolderServiceUrl(a,c).then(e.hitch(this,function(a){this.domNode&&(g.forEach(a,e.hitch(this,function(a){a.parent=c.id;this._addItem(a)})),this.shelter.hide(),
h.resolve())}),e.hitch(this,function(a){console.error(a);this.domNode&&(this.shelter.hide(),h.reject({errorCode:"NETWORK_ERROR",error:a}))}));return h},_doSearchFolderServiceUrl:function(a){var c=new b,h=this._getBaseServiceUrl();this._getRestInfo(a).then(e.hitch(this,function(a){a=a.services;var d=[];a&&0<a.length&&g.forEach(a,e.hitch(this,function(a){this.isServiceTypeSupported(a.type)&&(a=this.rule.getItem(h+"/"+a.name+"/"+a.type),d.push(a))}));f(d).then(e.hitch(this,function(a){a=g.filter(a,e.hitch(this,
function(a){return a}));c.resolve(a)}),e.hitch(this,function(a){console.error(a);c.reject(a)}))}),e.hitch(this,function(a){console.error(a);c.reject(a)}));return c},_searchServiceUrl:function(a,c){var h=new b;this._getSubItems(a).then(e.hitch(this,function(b){b&&0<b.length?(g.forEach(b,e.hitch(this,function(a){a.parent=c.id;this._addItem(a)})),h.resolve()):this._getItem(a).then(e.hitch(this,function(a){a&&(a.parent=c.id,this._addItem(a));h.resolve()}),e.hitch(this,function(a){h.reject(a)}))}),e.hitch(this,
function(a){h.reject(a)}));return h},_getRestInfo:function(a){var c=new b;this.rule.getRestInfo(a).then(e.hitch(this,function(a){this.domNode&&c.resolve(a)}),e.hitch(this,function(a){this.domNode&&c.reject(a)}));return c},_clear:function(){var a=this._store.query({parent:"root"});g.forEach(a,e.hitch(this,function(a){a&&"root"!==a.id&&this._store.remove(a.id)}))},_showRequestError:function(){new v({message:this.nls.invalidUrlTip})},_addItem:function(a){this._id++;a.id=this._id.toString();this._store.add(a);
return a},_removeItem:function(a){this._store.remove(a)},_getRootItem:function(){return{id:"root",name:"Services Root",type:"root"}},_createTree:function(){var a=this._getRootItem(),a=new m({data:[a],getChildren:function(a){return this.query({parent:a.id})}});this._store=new s(a);a=new u({store:this._store,query:{id:"root"},mayHaveChildren:e.hitch(this,this._mayHaveChildren)});this.tree=new r({multiple:this.multiple,model:a,showRoot:!1,style:{width:"100%"},isLeafItem:e.hitch(this,this.isLeafItem),
onOpen:e.hitch(this,function(a,d){this._onTreeOpen(a,d);this.emit("tree-open",a,d)}),onClick:e.hitch(this,function(a,d,b){this._onTreeClick(a,d,b);this.emit("tree-click",a,d,b)}),getIconStyle:e.hitch(this,function(a,d){var b=null;if(!a)return null;var c={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundImage:""},e=window.location.protocol+"//"+window.location.host+require.toUrl("jimu"),f=this._getIconImageName(a,d);f||("folder"===a.type?f=d?"folder_open_default.png":
"folder_close_default.png":this.isServiceTypeSupported(a.type)&&(f=d?"folder_open_default.png":"folder_close_default.png"));f&&(c.backgroundImage="url("+e+"/css/images/"+f+")",b=c);return b})});c.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.domNode)},_getIconImageName:function(a,b){var c="";"function"===typeof this.rule.getIconImageName&&(c=this.rule.getIconImageName(a,b));return c},_mayHaveChildren:function(a){return"root"===a.type?!0:!this.isLeafItem(a)},_onTreeOpen:function(a,
b){"root"!==a.id&&(!(0<this._store.query({parent:a.id}).length)&&!a.checking&&!a.checked)&&(a.checking=!0,this._getSubItems(a.url).then(e.hitch(this,function(b){g.forEach(b,e.hitch(this,function(b){b.parent=a.id;this._addItem(b)}));a.checking=!1;a.checked=!0}),e.hitch(this,function(b){console.error(b);a.checking=!1;a.checked=!0})))},_onTreeClick:function(a,b,c){},destroy:function(){this.shelter&&(this.shelter.destroy(),this.shelter=null);this.inherited(arguments)}})})},"jimu/serviceBrowserRuleUtils":function(){define(["dojo/_base/lang",
"dojo/_base/array","dojo/Deferred","jimu/utils","jimu/ServiceBrowserRule"],function(l,n,t,q,k){var e={combineRules:function(c){var e=new k;n.forEach(c,function(b){n.forEach(b.leafTypes,function(b){0>e.leafTypes.indexOf(b)&&e.leafTypes.push(b)});n.forEach(b.serviceTypes,function(b){0>e.serviceTypes.indexOf(b)&&e.serviceTypes.push(b)})});e.getMatchedRule=function(b){var e=null;n.some(c,function(c){return c.isUrlContainsServiceType(b)?(e=c,!0):!1});return e};e.getItem=function(b){var c=null;return c=
(c=e.getMatchedRule(b))?c.getItem(b):e.defaultGetItem(b)};e.getSubItemUrls=function(b){var c=null;return c=(c=e.getMatchedRule(b))?c.getSubItemUrls(b):e.defaultGetSubItemUrls(b)};e.getIconImageName=function(b,c){var m="";if(b.url){var k=e.getMatchedRule(b.url);k&&"function"===typeof k.getIconImageName&&(m=k.getIconImageName(b,c))}return m};return e},getFeaturelayerServiceBrowserRule:function(c,g){var b=l.clone(c),f=["point","polyline","polygon"];l.isArrayLike(b)&&0<b.length?(b=n.filter(b,function(b){return 0<=
f.indexOf(b)}),0===b.length&&(b=f)):b=f;return e._getFeaturelayerServiceBrowserRule(b,g)},_getFeaturelayerServiceBrowserRule:function(c,e){return new k({types:c,leafTypes:["Feature Layer","Table"],serviceTypes:["MapServer","FeatureServer"],_groupLayerType:"Group Layer",_featureLayerType:"Feature Layer",_tableType:"Table",getItem:function(b){var c=new t;this.isUrlEndWithServiceType(b,this.serviceTypes)?c=this.defaultGetItem(b):this.getRestInfo(b).then(l.hitch(this,function(e){e=this._getItemByLayerDefinition(b,
e);c.resolve(e)}),l.hitch(this,function(b){c.reject(b)}));return c},getSubItemUrls:function(b){var c=new t;return c=this.isUrlEndWithServiceType(b)?this._getSubUrlsByServiceUrl(b):this._getSubUrlsByGroupUrl(b)},getIconImageName:function(b,c){var e="";if("MapServer"===b.type||"FeatureServer"===b.type)e=c?"mapserver_open.png":"mapserver_close.png";else if(b.type===this._groupLayerType)e=c?"group_layer2.png":"group_layer1.png";else if(b.type===this._featureLayerType){var g=q.getTypeByGeometryType(b.definition&&
b.definition.geometryType);"point"===g?e="point_layer1.png":"polyline"===g?e="line_layer1.png":"polygon"===g&&(e="polygon_layer1.png")}else b.type===this._tableType?e="table.png":"root"===b.type&&this._currentUrl&&n.some(this.serviceTypes,l.hitch(this,function(b){return q.isStringEndWith(this._currentUrl,"/"+b)}))&&(e=c?"mapserver_open.png":"mapserver_close.png");return e},_getSubUrlsByServiceUrl:function(b){var c=new t;this.getRestInfo(b).then(l.hitch(this,function(e){var g=[];n.forEach(e.layers,
l.hitch(this,function(c){0<=c.parentLayerId||g.push(b+"/"+c.id)}));c.resolve(g)}),l.hitch(this,function(b){c.reject(b)}));return c},_getSubUrlsByGroupUrl:function(b){var c=new t;this.getRestInfo(b).then(l.hitch(this,function(e){var g=[];if(e.type===this._groupLayerType)var k=this._getServiceUrlByLayerUrl(b),g=n.map(e.subLayers||[],l.hitch(this,function(a){return k+"/"+a.id}));c.resolve(g)}),l.hitch(this,function(b){c.reject(b)}));return c},_getItemByLayerDefinition:function(b,c){var m=null,k=c.type;
if(k===this._groupLayerType)m={name:c.name,type:k,url:b,definition:c};else if(k===this._featureLayerType||k===this._tableType){var l=!1;k===this._featureLayerType?l=this._validateEsriGeometryType(c.geometryType):k===this._tableType&&(l=!0);l&&(l=!1,(l=e?q.isFeaturelayerUrlSupportQuery(b,c.capabilities):!0)&&(m={name:c.name,type:k,url:b,definition:c}))}return m},_validateEsriGeometryType:function(b){b=q.getTypeByGeometryType(b);return 0<=this.types.indexOf(b)},_getServiceUrlByLayerUrl:function(b){for(var c=
"",e=0;e<this.serviceTypes.length;e++){var g=this.serviceTypes[e].toLowerCase(),k=b.toLowerCase().lastIndexOf("/"+g+"/");if(0<=k){c=b.slice(0,k+g.length+1);break}}return c}})},getGeocodeServiceBrowserRule:function(){return new k({leafTypes:["GeocodeServer"],serviceTypes:["GeocodeServer"]})},getGpServiceBrowserRule:function(){return new k({leafTypes:["GPTask"],serviceTypes:["GPServer"],getItem:function(c){var e=new t;this.isUrlEndWithServiceType(c)?e=this.defaultGetItem(c):this.getRestInfo(c).then(l.hitch(this,
function(b){e.resolve({name:b.displayName||b.name,type:"GPTask",url:c,definition:b})}),l.hitch(this,function(b){e.reject(b)}));return e},getSubItemUrls:function(c){var e=new t;this.isUrlEndWithServiceType(c)?this.getRestInfo(c).then(l.hitch(this,function(b){b=n.map(b.tasks||[],l.hitch(this,function(b){return c+"/"+b}));e.resolve(b)}),l.hitch(this,function(b){e.reject(b)})):e.resolve([]);return e},getIconImageName:function(c,e){var b="";"GPServer"===c.type?b="toolbox.png":"GPTask"===c.type&&(b="tool.png");
return b}})},getImageServiceBrowserRule:function(c){return new k({leafTypes:["ImageServer"],serviceTypes:["ImageServer"],getItem:function(e){var b=new t;this.isUrlEndWithServiceType(e)?this.defaultGetItem(e).then(l.hitch(this,function(e){c?q.isImageServiceSupportQuery(e.definition.capabilities)?b.resolve(e):b.resolve(null):b.resolve(e)}),l.hitch(this,function(c){b.reject(c)})):b.resolve(null);return b},getIconImageName:function(c,b){var e="";"ImageServer"===c.type&&(e="image_layer.png");return e}})},
getQueryableServiceBrowserRule:function(){var c=e.getFeaturelayerServiceBrowserRule(["point","polyline","polygon"],!0),g=e.getImageServiceBrowserRule(!0);return e.combineRules([c,g])}};return e})},"jimu/ServiceBrowserRule":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred jimu/utils esri/request".split(" "),function(l,n,t,q,k,e){return l([],{leafTypes:null,serviceTypes:null,_restInfoCache:{},constructor:function(c){n.mixin(this,c);n.isArrayLike(this.leafTypes)||
(this.leafTypes=[]);n.isArrayLike(this.serviceTypes)||(this.serviceTypes=[])},getItem:function(c){return this.defaultGetItem(c)},getSubItemUrls:function(c){return this.defaultGetSubItemUrls(c)},getIconImageName:function(c,e){return""},defaultGetItem:function(c){var e=new q;c=c.replace(/\/*$/g,"");if(this.isUrlEndWithServiceType(c)){var b=c.split("/"),f=b[b.length-1],m=b[b.length-2];this.getRestInfo(c).then(n.hitch(this,function(b){e.resolve({name:m,type:f,url:c,definition:b})}),n.hitch(this,function(b){console.error(b);
e.reject({errorCode:"NETWORK_ERROR",error:b})}))}else e.resolve(null);return e},defaultGetSubItemUrls:function(c){c=new q;c.resolve([]);return c},getRestInfo:function(c){var g=new q;c=c.replace(/\/*$/g,"");var b=this._restInfoCache[c];b?g.resolve(b):e({url:c,content:{f:"json"},handleAs:"json",callbackParamName:"callback",timeout:2E4}).then(n.hitch(this,function(b){this._restInfoCache[c]=b;g.resolve(b)}),function(b){g.reject(b)});return g},isServiceTypeSupported:function(c){c=c.toLowerCase();return t.some(this.serviceTypes,
n.hitch(this,function(e){return e.toLowerCase()===c}))},isUrlEndWithServiceType:function(c){return t.some(this.serviceTypes,n.hitch(this,function(e){return k.isStringEndWith(c,"/"+e)}))},isUrlContainsServiceType:function(c){c=c.toLowerCase();return t.some(this.serviceTypes,n.hitch(this,function(e){e=e.toLowerCase();return 0<=c.indexOf("/"+e)}))}})})},"jimu/dijit/_QueryableServiceChooserContent":function(){define(["dojo/_base/declare","./_BasicServiceChooserContent","./QueryableServiceBrowser"],function(l,
n,t){return l([n],{baseClass:"jimu-queryable-service-chooser-content",_examples:["http://myserver/arcgis/rest/services","http://myserver/arcgis/rest/services/myservice/MapServer","http://myserver/arcgis/rest/services/myservice/FeatureServer","http://myserver/arcgis/rest/services/myservice/ImageServer"],_createServiceBrowser:function(l){return new t(l)}})})},"jimu/dijit/_BasicServiceChooserContent":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_BasicServiceChooserContent.html dojo/Evented dojo/Deferred dojo/_base/html dojo/_base/array dojo/_base/lang dojo/on dojo/aspect dojo/promise/all jimu/dijit/URLInput jimu/dijit/LoadingIndicator".split(" "),
function(l,n,t,q,k,e,c,g,b,f,m,s,u,a,r){return l([n,t,q,e],{templateString:k,_examples:["http://myserver/arcgis/rest/services","http://myserver/arcgis/rest/services/folder","http://myserver/arcgis/rest/services/myservice/servicetype"],multiple:!1,url:"",getSelectedItems:function(){return this.serviceBrowser.getSelectedItems()},postMixInProperties:function(){this.nls=f.mixin({},window.jimuNls.common);this.nls=f.mixin(this.nls,window.jimuNls.basicServiceChooser)},postCreate:function(){this.inherited(arguments);
g.addClass(this.domNode,"jimu-basic-service-chooser-content");this.multiple=!!this.multiple;this._initSelf();this.exampleTd.innerHTML=this.exampleTd.innerHTML},setUrl:function(a){var d=new c;(this.url=a)&&"string"===typeof this.url?(this.urlInput.set("value",this.url),d=this._onBtnValidateClick()):d.reject();return d},_initSelf:function(){this._examples&&0<this._examples.length?b.forEach(this._examples,f.hitch(this,function(a){g.create("div",{innerHTML:a,"class":"example-url"},this.exampleTd)})):
g.setStyle(this.exampleTr,"display","none");var a={multiple:this.multiple,_onTreeClick:f.hitch(this,this._onTreeClick)};this.serviceBrowser=this._createServiceBrowser(a);this.serviceBrowser.placeAt(this.serviceBrowserContainer);this.serviceBrowser.startup();this.own(s.after(this.urlInput,"validator",f.hitch(this,this._afterUrlValidate)));this.url&&"string"===typeof this.url&&this.urlInput.set("value",this.url)},_createServiceBrowser:function(a){},_validateUrl:function(a){a=a.replace(/\/*$/g,"");if((a=
a.match(/\/rest\/services\/*(.*)/gi))&&0<a.length)if(a=a[0].replace(/\/rest\/services\/*/,"")){var d=a.split("/");if(1===d.length)return!0;if(2===d.length)return this.serviceBrowser.isServiceTypeSupported(d[1]);if(3<=d.length)return a=this.serviceBrowser.isServiceTypeSupported(d[1]),d=this.serviceBrowser.isServiceTypeSupported(d[2]),a||d}else return!0;else return!1},_afterUrlValidate:function(a){a&&(a=this.urlInput.get("value"),a=this._validateUrl(a));a?g.removeClass(this.btnValidate,"jimu-state-disabled"):
g.addClass(this.btnValidate,"jimu-state-disabled");return a},_onBtnValidateClick:function(){var a=new c;if(this.urlInput.validate()){var d=this.urlInput.get("value");this.serviceBrowser.setUrl(d).then(f.hitch(this,function(){this.domNode&&this._checkSelectedItemsNumber();a.resolve()}),f.hitch(this,function(){this.domNode&&this._checkSelectedItemsNumber();a.reject()}));this.emit("validate-click")}else a.reject();return a},_checkSelectedItemsNumber:function(){0<this.getSelectedItems().length?g.removeClass(this.btnOk,
"jimu-state-disabled"):g.addClass(this.btnOk,"jimu-state-disabled")},_onTreeClick:function(){this._checkSelectedItemsNumber()},_onBtnOkClick:function(){var a=this.getSelectedItems();0<a.length&&this.emit("ok",a)},_onBtnCancelClick:function(){this.emit("cancel")}})})},"widgets/Query/setting/SingleQuerySetting":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./SingleQuerySetting.html dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/Evented jimu/utils jimu/dijit/TabContainer3 jimu/dijit/Message jimu/dijit/_QueryableLayerSourcePopup ./PopupConfig esri/request esri/symbols/jsonUtils jimu/dijit/Filter jimu/dijit/SymbolPicker jimu/dijit/LoadingShelter dijit/form/ValidationTextBox".split(" "),
function(l,n,t,q,k,e,c,g,b,f,m,s,u,a,r,v,d,p){return l([n,t,q,f],{baseClass:"jimu-widget-single-query-setting",templateString:k,map:null,nls:null,tr:null,appConfig:null,_layerDefinition:null,postCreate:function(){this.inherited(arguments);this._initSelf()},destroy:function(){this.tr=null;delete this.tr;this.inherited(arguments)},setConfig:function(a){this.config=a;if(this._isObject(this.config)){var d=a.url||"";d&&"string"===typeof d&&(this._layerDefinition&&this._layerDefinition.url===d?(this.tab.hideShelter(),
this._resetByConfig(this.config,this._layerDefinition)):(this._layerDefinition=null,this.showBigShelter(),v({url:d,handAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(e.hitch(this,function(a){this.domNode&&(this.hideBigShelter(),this.tab.hideShelter(),this._layerDefinition=a,this._layerDefinition.url=d,this._resetByConfig(this.config,this._layerDefinition))}),e.hitch(this,function(a){console.error(a);this.domNode&&this.hideBigShelter()}))))}},getConfig:function(){var a={name:"",url:"",
filter:{useFilter:"",filterInfo:""},popup:"",resultsSymbol:"",objectIdField:"",orderByFields:[]};if(!this._layerDefinition)return this.scrollToDom(this.generalTable),new u({message:this.nls.setSourceTip}),null;a.url=this._layerDefinition.url;if(!this.queryNameTextBox.validate())return this.showValidationErrorTip(this.queryNameTextBox),null;a.name=this.queryNameTextBox.get("value");var d=this.filter.toJson();if(!d)return new u({message:this.nls.setFilterTip}),null;a.filter=d;d=this.popupConfig.getConfig();
if(!d)return null;a.orderByFields=d.orderByFields;delete d.orderByFields;a.popup=d;if(this._isTable(this._layerDefinition))a.resultsSymbol=null;else if(d=this.layerSymbolPicker.getSymbol())a.resultsSymbol=d.toJson();else return null;this._layerDefinition.objectIdField?a.objectIdField=this._layerDefinition.objectIdField:(d=c.filter(this._layerDefinition.fields,e.hitch(this,function(a){return"esriFieldTypeOID"===a.type})),0<d.length&&(a.objectIdField=d[0].name));this.tr._layerDefinition=this._layerDefinition;
return a},scrollToDom:function(a){a=g.coords(a).y;var d=g.coords(this.domNode).y;this.domNode.parentNode.scrollTop=a-d},showValidationErrorTip:function(a){!a.validate()&&a.domNode&&a.focusNode&&(a.focusNode.focus(),setTimeout(e.hitch(this,function(){a.focusNode.blur()}),100))},showBigShelter:function(){this.emit("show-shelter")},hideBigShelter:function(){this.emit("hide-shelter")},showQueryDefinition:function(){this.tab.selectTab(this.nls.queryDefinition)},showResultsSetting:function(){this.tab.selectTab(this.nls.resultsSetting)},
_initSelf:function(){this._initFilter();this._initPopupConfig();this._initTabs()},_initFilter:function(){this.filter=new p({enableAskForValues:!0,noFilterTip:this.nls.noFilterTip,style:"width:100%;margin-top:22px;"});this.filter.placeAt(this.filterDiv)},_initTabs:function(){this.tab=new s({tabs:[{title:this.nls.queryDefinition,content:this.definitionTabNode},{title:this.nls.resultsSetting,content:this.resultsTabNode}]});this.tab.placeAt(this.detailSection);this.tab.showShelter()},_initPopupConfig:function(){this.popupConfig=
new r({nls:this.nls,sqs:this});this.popupConfig.placeAt(this.popupContainer)},_getRandomString:function(){var a=Math.random().toString();return a=a.slice(2,a.length)},_onQueryNameChanged:function(){this.emit("name-change",this.queryNameTextBox.get("value"))},_clear:function(){this.urlTextBox.set("value","");this._layerDefinition=null;this.queryNameTextBox.set("value","");this.filter.reset();this.tab.showShelter();this.popupConfig.clear();this.layerSymbolPicker.reset()},_onBtnSetSourceClicked:function(){var d=
new a({titleLabel:this.nls.setDataSource,dijitArgs:{multiple:!1,createMapResponse:this.map.webMapResponse,portalUrl:this.appConfig.portalUrl,style:{height:"100%"}}});this.own(b(d,"ok",e.hitch(this,function(a){d.close();d=null;this.setNewLayerDefinition(a.name,a.url,a.definition)})));this.own(b(d,"cancel",e.hitch(this,function(){d.close();d=null})));d.startup()},setNewLayerDefinition:function(a,d,b,c){b.name=a;b.url=d;d!==(this._layerDefinition&&this._layerDefinition.url)&&this._resetByNewLayerDefinition(b,
c)},_isImageServiceLayer:function(a){return-1<a.url.indexOf("/ImageServer")},_isTable:function(a){return"Table"===a.type},_showSymbolSection:function(){g.setStyle(this.symbolSection,"display","block")},_hideSymbolSection:function(){g.setStyle(this.symbolSection,"display","none")},_resetByNewLayerDefinition:function(a,d){this._clear();if(a){this._layerDefinition=a;var b=a.url;this.urlTextBox.set("value",b);this.queryNameTextBox.set("value",d||a.name);this.tab.hideShelter();this.filter.reset();this._layerDefinition&&
this.filter.buildByExpr(b,"1\x3d1",this._layerDefinition);b="";a.displayField&&(b="${"+a.displayField+"}");this.popupConfig.setConfig({title:b,fields:[],orderByFields:[]});this.popupConfig.updateSortingIcon(this._layerDefinition);b="";if(this._isImageServiceLayer(a))b="fill";else if(this._isTable(a))b="";else if(a.geometryType){var c=m.getTypeByGeometryType(a.geometryType);"point"===c?b="marker":"polyline"===c?b="line":"polygon"===c&&(b="fill")}b?(this._showSymbolSection(),this.layerSymbolPicker.showByType(b)):
(this._hideSymbolSection(),this.layerSymbolPicker.reset())}},_resetByConfig:function(a,b){var c=e.clone(a);this.urlTextBox.set("value",c.url);this.queryNameTextBox.set("value",c.name||"");var p=c.filter;this._isObject(p)&&(this.filter.reset(),this._isObject(p)?this.filter.buildByFilterObj(b.url,p,b):this.filter.buildByExpr(b.url,"1\x3d1",b),this.popupConfig.clear(),this._isObject(c.popup)||(c.popup={title:"",fields:[]}),c.popup.fields&&0<=c.popup.fields.length||(c.popup.fields=[]),c.popup.title||
(c.popup.title=""),this.popupConfig.setConfig({title:c.popup.title,fields:c.popup.fields,orderByFields:c.orderByFields}),this.popupConfig.updateSortingIcon(b),this._isTable(b)?(this._hideSymbolSection(),this.layerSymbolPicker.reset()):(this._showSymbolSection(),c.resultsSymbol&&(c=d.fromJson(c.resultsSymbol),this.layerSymbolPicker.showBySymbol(c))))},_isObject:function(a){return a&&"object"===typeof a}})})},"widgets/Query/setting/PopupConfig":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./PopupConfig.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query jimu/dijit/SimpleTable jimu/dijit/Popup dijit/TooltipDialog dijit/Menu dijit/MenuItem dijit/popup ./SortFields".split(" "),
function(l,n,t,q,k,e,c,g,b,f,m,s,u,a,r,v,d){return l([n,t,q],{baseClass:"jimu-query-setting-popup-config",templateString:k,_currentOrderByFields:null,_validSortFieldTypes:"esriFieldTypeOID esriFieldTypeString esriFieldTypeDate esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble".split(" "),nls:null,sqs:null,config:null,postCreate:function(){this.inherited(arguments);this._currentOrderByFields=[];this._initFieldsTable();this._initAddFields();this.clear();this.config&&
this.setConfig(this.config)},setConfig:function(a){this.clear();this.config=e.clone(a);this.config.title&&"string"===typeof this.config.title?this.titleTextBox.set("value",this.config.title||""):this.titleTextBox.set("value","");var d=this._getLayerDefinition();if(d){var b={};a=g.map(this.config.fields,e.hitch(this,function(a){var d=a.name;b[d]=a;return d}));d=e.clone(d.fields);d=this._getSortedFieldInfos(a,d);g.forEach(d,e.hitch(this,function(a){a.visibility=!1;a.specialType="none";var d=b[a.name];
d&&(a=e.mixin(a,d),a.visibility=!0)}));this._setFields(d)}else this._setFields([]);this._setOrderByFields(this.config.orderByFields)},_getSortedFieldInfos:function(a,d){var b=[],c={};g.forEach(d,e.hitch(this,function(a){c[a.name]=a}));var r=[],r=r.concat(a);g.forEach(d,e.hitch(this,function(a){a=a.name;0>r.indexOf(a)&&r.push(a)}));return b=g.map(r,e.hitch(this,function(a){return c[a]}))},getConfig:function(){var a={title:"",fields:[],orderByFields:[]};if(!this.titleTextBox.validate())return this.sqs.showResultsSetting(),
this.sqs.scrollToDom(this.titleTextBox.domNode),this.sqs.showValidationErrorTip(this.titleTextBox),null;a.title=this.titleTextBox.get("value");var d=this.fieldsTable.getRows(),b=[];g.forEach(d,e.hitch(this,function(a){a=this.fieldsTable.getRowData(a);a.visibility&&b.push({name:a.name,alias:a.alias||a.name,specialType:a.specialType})}));a.fields=b;d=this._getLayerDefinition();this._shouldEnableSorting(d)&&(a.orderByFields=this._getOrderByFields());return a},clear:function(){c.removeClass(this.btnSortFields,
"enabled");this._currentOrderByFields=[];this.titleTextBox.set("value","");this.fieldsTable.clear();this._resetMenu();this._addEmptyMenuItem()},destroy:function(){this.sqs=null;this.titleTextBox.focusNode.blur();this.inherited(arguments)},updateSortingIcon:function(a){this._shouldEnableSorting(a)?c.addClass(this.btnSortFields,"enabled"):c.removeClass(this.btnSortFields,"enabled")},_getLayerDefinition:function(){return this.sqs._layerDefinition},_initFieldsTable:function(){var a={autoHeight:!1,style:"height:187px",
fields:[{name:"visibility",title:this.nls.visibility,type:"checkbox"},{name:"name",title:this.nls.name,type:"text",editable:!1},{name:"alias",title:this.nls.alias,type:"text",editable:!0},{name:"specialType",title:this.nls.specialType,type:"extension",create:e.hitch(this,this._createSpecialType),setValue:e.hitch(this,this._setValue4SpecialType),getValue:e.hitch(this,this._getValueOfSpecialType)},{name:"actions",title:this.nls.actions,type:"actions",actions:["up","down"]}]};this.fieldsTable=new m(a);
this.fieldsTable.placeAt(this.fieldsContainer);this.fieldsTable.startup()},_createSpecialType:function(a){a=c.create("select",{},a);c.create("option",{value:"none",label:this.nls.none,selected:!0,innerHTML:this.nls.none},a);c.create("option",{value:"link",label:this.nls.link,innerHTML:this.nls.link},a);c.create("option",{value:"image",label:this.nls.image,innerHTML:this.nls.image},a)},_setValue4SpecialType:function(a,d){f("select",a)[0].value=d},_getValueOfSpecialType:function(a){return f("select",
a)[0].value},_initAddFields:function(){var d=c.create("div");this.tooltipDialog=new u({style:"cursor:pointer",content:d});this.menu=new a;this.menu.placeAt(d);this.own(b(document.body,"click",e.hitch(this,function(){v.close(this.tooltipDialog)})))},_onAddClicked:function(a){a.stopPropagation();a.preventDefault();v.close(this.tooltipDialog);v.open({popup:this.tooltipDialog,around:this.btnAddFields})},_resetMenu:function(){var a=this.menu.getChildren();g.forEach(a,e.hitch(this,function(a){this.menu.removeChild(a)}))},
_addEmptyMenuItem:function(){var a=new r({label:this.nls.noField,onClick:e.hitch(this,function(){var a=this.menu.getParent();c.setStyle(a.domNode.parentNode,"display","none")})});this.menu.addChild(a)},_setFields:function(a){this._resetMenu();a=g.filter(a,function(a){return"esriFieldTypeGeometry"!==a.type});0<a.length?g.forEach(a,e.hitch(this,function(a){this._addMenuItem(a);this._addRow(a)})):this._addEmptyMenuItem()},_addMenuItem:function(a){var d=new r({label:a.name+" {"+a.name+"}",onClick:e.hitch(this,
function(){var d=this.titleTextBox.get("value")+"${"+a.name+"}";this.titleTextBox.set("value",d);d=this.menu.getParent();c.setStyle(d.domNode.parentNode,"display","none")})});this.menu.addChild(d)},_addRow:function(a){a=e.clone(a);var d=this.fieldsTable.addRow(a);d.success&&(d.tr.fieldInfo=a)},_onBtnSortFieldsClicked:function(){var a=this._getLayerDefinition();if(a&&this._shouldEnableSorting(a))var b=new d({nls:this.nls,layerDefinition:a,orderByFields:e.clone(this._currentOrderByFields),validSortFieldTypes:this._validSortFieldTypes}),
c=new s({width:640,height:380,titleLabel:this.nls.setSortingFields,content:b,onClose:e.hitch(this,function(){b.destroy()}),buttons:[{label:this.nls.ok,onClick:e.hitch(this,function(){var a=b.getOrderByFields();this._setOrderByFields(a);c.close()})},{label:this.nls.cancel,onClick:e.hitch(this,function(){c.close()})}]})},_shouldEnableSorting:function(a){return this._isServiceSupportsPagination(a)&&this._isServiceSupportsOrderBy(a)},_isServiceSupportsPagination:function(a){var d=!1;a.advancedQueryCapabilities&&
a.advancedQueryCapabilities.supportsPagination&&(d=!0);return d},_isServiceSupportsOrderBy:function(a){var d=!1;a.advancedQueryCapabilities&&a.advancedQueryCapabilities.supportsOrderBy&&(d=!0);return d},_getOrderByFields:function(){return this._currentOrderByFields},_setOrderByFields:function(a){a=a||[];var d=this.sortFieldsDiv.innerHTML="";a=g.map(a,e.hitch(this,function(b,c){var e=b.split(" "),r=e[0],f="ASC";e[1]&&"string"===typeof e[1]&&(e[1]=e[1].toUpperCase(),"DESC"===e[1]&&(f="DESC"));e=f.toLowerCase();
e="\x3cspan\x3e"+r+'\x3c/span\x3e\x3cspan class\x3d"sort-arrow '+e+'"\x3e\x3c/span\x3e';c!==a.length-1&&(e+="\x3cspan\x3e,\x26nbsp;\x3c/span\x3e");d+=e;return r+" "+f}));d&&(d="\x3cspan\x3e\x26nbsp;\x26nbsp;\x3c/span\x3e"+d);this.sortFieldsDiv.innerHTML=d;this._currentOrderByFields=a}})})},"widgets/Query/setting/SortFields":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/registry dijit/form/Select dojo/text!./SortFields.html dojo/on dojo/query dojo/_base/lang dojo/_base/array dojo/_base/html jimu/dijit/SimpleTable".split(" "),
function(l,n,t,q,k,e,c,g,b,f,m,s,u){return l([n,t,q],{baseClass:"jimu-query-setting-sort-fields",templateString:c,_allFieldNames:null,_sortTipClassName:"sort-tip",_fieldNameSelectClassName:"field-name-select",_sortTypeSelectClassName:"sort-type-select",nls:null,layerDefinition:null,orderByFields:null,validSortFieldTypes:[],postCreate:function(){this.inherited(arguments);var a=m.filter(this.layerDefinition.fields,f.hitch(this,function(a){return 0<=this.validSortFieldTypes.indexOf(a.type)}));this._allFieldNames=
m.map(a,function(a){return a.name});this._initTable();this.orderByFields?this._setOrderByFields(this.orderByFields):this.orderByFields=[]},_initTable:function(){var a={autoHeight:!1,style:"height:187px",fields:[{name:"sortTip",title:this.nls.field,type:"text",width:"100px"},{name:"fieldName",title:"",type:"extension",create:f.hitch(this,this._create4FieldName),setValue:f.hitch(this,this._setValue4FieldName),getValue:f.hitch(this,this._getValue4FieldName)},{name:"sortType",title:this.nls.sortingOrder,
type:"extension",create:f.hitch(this,this._create4SortType),setValue:f.hitch(this,this._setValue4SortType),getValue:f.hitch(this,this._getValue4SortType)},{name:"actions",title:this.nls.actions,type:"actions",actions:["up","down","delete"],width:"120px"}]};this.table=new u(a);this.own(g(this.table,"row-up",f.hitch(this,this._onTableRowUp)));this.own(g(this.table,"row-down",f.hitch(this,this._onTableRowDown)));this.table.placeAt(this.tableDiv);this.table.startup()},getOrderByFields:function(){var a=
this.table.getData();return m.map(a,f.hitch(this,function(a){return a.fieldName+" "+a.sortType}))},_getFieldAlias:function(a){for(var b=a,c=this.layerDefinition.fields,d=0;d<c.length;d++)if(c[d].name===a){b=c[d].alias||a;break}return b},_getRestFields:function(){var a=this._getAllFieldSelects(),b=m.map(a,f.hitch(this,function(a){return a.get("value")}));return m.filter(this._allFieldNames,f.hitch(this,function(a){return 0>b.indexOf(a)}))},_onAddNewClicked:function(){var a=this._getRestFields();if(0!==
a.length){var b="",b=0===this.table.getRows().length?this.nls.sortBy:this.nls.thenBy;this.table.addRow({sortTip:b,fieldName:a[0],sortType:"ASC"})}},_setOrderByFields:function(a){this.table.clear();a=a||[];m.forEach(a,f.hitch(this,function(a,b){var d=a.split(" "),c=d[0],e="ASC";d[1]&&"string"===typeof d[1]&&(d[1]=d[1].toUpperCase(),"DESC"===d[1]&&(e="DESC"));d="";d=0===b?this.nls.sortBy:this.nls.thenBy;this.table.addRow({sortTip:d,fieldName:c,sortType:e})}))},_getAllFieldSelects:function(){var a=b("."+
this._fieldNameSelectClassName,this.table.tbody);return m.map(a,f.hitch(this,function(a){return k.byNode(a)}))},_getSelectFromTd:function(a,c){var e=b("."+c,a)[0];return k.byNode(e)},_onTableRowUp:function(){this._resetSortTips()},_onTableRowDown:function(){this._resetSortTips()},_getAllSortTipDivs:function(){return b(".sortTip .normal-text-div",this.table.tbody)},_resetSortTips:function(){var a=this.table.getRows();m.forEach(a,f.hitch(this,function(a,b){var d="",d=0===b?this.nls.sortBy:this.nls.thenBy;
this.table.editRow(a,{sortTip:d})}));a=this._getAllSortTipDivs();m.forEach(a,f.hitch(this,function(a,b){a.innerHTML=0===b?this.nls.sortBy:this.nls.thenBy}))},_create4FieldName:function(a){var b=this._getRestFields(),c=new e({style:"width:120px;height:20px;"});s.addClass(c.domNode,this._fieldNameSelectClassName);c.placeAt(a);m.forEach(b,f.hitch(this,function(a){var b=this._getFieldAlias(a);c.addOption({value:a,label:b})}));this.own(g(c,"change",f.hitch(this,this._onFieldNameSelectChanged)))},_setValue4FieldName:function(a,
b){this._getSelectFromTd(a,this._fieldNameSelectClassName).set("value",b)},_getValue4FieldName:function(a){return this._getSelectFromTd(a,this._fieldNameSelectClassName).get("value")},_onFieldNameSelectChanged:function(){var a=this._getAllFieldSelects();m.forEach(a,f.hitch(this,function(a){var b=a.get("value"),d=a.getOptions(),d=m.filter(d,f.hitch(this,function(a){return a.value!==b}));a.removeOption(d);d=this._getRestFields();m.forEach(d,f.hitch(this,function(d){if(d!==b){var c=this._getFieldAlias(d);
a.addOption({value:d,label:c})}}))}))},_create4SortType:function(a){var b=new e({style:"width:120px;height:20px;"});s.addClass(b.domNode,this._sortTypeSelectClassName);b.placeAt(a);b.addOption({value:"ASC",label:this.nls.ascending,selected:!0});b.addOption({value:"DESC",label:this.nls.descending})},_setValue4SortType:function(a,b){var c=this._getSelectFromTd(a,this._sortTypeSelectClassName);("ASC"===b||"DESC"===b)&&c.set("value",b)},_getValue4SortType:function(a){return this._getSelectFromTd(a,this._sortTypeSelectClassName).get("value")}})})},
"jimu/dijit/Filter":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/Filter.html jimu/filterUtils jimu/utils dijit/registry dojo/_base/lang dojo/_base/html dojo/_base/array dojo/aspect dojo/query dojo/Deferred esri/request ./_SingleFilter ./_FilterSet ./LoadingIndicator".split(" "),function(l,n,t,q,k,e,c,g,b,f,m,s,u,a,r,v,d){return l([n,t,q,e],{templateString:k,baseClass:"jimu-filter",declaredClass:"jimu.dijit.Filter",
nls:null,_validOptions:!1,_layerDefinition:null,_def:null,noFilterTip:"",enableAskForValues:!1,postMixInProperties:function(){this.nls=window.jimuNls.filterBuilder;var a=this.nls.matchMsg.split("${any_or_all}");this.nls.strMatchMsgPart1=a[0]||"";this.nls.strMatchMsgPart2=a[1]||"";this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this.noFilterTip&&"string"===typeof this.noFilterTip&&(this.noFilterTipSection.innerHTML=this.noFilterTip)},reset:function(){this.isBuilding()||(this.removeAllFilters(),
this.url=null,this.isHosted=!1,this.partsObj=this.expr=this._layerDefinition=null)},isBuilding:function(){return this._def&&!this._def.isFulfilled()},buildByExpr:function(d,b,e){var f=new a;this.isBuilding()?f.reject("Filter is already building."):(this._def=null,this.reset(),this.url=d,this.isHosted=c.isHostedService(this.url),this.expr=b||"1\x3d1",this._layerDefinition=e,f=this._def=this._init("expr"));return f},buildByFilterObj:function(d,b,e){var f=new a;this.isBuilding()?f.reject("Filter is already building."):
(this._def=null,this.reset(),this.url=d,this.isHosted=c.isHostedService(this.url),this.partsObj=b,this._layerDefinition=e,f=this._def=this._init("partsObj"));return f},removeAllFilters:function(){this._destroyAllFilters()},_validateLayerDefinition:function(a){return this._isObject(a)},_init:function(d){var c=new a;if(!this._isString(this.url))return c.reject(),c;var e=b.hitch(this,function(){setTimeout(b.hitch(this,function(){c.resolve()}),1500)}),g=b.hitch(this,function(){f.setStyle(this.contentSection,
"display","block");f.setStyle(this.errorSection,"display","none");this.removeAllFilters();var a=this._layerDefinition.fields;a&&0<a.length?(a=m.filter(a,b.hitch(this,function(a){return 0<=this._supportFieldTypes.indexOf(a.type)})))&&0<a.length?(this._validOptions=!0,f.removeClass(this.btnAddSet,"jimu-state-disabled"),f.removeClass(this.btnAddExp,"jimu-state-disabled"),f.removeClass(this.iconAddExp,"jimu-state-disabled"),f.removeClass(this.iconAddSet,"jimu-state-disabled"),this.createFieldsStore(),
"expr"===d?this._isString(this.expr)?("1\x3d1"===this.expr.replace(/\s/gi,"")&&this.removeAllFilters(),this._parseExpr(this.expr)?e():c.reject()):c.reject():"partsObj"===d?this._validatePartsObj(this.partsObj)?(this._parsePartsObj(this.partsObj),e()):c.reject():this._validatePartsObj(this.partsObj)?(this._parsePartsObj(this.partsObj),e()):this._isString(this.expr)?this._parseExpr(this.expr)?e():c.reject():(this.removeAllFilters(),e())):(this._showErrorOptions(this.nls.error.noFilterFields),c.reject()):
c.reject()});this._validateLayerDefinition(this._layerDefinition)?g():(this.loading.show(),r({url:this.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(b.hitch(this,function(a){this.domNode?(this.loading.hide(),this._layerDefinition=a,g()):c.reject()}),b.hitch(this,function(a){console.error(a);c.reject();this.domNode&&this.loading.hide()})));return c},toJson:function(){var a={logicalOperator:this.allAnySelect.value,parts:[]},d=this._getAllSingleFiltersAndFilterSets();if(0===
d.length)return a.expr="1\x3d1",a;m.forEach(d,b.hitch(this,function(d){d=d.toJson();a.parts.push(d)}));return m.every(a.parts,b.hitch(this,function(a){return!!a}))&&0<a.parts.length?(a.expr=this.getExprByFilterObj(a),a):null},createFieldsStore:function(){if(!this._layerDefinition.fields||0===this._layerDefinition.fields.length)this._showErrorOptions(this.nls.error.noFilterFields);else{var a=b.clone(this._layerDefinition).fields;0===this.setFieldsStoreByFieldInfos(a)&&this._showErrorOptions(this.nls.error.noFilterFields)}},
_parsePartsObj:function(a){this._validatePartsObj(a)&&(this.removeAllFilters(),this._buildEditUIByPartsObj(a))},_parseExpr:function(a){this._destroyAllFilters();var d=null;if(!this._validateLayerDefinition(this._layerDefinition))return d;if(!a||"string"!==typeof a)return this._showErrorOptions(this.nls.error.invalidSQL),d;if("1\x3d1"===this.expr.replace(/\s/gi,""))return d={expr:"1\x3d1",parts:[],logicalOperator:"AND"};d=this.getFilterObjByExpr(a);a=!1;d&&(a=d.parts&&0<d.parts.length?m.every(d.parts,
b.hitch(this,function(a){return a.parts?0<a.parts.length?m.every(a.parts,b.hitch(this,function(a){return!a.error})):!1:!a.error})):!1);a?this._buildEditUIByPartsObj(d):(d=null,this._showErrorOptions(this.nls.error.cantParseSQL));return d},_buildEditUIByPartsObj:function(a){a&&(this._destroyAllFilters(),this.allAnySelect.value=a.logicalOperator,m.forEach(a.parts,b.hitch(this,function(a){a.parts?this._addFilterSet(a):a.fieldObj&&(a.operator&&a.valueObj)&&this._addSingleFilter(a)})))},_addSingleFilter:function(a){a=
{url:this.url,layerInfo:this._layerDefinition,stringFieldType:this._stringFieldType,dateFieldType:this._dateFieldType,numberFieldTypes:this._numberFieldTypes,part:a,OPERATORS:b.mixin({},this.OPERATORS),enableAskForValues:this.enableAskForValues,isHosted:this.isHosted};a=new v(a);a.placeAt(this.allExpsBox);a.startup();this.own(s.after(a,"_destroySelf",b.hitch(this,this._checkFilterNumbers)));this._checkFilterNumbers()},_addFilterSet:function(a){a={url:this.url,layerInfo:this._layerDefinition,stringFieldType:this._stringFieldType,
dateFieldType:this._dateFieldType,numberFieldTypes:this._numberFieldTypes,partsObj:a,OPERATORS:b.mixin({},this.OPERATORS),enableAskForValues:this.enableAskForValues,isHosted:this.isHosted};a=new d(a);a.placeAt(this.allExpsBox);a.startup();this.own(s.after(a,"_destroySelf",b.hitch(this,this._checkFilterNumbers)));this._checkFilterNumbers()},_destroyAllFilters:function(){for(var a=this._getAllSingleFiltersAndFilterSets();0<a.length;)a[0].destroy(),a.splice(0,1);this._checkFilterNumbers()},_getAllSingleFiltersAndFilterSetsDoms:function(){return u(".allExpsBox\x3e.jimu-single-filter,.allExpsBox\x3e.jimu-filter-set",
this.contentSection)},_getAllSingleFiltersAndFilterSets:function(){var a=this._getAllSingleFiltersAndFilterSetsDoms();return m.map(a,b.hitch(this,function(a){return g.byNode(a)}))},_checkFilterNumbers:function(){var a=this._getAllSingleFiltersAndFilterSetsDoms();1<a.length?f.setStyle(this.matchMsg,"display","block"):f.setStyle(this.matchMsg,"display","none");0<a.length?f.setStyle(this.noFilterTipSection,"display","none"):f.setStyle(this.noFilterTipSection,"display","block");m.forEach(a,b.hitch(this,
function(a,d){f.removeClass(a,"even-filter");f.removeClass(a,"odd-filter");f.addClass(a,0===(d+1)%2?"even-filter":"odd-filter")}))},_showErrorOptions:function(a){f.setStyle(this.contentSection,"display","none");f.setStyle(this.errorSection,"display","none");this.errorTip.innerHTML=a;this.loading.hide()},_onBtnAddSetClick:function(){this._layerDefinition&&this._validOptions&&this._addFilterSet()},_onBtnAddExpClick:function(){this._layerDefinition&&this._validOptions&&this._addSingleFilter()}})})},
"jimu/dijit/_SingleFilter":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_SingleFilter.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/json dojo/on dojo/store/Memory esri/request jimu/utils jimu/dijit/CheckBox dijit/form/Select dijit/form/FilteringSelect dijit/form/ValidationTextBox dijit/form/DateTextBox dijit/form/NumberTextBox".split(" "),function(l,n,t,q,k,e,c,g,b,f,m,s,u){return l([n,t,q],{templateString:k,
baseClass:"jimu-single-filter",declaredClass:"jimu.dijit._SingleFilter",nls:null,url:null,layerInfo:null,stringFieldType:"",dateFieldType:"",numberFieldTypes:[],supportFieldTypes:[],part:null,OPERATORS:null,enableAskForValues:!1,isHosted:!1,postMixInProperties:function(){this.supportFieldTypes=[];this.supportFieldTypes.push(this.stringFieldType);this.supportFieldTypes.push(this.dateFieldType);this.supportFieldTypes=this.supportFieldTypes.concat(this.numberFieldTypes);this.nls=window.jimuNls.filterBuilder;
this.nls.caseSensitive||(this.nls.caseSensitive="Case Sensitive")},postCreate:function(){this.inherited(arguments);this._initSelf()},toJson:function(){var a=null,b=this._isUseAskForValues(),c=this._getSelectedFilteringItem(this.fieldsSelect);if(!c)return null;a={fieldObj:"",operator:"",valueObj:"",interactiveObj:"",caseSensitive:!1};if(b){if(!this.promptTB.validate())return this._showValidationErrorTip(this.promptTB),null;a.interactiveObj={prompt:this.promptTB.get("value"),hint:this.hintTB.get("value")}}a.fieldObj=
{name:c.name,label:c.name,shortType:c.shortType,type:c.type};if("none"===this.operatorsSelect.get("value"))return null;a.operator=this.operatorsSelect.get("value");a.valueObj={isValid:!0,type:""};var d=c.shortType;if(this.valueRadio.checked)if(a.valueObj.type="value","string"===d)if(a.operator===this.OPERATORS.stringOperatorIsBlank||a.operator===this.OPERATORS.stringOperatorIsNotBlank)a.valueObj.value=null;else if(this._isFieldCoded(c)&&a.operator===this.OPERATORS.stringOperatorIs){if(!this.stringCodedValuesFS.validate())return this._showValidationErrorTip(this.stringCodedValuesFS),
null;b=this._getSelectedFilteringItem(this.stringCodedValuesFS);a.valueObj.value=b?b.code:""}else{if(!this.stringTextBox.validate())return this._showValidationErrorTip(this.stringTextBox),null;a.valueObj.value=this.stringTextBox.get("value")}else if("number"===d)if(a.operator===this.OPERATORS.numberOperatorIsBlank||a.operator===this.OPERATORS.numberOperatorIsNotBlank)a.valueObj.value=null;else if(a.operator===this.OPERATORS.numberOperatorIsBetween||a.operator===this.OPERATORS.numberOperatorIsNotBetween){if(!this.numberTextBox1.validate())return this._showValidationErrorTip(this.numberTextBox1),
null;if(!this.numberTextBox2.validate())return this._showValidationErrorTip(this.numberTextBox2),null;a.valueObj.value1=this._getValueForNumberTextBox(this.numberTextBox1);a.valueObj.value2=this._getValueForNumberTextBox(this.numberTextBox2);a.valueObj.isValid=u.isValidNumber(a.valueObj.value1)&&u.isValidNumber(a.valueObj.value2)}else{if(this._isFieldCoded(c)&&a.operator===this.OPERATORS.numberOperatorIs){if(!this.numberCodedValuesFS.validate())return this._showValidationErrorTip(this.numberCodedValuesFS),
null;b=this._getSelectedFilteringItem(this.numberCodedValuesFS);a.valueObj.value=b?parseFloat(b.code):null}else{if(!this.numberTextBox.validate())return this._showValidationErrorTip(this.numberTextBox),null;a.valueObj.value=this._getValueForNumberTextBox(this.numberTextBox)}a.valueObj.isValid=u.isValidNumber(a.valueObj.value)}else{if("date"===d)if(a.operator===this.OPERATORS.dateOperatorIsBlank||a.operator===this.OPERATORS.dateOperatorIsNotBlank)a.valueObj.value=null;else if(a.operator===this.OPERATORS.dateOperatorIsBetween||
a.operator===this.OPERATORS.dateOperatorIsNotBetween){if(!this.dateTextBox1.validate())return this._showValidationErrorTip(this.dateTextBox1),null;if(!this.dateTextBox2.validate())return this._showValidationErrorTip(this.dateTextBox2),null;a.valueObj.value1=this.dateTextBox1.get("value").toDateString();a.valueObj.value2=this.dateTextBox2.get("value").toDateString()}else{if(!this.dateTextBox.validate())return this._showValidationErrorTip(this.dateTextBox),null;a.valueObj.value=this.dateTextBox.get("value").toDateString()}}else if(this.fieldRadio.checked){b=
this._getSelectedFilteringItem(this.fieldsSelect2);if(!b)return this._showValidationErrorTip(this.fieldsSelect2),null;a.valueObj.value=b.name;a.valueObj.label=b.name;a.valueObj.type="field"}else if(this.uniqueRadio&&this.uniqueRadio.checked)if(a.valueObj.type="unique",c=this._getSelectedFilteringItem(this.uniqueValuesSelect))"string"===d?a.valueObj.value=c.value:"number"===d&&(a.valueObj.value=parseFloat(c.value));else if(b)"string"===d?a.valueObj.value="":"number"===d&&(a.valueObj.value=null,a.valueObj.isValid=
!1);else return this._showValidationErrorTip(this.uniqueValuesSelect),null;if("string"===d)switch(a.operator){case this.OPERATORS.stringOperatorStartsWith:case this.OPERATORS.stringOperatorEndsWith:case this.OPERATORS.stringOperatorContains:case this.OPERATORS.stringOperatorDoesNotContain:a.caseSensitive=this.cbxCaseSensitive.getValue()}return a},showDelteIcon:function(){c.setStyle(this.btnDelete,"display","inline-block")},hideDeleteIcon:function(){c.setStyle(this.btnDelete,"display","none")},_showCaseSensitive:function(){c.setStyle(this.cbxCaseSensitive.domNode,
"display","inline-block")},_hideCaseSensitive:function(){c.setStyle(this.cbxCaseSensitive.domNode,"display","none")},_getProcessedString:function(a){return u.isNotEmptyString(a,!0)?a:""},_getProcessedNumber:function(a){return u.isValidNumber(a)?a:null},_setValueForStringTextBox:function(a,b){b=this._getProcessedString(b);a.set("value",b)},_setValueForNumberTextBox:function(a,b){u.isValidNumber(b)&&a.set("value",b)},_getValueForNumberTextBox:function(a){a=a.get("value");return this._getProcessedNumber(a)},
_initSelf:function(){this.isHosted&&(this.cbxCaseSensitive.setValue(!1),this.cbxCaseSensitive.setStatus(!1),this.cbxCaseSensitive.domNode.title=this.nls.notSupportCaseSensitiveTip);this.own(f(this.cbxAskValues,"status-change",e.hitch(this,this._onCbxAskValuesStatusChanged)));this.cbxAskValues.onChange=e.hitch(this,this._onCbxAskValuesClicked);this.own(f(this.fieldsSelect,"MouseEnter",e.hitch(this,this._updateFieldsSelectTitle)));this.own(f(this.operatorsSelect,"MouseEnter",e.hitch(this,this._updateOperatorsSelectTitle)));
this.own(f(this.dateTextBox1,"MouseEnter",e.hitch(this,this._updateDateTextBox1Title)));this.own(f(this.dateTextBox2,"MouseEnter",e.hitch(this,this._updateDateTextBox2Title)));var a=new m({idProperty:"id",data:[]});this.uniqueValuesSelect.set("store",a);this.enableAskForValues?(c.setStyle(this.cbxAskValues.domNode,"display","inline-block"),c.setStyle(this.promptSection,"display","block")):(c.setStyle(this.cbxAskValues.domNode,"display","none"),c.setStyle(this.promptSection,"display","none"));this.layerInfo=
e.mixin({},this.layerInfo);this._initRadios();a=0;this.layerInfo.currentVersion&&(a=parseFloat(this.layerInfo.currentVersion));if(10.1>a||this._isStreamServer(this.url))c.destroy(this.uniqueTd),this.uniqueRadio=null;if((a=this.layerInfo.fields)&&0<a.length)a=g.filter(a,e.hitch(this,function(a){return 0<=this.supportFieldTypes.indexOf(a.type)})),this._enableRadios(),this._initFieldsSelect(a)},_isStreamServer:function(a){a=(a||"").replace(/\/*$/g,"");return/\/StreamServer$/gi.test(a)},_updateFieldsSelectTitle:function(){this.fieldsSelect.domNode.title=
"";var a=this._getSelectedFilteringItem(this.fieldsSelect);a&&(this.fieldsSelect.domNode.title=a.displayName||a.alias||a.name)},_updateOperatorsSelectTitle:function(){this.operatorsSelect.domNode.title="";var a=this.operatorsSelect.get("value");a&&(a=this.operatorsSelect.getOptions(a),this.operatorsSelect.domNode.title=a.label)},_updateDateTextBox1Title:function(){var a=this.dateTextBox1.get("displayedValue")||"";this.dateTextBox1.domNode.title=a},_updateDateTextBox2Title:function(){var a=this.dateTextBox2.get("displayedValue")||
"";this.dateTextBox2.domNode.title=a},_showValidationErrorTip:function(a){try{!a.validate()&&a.domNode&&a.focusNode&&(a.focusNode.focus(),a.focusNode.blur())}catch(b){console.error(b)}},_focusValidationTextBox:function(a){try{a&&a.focusNode&&a.focusNode.focus()}catch(b){console.error(b)}},_isFieldCoded:function(a){return(a=a.domain)&&"codedValue"===a.type&&a.codedValues&&0<a.codedValues.length},_getSelectedFilteringItem:function(a){if(a.validate()){var b=a.get("item");if(b)return b}this._showValidationErrorTip(a);
return null},_getShortTypeByFieldType:function(a){return a===this.stringFieldType?"string":a===this.dateFieldType?"date":0<=this.numberFieldTypes.indexOf(a)?"number":null},_getOperatorsByShortType:function(a){var b=[];"string"===a?b=[this.OPERATORS.stringOperatorIs,this.OPERATORS.stringOperatorIsNot,this.OPERATORS.stringOperatorStartsWith,this.OPERATORS.stringOperatorEndsWith,this.OPERATORS.stringOperatorContains,this.OPERATORS.stringOperatorDoesNotContain,this.OPERATORS.stringOperatorIsBlank,this.OPERATORS.stringOperatorIsNotBlank]:
"number"===a?b=[this.OPERATORS.numberOperatorIs,this.OPERATORS.numberOperatorIsNot,this.OPERATORS.numberOperatorIsAtLeast,this.OPERATORS.numberOperatorIsLessThan,this.OPERATORS.numberOperatorIsAtMost,this.OPERATORS.numberOperatorIsGreaterThan,this.OPERATORS.numberOperatorIsBetween,this.OPERATORS.numberOperatorIsNotBetween,this.OPERATORS.numberOperatorIsBlank,this.OPERATORS.numberOperatorIsNotBlank]:"date"===a&&(b=[this.OPERATORS.dateOperatorIsOn,this.OPERATORS.dateOperatorIsNotOn,this.OPERATORS.dateOperatorIsBefore,
this.OPERATORS.dateOperatorIsAfter,this.OPERATORS.dateOperatorIsBetween,this.OPERATORS.dateOperatorIsNotBetween,this.OPERATORS.dateOperatorIsBlank,this.OPERATORS.dateOperatorIsNotBlank]);return b},_initFieldsSelect:function(a){a=g.map(a,e.hitch(this,function(a,d){var b=e.mixin({},a);b.id=d;b.shortType=this._getShortTypeByFieldType(a.type);b.alias||(b.alias=b.name);var c="";"string"===b.shortType?c=this.nls.string:"number"===b.shortType?c=this.nls.number:"date"===b.shortType&&(c=this.nls.date);b.displayName=
b.alias+" ("+c+")";return b}));if(0<a.length){var b=new m({data:a});this.fieldsSelect.set("store",b);this.fieldsSelect.set("value",a[0].id)}this.fieldsSelect.focusNode.focus();this.fieldsSelect.focusNode.blur();this._onFieldsSelectChange();this.part&&this._showPart(this.part)},_showPart:function(a){if((this.part=a)&&this.part.fieldObj&&this.part.operator&&this.part.valueObj){a=this.part.fieldObj.name;var b=this.part.operator;this.part.caseSensitive=!!this.part.caseSensitive;a=this.fieldsSelect.store.query({name:a});
if(0!==a.length&&(a=a[0]))this.fieldsSelect.set("value",a.id),setTimeout(e.hitch(this,function(){this.domNode&&(this._onFieldsSelectChange(),this.operatorsSelect.set("value",b),setTimeout(e.hitch(this,function(){this.domNode&&this._resetByFieldAndOperation(this.part)}),50),setTimeout(e.hitch(this,function(){if(this.domNode){var a=this.part.interactiveObj;a&&(this.cbxAskValues.check(),this._updatePrompt(),this.promptTB.set("value",a.prompt||""),this.hintTB.set("value",a.hint||""))}}),100))}),0)}},
_onFieldsSelectChange:function(){this._updateFieldsSelectTitle();this.operatorsSelect.removeOption(this.operatorsSelect.getOptions());this.operatorsSelect.addOption({value:"none",label:this.nls.none});this.valueRadio.checked=!0;var a=this._getSelectedFilteringItem(this.fieldsSelect);a&&(this.operatorsSelect.shortType=a.shortType,a=this._getOperatorsByShortType(a.shortType),this.operatorsSelect.removeOption(this.operatorsSelect.getOptions()),g.forEach(a,e.hitch(this,function(a){this.operatorsSelect.addOption({value:a,
label:this.nls[a]})})));this._onOperatorsSelectChange()},_onOperatorsSelectChange:function(){this._updateOperatorsSelectTitle();this.valueRadio.checked=!0;this._resetByFieldAndOperation()},_onRangeNumberBlur:function(){if(this.numberTextBox1.validate()&&this.numberTextBox2.validate()){var a=this._getValueForNumberTextBox(this.numberTextBox1),b=this._getValueForNumberTextBox(this.numberTextBox2);u.isValidNumber(a)&&u.isValidNumber(b)&&a>b&&(this._setValueForNumberTextBox(this.numberTextBox1,b),this._setValueForNumberTextBox(this.numberTextBox2,
a))}},_onRangeDateBlur:function(){if(this.dateTextBox1.validate()&&this.dateTextBox2.validate()){var a=this.dateTextBox1.get("value"),b=a.getTime(),c=this.dateTextBox2.get("value"),d=c.getTime();b>d&&(this.dateTextBox1.set("value",c),this.dateTextBox2.set("value",a))}},_initRadios:function(){var a="radio_"+u.getRandomString();this.valueRadio.name=a;this.fieldRadio.name=a;u.combineRadioCheckBoxWithLabel(this.valueRadio,this.valueLabel);u.combineRadioCheckBoxWithLabel(this.fieldRadio,this.fieldLabel);
this.own(f(this.valueRadio,"click",e.hitch(this,function(){this._resetByFieldAndOperation()})));this.own(f(this.fieldRadio,"click",e.hitch(this,function(){this._resetByFieldAndOperation()})));this.uniqueRadio&&(this.uniqueRadio.name=a,u.combineRadioCheckBoxWithLabel(this.uniqueRadio,this.uniqueLabel),this.own(f(this.uniqueRadio,"click",e.hitch(this,function(){this._resetByFieldAndOperation()}))));this._resetByFieldAndOperation()},_enableRadios:function(){this.valueRadio.disabled=!1;this.fieldRadio.disabled=
!1;this.uniqueRadio&&(this.uniqueRadio.disabled=!1)},_disableRadios:function(){this.valueRadio.disabled=!0;this.fieldRadio.disabled=!0;this.uniqueRadio&&(this.uniqueRadio.disabled=!0)},_resetByFieldAndOperation:function(a){var b=a&&a.valueObj;c.setStyle(this.attributeValueContainer,"display","block");this._enableRadios();this._hideCaseSensitive();b&&("value"===b.type?this.valueRadio.checked=!0:"field"===b.type?this.fieldRadio.checked=!0:"unique"===b.type&&this.uniqueRadio&&(this.uniqueRadio.checked=
!0));var e=this._getSelectedFilteringItem(this.fieldsSelect),d=e&&e.shortType,f=this.operatorsSelect.get("value");if(e)if("string"===d)switch(f){case this.OPERATORS.stringOperatorStartsWith:case this.OPERATORS.stringOperatorEndsWith:case this.OPERATORS.stringOperatorContains:case this.OPERATORS.stringOperatorDoesNotContain:this.valueRadio.checked=!0,this._disableRadios(),this._showCaseSensitive(),a&&this.cbxCaseSensitive.setValue(a.caseSensitive)}else if("number"===d)switch(f){case this.OPERATORS.numberOperatorIsBetween:case this.OPERATORS.numberOperatorIsNotBetween:this.valueRadio.checked=
!0,this._disableRadios()}else if("date"===d){switch(f){case this.OPERATORS.dateOperatorIsBetween:case this.OPERATORS.dateOperatorIsNotBetween:this.valueRadio.checked=!0,this._disableRadios()}this.uniqueRadio&&(this.uniqueRadio.disabled=!0,this.uniqueRadio.checked&&(this.valueRadio.checked=!0))}this._updateUIOfAttrValueContainer(e,f,b)},_updateUIOfAttrValueContainer:function(a,b,f){this._updatePrompt();var d=a&&a.shortType;if("string"===d||"number"===d||"date"===d)if(c.setStyle(this.attributeValueContainer,
"display","block"),this.valueRadio.checked)if(c.setStyle(this.fieldsSelect2.domNode,"display","none"),c.setStyle(this.uniqueValuesSelect.domNode,"display","none"),this._showAllValueBoxContainer(),this._resetValueTextBox(),"string"===d)c.setStyle(this.stringTextBoxContainer,"display","block"),c.setStyle(this.numberTextBoxContainer,"display","none"),c.setStyle(this.dateTextBoxContainer,"display","none"),this._isFieldCoded(a)&&b===this.OPERATORS.stringOperatorIs?(c.setStyle(this.stringCodedValuesFS.domNode,
"display","inline-block"),c.setStyle(this.stringTextBox.domNode,"display","none"),a=g.map(a.domain.codedValues,e.hitch(this,function(a,b){var d=e.mixin({},a);d.id=b;return d})),d=new m({data:a}),this.stringCodedValuesFS.set("store",d),f?(d=g.filter(a,e.hitch(this,function(a){return a.code===f.value})),0<d.length?this.stringCodedValuesFS.set("value",d[0].id):this.stringCodedValuesFS.set("value",a[0].id)):this.stringCodedValuesFS.set("value",a[0].id)):(c.setStyle(this.stringTextBox.domNode,"display",
"inline-block"),c.setStyle(this.stringCodedValuesFS.domNode,"display","none"),f&&this._setValueForStringTextBox(this.stringTextBox,f.value)),(b===this.OPERATORS.stringOperatorIsBlank||b===this.OPERATORS.stringOperatorIsNotBlank)&&c.setStyle(this.attributeValueContainer,"display","none");else if("number"===d){c.setStyle(this.stringTextBoxContainer,"display","none");c.setStyle(this.numberTextBoxContainer,"display","block");c.setStyle(this.dateTextBoxContainer,"display","none");if(b===this.OPERATORS.numberOperatorIsBetween||
b===this.OPERATORS.numberOperatorIsNotBetween){if(c.setStyle(this.numberTextBox.domNode,"display","none"),c.setStyle(this.numberRangeTable,"display","table"),c.setStyle(this.numberCodedValuesFS.domNode,"display","none"),f){var k;a=u.isValidNumber(f.value1);d=u.isValidNumber(f.value2);a&&d?(d=parseFloat(f.value1),k=parseFloat(f.value2),a=Math.min(d,k),d=Math.max(d,k),this.numberTextBox1.set("value",a),this.numberTextBox2.set("value",d)):a&&!d?(d=parseFloat(f.value1),this.numberTextBox1.set("value",
d)):!a&&d&&(k=parseFloat(f.value2),this.numberTextBox2.set("value",k))}}else if(c.setStyle(this.numberRangeTable,"display","none"),this._isFieldCoded(a)&&b===this.OPERATORS.numberOperatorIs)if(c.setStyle(this.numberTextBox.domNode,"display","none"),c.setStyle(this.numberCodedValuesFS.domNode,"display","inline-block"),a=g.map(a.domain.codedValues,e.hitch(this,function(a,b){var d=e.mixin({},a);d.id=b;return d})),d=new m({data:a}),this.numberCodedValuesFS.set("store",d),f&&!isNaN(f.value)){var h=parseFloat(f.value),
d=g.filter(a,e.hitch(this,function(a){return parseFloat(a.code)===h}));0<d.length?this.numberCodedValuesFS.set("value",d[0].id):this.numberCodedValuesFS.set("value",a[0].id)}else this.numberCodedValuesFS.set("value",a[0].id);else c.setStyle(this.numberTextBox.domNode,"display","inline-block"),c.setStyle(this.numberCodedValuesFS.domNode,"display","none"),f&&this._setValueForNumberTextBox(this.numberTextBox,f.value);(b===this.OPERATORS.numberOperatorIsBlank||b===this.OPERATORS.numberOperatorIsNotBlank)&&
c.setStyle(this.attributeValueContainer,"display","none")}else"date"===d&&(c.setStyle(this.stringTextBoxContainer,"display","none"),c.setStyle(this.numberTextBoxContainer,"display","none"),c.setStyle(this.dateTextBoxContainer,"display","block"),b===this.OPERATORS.dateOperatorIsBetween||b===this.OPERATORS.dateOperatorIsNotBetween?(c.setStyle(this.dateTextBox.domNode,"display","none"),c.setStyle(this.dateRangeTable,"display","table"),f&&(f.value1&&f.value2)&&(this.dateTextBox1.set("value",new Date(f.value1)),
this.dateTextBox2.set("value",new Date(f.value2)))):(c.setStyle(this.dateTextBox.domNode,"display","inline-block"),c.setStyle(this.dateRangeTable,"display","none"),f&&f.value&&this.dateTextBox.set("value",new Date(f.value))),(b===this.OPERATORS.dateOperatorIsBlank||b===this.OPERATORS.dateOperatorIsNotBlank)&&c.setStyle(this.attributeValueContainer,"display","none"));else this.fieldRadio.checked?(this._hideAllValueBoxContainer(),c.setStyle(this.uniqueValuesSelect.domNode,"display","none"),c.setStyle(this.fieldsSelect2.domNode,
"display","inline-block"),this._resetFieldsSelect2(),f&&f.value&&(b=this.fieldsSelect2.store.query({name:f.value}),0<b.length&&(b=b[0])&&this.fieldsSelect2.set("value",b.id))):this.uniqueRadio&&this.uniqueRadio.checked&&(this._hideAllValueBoxContainer(),c.setStyle(this.fieldsSelect2.domNode,"display","none"),c.setStyle(this.uniqueValuesSelect.domNode,"display","inline-block"),this._resetUniqueValuesSelect(f));else c.setStyle(this.attributeValueContainer,"display","none")},_showAllValueBoxContainer:function(){c.setStyle(this.allValueBoxContainer,
"display","block")},_hideAllValueBoxContainer:function(){c.setStyle(this.allValueBoxContainer,"display","none")},_resetValueTextBox:function(){this.stringTextBox.set("value","");this.numberTextBox.set("value","");this.dateTextBox.set("value",new Date)},_resetFieldsSelect2:function(){this.fieldsSelect2.set("displayedValue","");var a=new m({data:[]});this.fieldsSelect2.set("store",a);if(this.fieldsSelect.validate()){var b=this._getSelectedFilteringItem(this.fieldsSelect);if(b){var a=this.fieldsSelect.store.query({shortType:b.shortType}),
c=g.filter(a,e.hitch(this,function(a){return a.id!==b.id})),a=new m({data:c});this.fieldsSelect2.set("store",a);0<c.length&&this.fieldsSelect2.set("value",c[0].id)}}},_tryLocaleNumber:function(a){var b=u.localizeNumber(a);if(null===b||void 0===b)b=a;return b},_resetUniqueValuesSelect:function(a){this.uniqueValuesSelect.reset();this.uniqueValuesSelect.store.setData([]);if(this.layerInfo&&10.1<=parseFloat(this.layerInfo.currentVersion)){var c=this._getSelectedFilteringItem(this.fieldsSelect);if(c){var f=
this.url+"/generateRenderer",d=b.stringify({type:"uniqueValueDef",uniqueValueFields:[c.name]});s({url:f,content:{classificationDef:d,f:"json"},handleAs:"json",callbackParamName:"callback",timeout:15E3}).then(e.hitch(this,function(b){b=b&&b.uniqueValueInfos;var d=this._getSelectedFilteringItem(this.fieldsSelect);if(b&&d&&c.id===d.id){this.uniqueValuesSelect.store.setData([]);var f=-1,m=this._hasCodedValues(d);b=g.map(b,e.hitch(this,function(b,c){var e=b.value,g=e;"number"===d.shortType&&(e=parseFloat(e),
g=this._tryLocaleNumber(e));m&&(g=this._getDisplayNameOfCodedValues(e,d));g={id:c,value:e,label:g};a&&a.value===e&&(f=g.id);return g}));this.uniqueValuesSelect.store.setData(b);0<b.length&&0<=f&&(b=this.uniqueValuesSelect.store.get(f))&&this.uniqueValuesSelect.set("item",b)}}),e.hitch(this,function(a){console.error(a)}))}}},_hasCodedValues:function(a){var b=!1;a.domain&&(a=a.domain.codedValues)&&0<a.length&&(b=!0);return b},_getDisplayNameOfCodedValues:function(a,b){var c=a;g.some(b.domain.codedValues,
function(b){return b.code===a?(c=b.name,!0):!1});return c},_onCbxAskValuesClicked:function(){this._updateRequiredProperty();this._updatePrompt()},_onCbxAskValuesStatusChanged:function(){this._updateRequiredProperty()},_isUseAskForValues:function(){return this.cbxAskValues.status&&this.cbxAskValues.checked},_isValueRequired:function(){return!this._isUseAskForValues()},_updateRequiredProperty:function(){var a=this._isValueRequired();this.stringTextBox.set("required",a);this.stringCodedValuesFS.set("required",
a);this.numberTextBox.set("required",a);this.numberTextBox1.set("required",a);this.numberTextBox2.set("required",a);this.numberCodedValuesFS.set("required",a);this.uniqueValuesSelect.set("required",a)},_updatePrompt:function(){this.promptTB.set("value","");this.hintTB.set("value","");this.cbxAskValues.setStatus(!0);c.setStyle(this.promptTable,"display","table");var a=this.operatorsSelect.get("value"),b=this.nls[a];this.fieldRadio.checked&&this.cbxAskValues.setStatus(!1);a===this.OPERATORS.stringOperatorIsBlank&&
this.cbxAskValues.setStatus(!1);a===this.OPERATORS.stringOperatorIsNotBlank&&this.cbxAskValues.setStatus(!1);a===this.OPERATORS.numberOperatorIsBlank&&this.cbxAskValues.setStatus(!1);a===this.OPERATORS.numberOperatorIsNotBlank&&this.cbxAskValues.setStatus(!1);a===this.OPERATORS.dateOperatorIsBlank&&this.cbxAskValues.setStatus(!1);a===this.OPERATORS.dateOperatorIsNotBlank&&this.cbxAskValues.setStatus(!1);if(this.cbxAskValues.status&&this.cbxAskValues.checked){c.setStyle(this.promptTable,"display",
"table");var e=this._getSelectedFilteringItem(this.fieldsSelect);e&&"none"!==a&&this.promptTB.set("value",(e.alias||e.name)+" "+b)}else c.setStyle(this.promptTable,"display","none")},_destroySelf:function(){this.destroy()}})})},"dijit/form/FilteringSelect":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/when","./MappedTextBox","./ComboBoxMixin"],function(l,n,t,q,k){return l("dijit.form.FilteringSelect",[q,k],{required:!0,_lastDisplayedValue:"",_isValidSubset:function(){return this._opened},
isValid:function(){return!!this.item||!this.required&&""==this.get("displayedValue")},_refreshState:function(){this.searchTimer||this.inherited(arguments)},_callbackSetLabel:function(e,c,g,b){c&&c[this.searchAttr]!==this._lastQuery||!c&&e.length&&this.store.getIdentity(e[0])!=this._lastQuery||(e.length?this.set("item",e[0],b):this.set("value","",b||void 0===b&&!this.focused,this.textbox.value,null))},_openResultList:function(e,c,g){c[this.searchAttr]===this._lastQuery&&(this.inherited(arguments),
void 0===this.item&&this.validate(!0))},_getValueAttr:function(){return this.valueNode.value},_getValueField:function(){return"value"},_setValueAttr:function(e,c,g,b){this._onChangeActive||(c=null);if(void 0===b){if(null===e||""===e)if(e="",!n.isString(g)){this._setDisplayedValueAttr(g||"",c);return}var f=this;this._lastQuery=e;t(this.store.get(e),function(b){f._callbackSetLabel(b?[b]:[],void 0,void 0,c)})}else this.valueNode.value=e,this.inherited(arguments,[e,c,g,b])},_setItemAttr:function(e,c,
g){this.inherited(arguments);this._lastDisplayedValue=this.textbox.value},_getDisplayQueryString:function(e){return e.replace(/([\\\*\?])/g,"\\$1")},_setDisplayedValueAttr:function(e,c){null==e&&(e="");if(!this._created){if(!("displayedValue"in this.params))return;c=!1}if(this.store){this.closeDropDown();var g=n.clone(this.query),b=this._getDisplayQueryString(e),f;this.store._oldAPI?f=b:(f=this._patternToRegExp(b),f.toString=function(){return b});this._lastQuery=g[this.searchAttr]=f;this._lastDisplayedValue=
this.textbox.value=e;this._set("displayedValue",e);var m=this,k={queryOptions:{ignoreCase:this.ignoreCase,deep:!0}};n.mixin(k,this.fetchProperties);this._fetchHandle=this.store.query(g,k);t(this._fetchHandle,function(b){m._fetchHandle=null;m._callbackSetLabel(b||[],g,k,c)},function(b){m._fetchHandle=null;m._cancelingQuery||console.error("dijit.form.FilteringSelect: "+b.toString())})}},undo:function(){this.set("displayedValue",this._lastDisplayedValue)}})})},"dijit/form/DateTextBox":function(){define(["dojo/_base/declare",
"../Calendar","./_DateTimeTextBox"],function(l,n,t){return l("dijit.form.DateTextBox",t,{baseClass:"dijitTextBox dijitComboBox dijitDateTextBox",popupClass:n,_selector:"date",maxHeight:Infinity,value:new Date("")})})},"dijit/Calendar":function(){define("dojo/_base/array dojo/date dojo/date/locale dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/sniff ./CalendarLite ./_Widget ./_CssStateMixin ./_TemplatedMixin ./form/DropDownButton".split(" "),
function(l,n,t,q,k,e,c,g,b,f,m,s,u,a,r,v,d){var p=q("dijit.Calendar",[u,a,r],{baseClass:"dijitCalendar",cssStateNodes:{decrementMonth:"dijitCalendarArrow",incrementMonth:"dijitCalendarArrow",previousYearLabelNode:"dijitCalendarPreviousYear",nextYearLabelNode:"dijitCalendarNextYear"},setValue:function(a){g.deprecated("dijit.Calendar:setValue() is deprecated.  Use set('value', ...) instead.","","2.0");this.set("value",a)},_createMonthWidget:function(){return new p._MonthDropDownButton({id:this.id+"_mddb",
tabIndex:-1,onMonthSelect:f.hitch(this,"_onMonthSelect"),lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},postCreate:function(){this.inherited(arguments);this.own(m(this.domNode,"keydown",f.hitch(this,"_onKeyDown")),m(this.dateRowsNode,"mouseover",f.hitch(this,"_onDayMouseOver")),m(this.dateRowsNode,"mouseout",f.hitch(this,"_onDayMouseOut")),m(this.dateRowsNode,"mousedown",f.hitch(this,"_onDayMouseDown")),m(this.dateRowsNode,"mouseup",f.hitch(this,"_onDayMouseUp")))},_onMonthSelect:function(a){var b=
new this.dateClassObj(this.currentFocus);b.setDate(1);b.setMonth(a);a=this.dateModule.getDaysInMonth(b);var d=this.currentFocus.getDate();b.setDate(Math.min(d,a));this._setCurrentFocusAttr(b)},_onDayMouseOver:function(a){if((a=e.contains(a.target,"dijitCalendarDateLabel")?a.target.parentNode:a.target)&&(a.dijitDateValue&&!e.contains(a,"dijitCalendarDisabledDate")||a==this.previousYearLabelNode||a==this.nextYearLabelNode))e.add(a,"dijitCalendarHoveredDate"),this._currentNode=a},_onDayMouseOut:function(a){this._currentNode&&
!(a.relatedTarget&&a.relatedTarget.parentNode==this._currentNode)&&(a="dijitCalendarHoveredDate",e.contains(this._currentNode,"dijitCalendarActiveDate")&&(a+=" dijitCalendarActiveDate"),e.remove(this._currentNode,a),this._currentNode=null)},_onDayMouseDown:function(a){if((a=a.target.parentNode)&&a.dijitDateValue&&!e.contains(a,"dijitCalendarDisabledDate"))e.add(a,"dijitCalendarActiveDate"),this._currentNode=a},_onDayMouseUp:function(a){(a=a.target.parentNode)&&a.dijitDateValue&&e.remove(a,"dijitCalendarActiveDate")},
handleKey:function(a){var d=-1,c,e=this.currentFocus;switch(a.keyCode){case b.RIGHT_ARROW:d=1;case b.LEFT_ARROW:c="day";this.isLeftToRight()||(d*=-1);break;case b.DOWN_ARROW:d=1;case b.UP_ARROW:c="week";break;case b.PAGE_DOWN:d=1;case b.PAGE_UP:c=a.ctrlKey||a.altKey?"year":"month";break;case b.END:e=this.dateModule.add(e,"month",1),c="day";case b.HOME:e=new this.dateClassObj(e);e.setDate(1);break;default:return!0}c&&(e=this.dateModule.add(e,c,d));this._setCurrentFocusAttr(e);return!1},_onKeyDown:function(a){this.handleKey(a)||
(a.stopPropagation(),a.preventDefault())},onValueSelected:function(){},onChange:function(a){this.onValueSelected(a)},getClassForDate:function(){}});p._MonthDropDownButton=q("dijit.Calendar._MonthDropDownButton",d,{onMonthSelect:function(){},postCreate:function(){this.inherited(arguments);this.dropDown=new p._MonthDropDown({id:this.id+"_mdd",onChange:this.onMonthSelect})},_setMonthAttr:function(a){var b=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a);this.dropDown.set("months",
b);this.containerNode.innerHTML=(6==s("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+this.dropDown.domNode.innerHTML+"\x3c/div\x3e")+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+b[a.getMonth()]+"\x3c/div\x3e"}});p._MonthDropDown=q("dijit.Calendar._MonthDropDown",[a,v,r],{months:[],baseClass:"dijitCalendarMonthMenu dijitMenu",templateString:"\x3cdiv data-dojo-attach-event\x3d'ondijitclick:_onClick'\x3e\x3c/div\x3e",_setMonthsAttr:function(a){this.domNode.innerHTML=
"";l.forEach(a,function(a,b){c.create("div",{className:"dijitCalendarMonthLabel",month:b,innerHTML:a},this.domNode)._cssState="dijitCalendarMonthLabel"},this)},_onClick:function(a){this.onChange(k.get(a.target,"month"))},onChange:function(){}});return p})},"dijit/CalendarLite":function(){define("dojo/_base/array dojo/_base/declare dojo/cldr/supplemental dojo/date dojo/date/locale dojo/date/stamp dojo/dom dojo/dom-class dojo/_base/lang dojo/on dojo/sniff dojo/string ./_WidgetBase ./_TemplatedMixin dojo/text!./templates/Calendar.html ./a11yclick ./hccss".split(" "),
function(l,n,t,q,k,e,c,g,b,f,m,s,u,a,r){var v=n("dijit.CalendarLite",[u,a],{templateString:r,dowTemplateString:'\x3cth class\x3d"dijitReset dijitCalendarDayLabelTemplate" role\x3d"columnheader" scope\x3d"col"\x3e\x3cspan class\x3d"dijitCalendarDayLabel"\x3e${d}\x3c/span\x3e\x3c/th\x3e',dateTemplateString:'\x3ctd class\x3d"dijitReset" role\x3d"gridcell" data-dojo-attach-point\x3d"dateCells"\x3e\x3cspan class\x3d"dijitCalendarDateLabel" data-dojo-attach-point\x3d"dateLabels"\x3e\x3c/span\x3e\x3c/td\x3e',
weekTemplateString:'\x3ctr class\x3d"dijitReset dijitCalendarWeekTemplate" role\x3d"row"\x3e${d}${d}${d}${d}${d}${d}${d}\x3c/tr\x3e',value:new Date(""),datePackage:"",dayWidth:"narrow",tabIndex:"0",currentFocus:new Date,_setSummaryAttr:"gridNode",baseClass:"dijitCalendar dijitCalendarLite",_isValidDate:function(a){return a&&!isNaN(a)&&"object"==typeof a&&a.toString()!=this.constructor.prototype.value.toString()},_getValueAttr:function(){var a=this._get("value");if(a&&!isNaN(a)){var b=new this.dateClassObj(a);
b.setHours(0,0,0,0);b.getDate()<a.getDate()&&(b=this.dateModule.add(b,"hour",1));return b}return null},_setValueAttr:function(a,b){"string"==typeof a&&(a=e.fromISOString(a));a=this._patchDate(a);if(this._isValidDate(a)&&!this.isDisabledDate(a,this.lang)){if(this._set("value",a),this.set("currentFocus",a),this._markSelectedDates([a]),this._created&&(b||"undefined"==typeof b))this.onChange(this.get("value"))}else this._set("value",null),this._markSelectedDates([])},_patchDate:function(a){a&&(a=new this.dateClassObj(a),
a.setHours(1,0,0,0));return a},_setText:function(a,b){for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(a.ownerDocument.createTextNode(b))},_populateGrid:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);var a=this._patchDate(a),b=a.getDay(),c=this.dateModule.getDaysInMonth(a),e=this.dateModule.getDaysInMonth(this.dateModule.add(a,"month",-1)),f=new this.dateClassObj,g=t.getFirstDayOfWeek(this.lang);g>b&&(g-=7);if(!this.summary){var m=this.dateLocaleModule.getNames("months",
"wide","standAlone",this.lang,a);this.gridNode.setAttribute("summary",m[a.getMonth()])}this._date2cell={};l.forEach(this.dateCells,function(m,k){var l=k+g,s=new this.dateClassObj(a),r="dijitCalendar",n=0;l<b?(l=e-b+l+1,n=-1,r+="Previous"):l>=b+c?(l=l-b-c+1,n=1,r+="Next"):(l=l-b+1,r+="Current");n&&(s=this.dateModule.add(s,"month",n));s.setDate(l);this.dateModule.compare(s,f,"date")||(r="dijitCalendarCurrentDate "+r);this.isDisabledDate(s,this.lang)?(r="dijitCalendarDisabledDate "+r,m.setAttribute("aria-disabled",
"true")):(r="dijitCalendarEnabledDate "+r,m.removeAttribute("aria-disabled"),m.setAttribute("aria-selected","false"));(n=this.getClassForDate(s,this.lang))&&(r=n+" "+r);m.className=r+"Month dijitCalendarDateTemplate";r=s.valueOf();this._date2cell[r]=m;m.dijitDateValue=r;this._setText(this.dateLabels[k],s.getDateLocalized?s.getDateLocalized(this.lang):s.getDate())},this)},_populateControls:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);this.monthWidget.set("month",a);var b=
a.getFullYear()-1,c=new this.dateClassObj;l.forEach(["previous","current","next"],function(a){c.setFullYear(b++);this._setText(this[a+"YearLabelNode"],this.dateLocaleModule.format(c,{selector:"year",locale:this.lang}))},this)},goToToday:function(){this.set("value",new this.dateClassObj)},constructor:function(a){this.dateModule=a.datePackage?b.getObject(a.datePackage,!1):q;this.dateClassObj=this.dateModule.Date||Date;this.dateLocaleModule=a.datePackage?b.getObject(a.datePackage+".locale",!1):k},_createMonthWidget:function(){return v._MonthWidget({id:this.id+
"_mddb",lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},buildRendering:function(){var a=this.dowTemplateString,b=this.dateLocaleModule.getNames("days",this.dayWidth,"standAlone",this.lang),e=t.getFirstDayOfWeek(this.lang);this.dayCellsHtml=s.substitute([a,a,a,a,a,a,a].join(""),{d:""},function(){return b[e++%7]});a=s.substitute(this.weekTemplateString,{d:this.dateTemplateString});this.dateRowsHtml=[a,a,a,a,a,a].join("");this.dateCells=[];this.dateLabels=[];this.inherited(arguments);
c.setSelectable(this.domNode,!1);a=new this.dateClassObj(this.currentFocus);this.monthWidget=this._createMonthWidget();this.set("currentFocus",a,!1)},postCreate:function(){this.inherited(arguments);this._connectControls()},_connectControls:function(){var a=b.hitch(this,function(a,d,c){this[a].dojoClick=!0;return f(this[a],"click",b.hitch(this,function(){this._setCurrentFocusAttr(this.dateModule.add(this.currentFocus,d,c))}))});this.own(a("incrementMonth","month",1),a("decrementMonth","month",-1),
a("nextYearLabelNode","year",1),a("previousYearLabelNode","year",-1))},_setCurrentFocusAttr:function(a,b){var c=this.currentFocus,e=this._getNodeByDate(c);a=this._patchDate(a);this._set("currentFocus",a);if(!this._date2cell||0!=this.dateModule.difference(c,a,"month"))this._populateGrid(),this._populateControls(),this._markSelectedDates([this.value]);c=this._getNodeByDate(a);c.setAttribute("tabIndex",this.tabIndex);(this.focused||b)&&c.focus();e&&e!=c&&(m("webkit")?e.setAttribute("tabIndex","-1"):
e.removeAttribute("tabIndex"))},focus:function(){this._setCurrentFocusAttr(this.currentFocus,!0)},_onDayClick:function(a){a.stopPropagation();a.preventDefault();for(a=a.target;a&&!a.dijitDateValue;a=a.parentNode);a&&!g.contains(a,"dijitCalendarDisabledDate")&&this.set("value",a.dijitDateValue)},_getNodeByDate:function(a){return(a=this._patchDate(a))&&this._date2cell?this._date2cell[a.valueOf()]:null},_markSelectedDates:function(a){function c(a,b){g.toggle(b,"dijitCalendarSelectedDate",a);b.setAttribute("aria-selected",
a?"true":"false")}l.forEach(this._selectedCells||[],b.partial(c,!1));this._selectedCells=l.filter(l.map(a,this._getNodeByDate,this),function(a){return a});l.forEach(this._selectedCells,b.partial(c,!0))},onChange:function(){},isDisabledDate:function(){},getClassForDate:function(){}});v._MonthWidget=n("dijit.CalendarLite._MonthWidget",u,{_setMonthAttr:function(a){var b=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a),c=6==m("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+l.map(b,
function(a){return"\x3cdiv\x3e"+a+"\x3c/div\x3e"}).join("")+"\x3c/div\x3e";this.domNode.innerHTML=c+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+b[a.getMonth()]+"\x3c/div\x3e"}});return v})},"dijit/form/_DateTimeTextBox":function(){define("dojo/date dojo/date/locale dojo/date/stamp dojo/_base/declare dojo/_base/lang ./RangeBoundTextBox ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),function(l,n,t,q,k,e,c,g){new Date("X");return q("dijit.form._DateTimeTextBox",
[e,c],{templateString:g,hasDownArrow:!0,cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_unboundedConstraints:{},pattern:n.regexp,datePackage:"",postMixInProperties:function(){this.inherited(arguments);this._set("type","text")},compare:function(b,c){var e=this._isInvalidDate(b),g=this._isInvalidDate(c);if(e||g)return e&&g?0:!e?1:-1;var e=this.format(b,this._unboundedConstraints),g=this.format(c,this._unboundedConstraints),k=this.parse(e,this._unboundedConstraints),a=this.parse(g,this._unboundedConstraints);
return e==g?0:l.compare(k,a,this._selector)},autoWidth:!0,format:function(b,c){return!b?"":this.dateLocaleModule.format(b,c)},parse:function(b,c){return this.dateLocaleModule.parse(b,c)||(this._isEmpty(b)?null:void 0)},serialize:function(b,c){b.toGregorian&&(b=b.toGregorian());return t.toISOString(b,c)},dropDownDefaultValue:new Date,value:new Date(""),_blankValue:null,popupClass:"",_selector:"",constructor:function(b){b=b||{};this.dateModule=b.datePackage?k.getObject(b.datePackage,!1):l;this.dateClassObj=
this.dateModule.Date||Date;this.dateClassObj instanceof Date||(this.value=new this.dateClassObj(this.value));this.dateLocaleModule=b.datePackage?k.getObject(b.datePackage+".locale",!1):n;this._set("pattern",this.dateLocaleModule.regexp);this._invalidDate=this.constructor.prototype.value.toString()},buildRendering:function(){this.inherited(arguments);this.hasDownArrow||(this._buttonNode.style.display="none");this.hasDownArrow||(this._buttonNode=this.domNode,this.baseClass+=" dijitComboBoxOpenOnClick")},
_setConstraintsAttr:function(b){b.selector=this._selector;b.fullYear=!0;var c=t.fromISOString;"string"==typeof b.min&&(b.min=c(b.min),this.dateClassObj instanceof Date||(b.min=new this.dateClassObj(b.min)));"string"==typeof b.max&&(b.max=c(b.max),this.dateClassObj instanceof Date||(b.max=new this.dateClassObj(b.max)));this.inherited(arguments);this._unboundedConstraints=k.mixin({},this.constraints,{min:null,max:null})},_isInvalidDate:function(b){return!b||isNaN(b)||"object"!=typeof b||b.toString()==
this._invalidDate},_setValueAttr:function(b,c,e){void 0!==b&&("string"==typeof b&&(b=t.fromISOString(b)),this._isInvalidDate(b)&&(b=null),b instanceof Date&&!(this.dateClassObj instanceof Date)&&(b=new this.dateClassObj(b)));this.inherited(arguments,[b,c,e]);this.value instanceof Date&&(this.filterString="");this.dropDown&&this.dropDown.set("value",b,!1)},_set:function(b,c){if("value"==b){c instanceof Date&&!(this.dateClassObj instanceof Date)&&(c=new this.dateClassObj(c));var e=this._get("value");
if(e instanceof this.dateClassObj&&0==this.compare(c,e))return}this.inherited(arguments)},_setDropDownDefaultValueAttr:function(b){this._isInvalidDate(b)&&(b=new this.dateClassObj);this._set("dropDownDefaultValue",b)},openDropDown:function(b){this.dropDown&&this.dropDown.destroy();var c=k.isString(this.popupClass)?k.getObject(this.popupClass,!1):this.popupClass,e=this,g=this.get("value");this.dropDown=new c({onChange:function(b){e.set("value",b,!0)},id:this.id+"_popup",dir:e.dir,lang:e.lang,value:g,
textDir:e.textDir,currentFocus:!this._isInvalidDate(g)?g:this.dropDownDefaultValue,constraints:e.constraints,filterString:e.filterString,datePackage:e.datePackage,isDisabledDate:function(b){return!e.rangeCheck(b,e.constraints)}});this.inherited(arguments)},_getDisplayedValueAttr:function(){return this.textbox.value},_setDisplayedValueAttr:function(b,c){this._setValueAttr(this.parse(b,this.constraints),c,b)}})})},"jimu/dijit/_FilterSet":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_FilterSet.html dijit/registry dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/aspect dojo/query ./_SingleFilter".split(" "),
function(l,n,t,q,k,e,c,g,b,f,m,s,u){return l([n,t,q],{templateString:k,baseClass:"jimu-filter-set",nls:null,url:null,layerInfo:null,stringFieldType:"",dateFieldType:"",numberFieldTypes:[],partsObj:null,OPERATORS:null,enableAskForValues:!1,isHosted:!1,postMixInProperties:function(){this.nls=window.jimuNls.filterBuilder;var a=this.nls.matchMsgSet.split("${any_or_all}");this.nls.strMatchMsgPart1=a[0]||"";this.nls.strMatchMsgPart2=a[1]||"";this.inherited(arguments)},postCreate:function(){this.inherited(arguments);
this._initSelf()},toJson:function(){var a=s(".jimu-single-filter",this.allExpsBox),a=b.map(a,c.hitch(this,function(a){return e.byNode(a).toJson()}));return b.every(a,c.hitch(this,function(a){return!!a}))&&0<a.length?{logicalOperator:this.allAnySelect.value,parts:a}:null},showDelteIcon:function(){g.setStyle(this.btnDelete,"display","block")},hideDeleteIcon:function(){g.setStyle(this.btnDelete,"display","none")},_initSelf:function(){this.own(f(this.btnAdd,"click",c.hitch(this,this._addSingleFilter)));
if(this.partsObj){this.allAnySelect.value=this.partsObj.logicalOperator;var a=this.partsObj.parts||[];0===a.length?(this._addSingleFilter(),this._addSingleFilter()):1===a.length?(this._addSingleFilter(a[0]),this._addSingleFilter()):b.forEach(a,c.hitch(this,function(a){this._addSingleFilter(a)}))}else this._addSingleFilter(),this._addSingleFilter()},_addSingleFilter:function(a){a=new u({url:this.url,layerInfo:this.layerInfo,stringFieldType:this.stringFieldType,dateFieldType:this.dateFieldType,numberFieldTypes:this.numberFieldTypes,
part:a,OPERATORS:this.OPERATORS,enableAskForValues:this.enableAskForValues,isHosted:this.isHosted,style:{margin:"15px auto 0 auto",border:0,background:"inherit"}});a.placeAt(this.allExpsBox);a.startup();this.own(m.after(a,"_destroySelf",c.hitch(this,this._checkFilterNumbers)));this._checkFilterNumbers()},_checkFilterNumbers:function(){var a=s(".jimu-single-filter",this.allExpsBox),f=2<a.length;b.forEach(a,c.hitch(this,function(a){a=e.byNode(a);f?a.showDelteIcon():a.hideDeleteIcon()}))},_destroySelf:function(){this.destroy()}})})},
"jimu/dijit/SymbolPicker":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query dijit/TooltipDialog dijit/popup dijit/registry jimu/dijit/SymbolChooser jimu/symbolUtils".split(" "),function(l,n,t,q,k,e,c,g,b,f,m,s,u,a){return l([n,t,q],{baseClass:"jimu-symbol-picker",declaredClass:"jimu.dijit.SymbolPicker",templateString:"\x3cdiv\x3e\x3c/div\x3e",tooltipDialog:null,_isTooltipDialogOpened:!1,symbol:null,
type:null,postCreate:function(){this.inherited(arguments);this._createTooltipDialog();this._hideTooltipDialog();var a=this.symbolChooser.getSymbol();a&&this._drawSymbol(a)},destroy:function(){this._hideTooltipDialog();this.symbolChooser&&this.symbolChooser.destroy();this.symbolChooser=null;this.inherited(arguments)},_createTooltipDialog:function(){var a=e.create("div");this.tooltipDialog=new f({content:a});this.symbolChooser=new u({symbol:this.symbol,type:this.type});this.symbolChooser.placeAt(a);
this.symbolChooser.startup();this.own(g(this.symbolChooser,"change",k.hitch(this,function(a){this._drawSymbol(a);this.emit("change",a)})));this.own(g(this.domNode,"click",k.hitch(this,function(a){a.stopPropagation();a.preventDefault();this._isTooltipDialogOpened?this._hideTooltipDialog():this._showTooltipDialog()})));this.own(g(document.body,"click",k.hitch(this,function(a){var b=a.target||a.srcElement;a=this._getColorPickers();0<a.length&&c.some(a,function(a){return a.isPartOfPopup(b)})||(a=this.tooltipDialog.domNode,
b===a||e.isDescendant(b,a)||this._hideTooltipDialog())})));this.own(g(this.symbolChooser,"resize",k.hitch(this,function(){this._isTooltipDialogOpened&&(this._hideTooltipDialog(),this._showTooltipDialog())})))},_getColorPickers:function(){var a=b(".jimu-color-picker",this.symbolChooser.domNode);return c.map(a,k.hitch(this,function(a){return s.byNode(a)}))},reset:function(){this.symbol=this.type=null;e.empty(this.domNode);this.symbolChooser.reset()},showBySymbol:function(a){this.reset();a&&(this._drawSymbol(a),
this.symbolChooser.showBySymbol(a))},showByType:function(a){this.reset();this.symbolChooser.showByType(a);(a=this.symbolChooser.getSymbol())&&this._drawSymbol(a)},getSymbol:function(){return this.symbolChooser.getSymbol()},_drawSymbol:function(b){e.empty(this.domNode);b&&(b=a.createSymbolNode(b))&&e.place(b,this.domNode)},_showTooltipDialog:function(){this.tooltipDialog&&(m.open({parent:this.getParent(),popup:this.tooltipDialog,around:this.domNode}),this._isTooltipDialogOpened=!0)},_hideTooltipDialog:function(){this.tooltipDialog&&
(m.close(this.tooltipDialog),this._isTooltipDialogOpened=!1)}})})},"widgets/Query/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:jimu/dijit/templates/QueryableLayerSource.html":'\x3cdiv\x3e\r\n\t\x3ctable class\x3d"radio-table" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd class\x3d"map-td" nowrap\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"mapRadio" type\x3d"radio" data-dojo-attach-event\x3d"onclick: _onRadioClicked" checked /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"mapLabel"\x3e${nls.selectFromMap}\x3c/label\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"portal-td" nowrap\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"portalRadio" type\x3d"radio" data-dojo-attach-event\x3d"onclick: _onRadioClicked" /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"portalLabel"\x3e${nls.selectFromPortal}\x3c/label\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"url-td" nowrap\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"urlRadio" type\x3d"radio" data-dojo-attach-event\x3d"onclick: _onRadioClicked" /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"urlLabel"\x3e${nls.addServiceUrl}\x3c/label\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv class\x3d"source-content"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"operationTip" class\x3d"operation-tip"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"mapDijitContainer" class\x3d"dijit-container map-dijit-container" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"portalDijitContainer" class\x3d"dijit-container portal-dijit-container" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"urlDijitContainer" class\x3d"dijit-container url-dijit-container" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"contentNode" class\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem" tabindex\x3d"-1" aria-selected\x3d"false"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation" style\x3d"display: none;"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"contentNode"\r\n\t\t\tclass\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem"\r\n\t\t\t\t   tabindex\x3d"-1" aria-selected\x3d"false" id\x3d"${id}_label"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\r\n\t\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation"\r\n\t\t style\x3d"display: none;" aria-labelledby\x3d"${id}_label"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/Tree.html":'\x3cdiv role\x3d"tree"\x3e\r\n\t\x3cdiv class\x3d"dijitInline dijitTreeIndent" style\x3d"position: absolute; top: -9999px" data-dojo-attach-point\x3d"indentDetector"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTreeExpando dijitTreeExpandoLoading" data-dojo-attach-point\x3d"rootLoadingIndicator"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeContainer" role\x3d"presentation"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:jimu/dijit/templates/QueryableServiceChooserFromPortal.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"selector-container" data-dojo-attach-point\x3d"selectorContainer"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"service-browser-container" data-dojo-attach-point\x3d"serviceBrowserContainer"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"footer"\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel" data-dojo-attach-point\x3d"btnCancel" data-dojo-attach-event\x3d"onclick:_onBtnCancelClicked"\x3e${nls.cancel}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing next jimu-state-disabled" data-dojo-attach-point\x3d"btnNext" data-dojo-attach-event\x3d"onclick:_onBtnNextClicked"\x3e${nls.next}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing ok jimu-state-disabled" data-dojo-attach-point\x3d"btnOk" data-dojo-attach-event\x3d"onclick:_onBtnOkClicked"\x3e${nls.ok}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing back" data-dojo-attach-point\x3d"btnBack" data-dojo-attach-event\x3d"onclick:_onBtnBackClicked"\x3e${nls.back}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/ItemSelector.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"setting-tab-container"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"tabNode"\x3e\x3c/div\x3e\r\n\t\t\r\n\t\t\x3cdiv class\x3d"tab-content mycontent-tab" data-dojo-attach-point\x3d"mycontentTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main mycontent-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onMyContentSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'style\x3d"top:50px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content organization-tab" data-dojo-attach-point\x3d"organizationTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main organization-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onOrganizationSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:50px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content group-tab" data-dojo-attach-point\x3d"groupTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main group-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"groups-section" style\x3d"position:absolute;width:100%;top:50px;" data-dojo-attach-point\x3d"groupsSection"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.groups}:\x3c/span\x3e\r\n\t\t\t\t\t\x3cselect class\x3d"groups-select" data-dojo-attach-point\x3d"groupsSelect"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"nodata"\x3e${nls.noneGroups}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onGroupSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:85px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content public-tab" data-dojo-attach-point\x3d"publicTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main public-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onPublicSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"public-search-radios"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"portalPublicRaido" type\x3d"radio" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading portal-public-radio" /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"portalPublicLabel" class\x3d"jimu-float-leading portal-public-label"\x3ePortal\x3c/label\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"onlinePublicRaido" type\x3d"radio" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading online-public-radio" /\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"onlinePublicLabel" class\x3d"jimu-float-leading online-public-label"\x3eArcGIS.com\x3c/label\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicItemSection" class\x3d"public-item-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicPortalItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicOnlineItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"signin-section" data-dojo-attach-point\x3d"signinSection" style\x3d"display:none;"\x3e\r\n\t\t\x3cdiv class\x3d"signin-tip"\x3e${nls.signInTip}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_ItemTable.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"items-section all-items-section" data-dojo-attach-point\x3d"allItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"allItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onAllItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"allItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"allItemTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"allItemsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"items-section filtered-items-section" data-dojo-attach-point\x3d"filteredItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"filteredItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onFilteredItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"filteredItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"filteredItemsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"search-none-tip-section" data-dojo-attach-point\x3d"searchNoneTipSection" style\x3d"display:none;"\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-icon jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-tip jimu-state-error-text"\x3e${nls.searchNone}\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"filteredItemShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_BasicServiceChooserContent.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"content-section"\x3e\r\n\t\t\x3ctable class\x3d"layout"\x3e\r\n\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\x3ccol width\x3d"80px" align\x3d"right"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"170px"\x3e\x3c/col\x3e\r\n\t\t\t\x3c/colgroup\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3eURL:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"urlInput" data-dojo-type\x3d"jimu/dijit/URLInput" style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"jimu-btn jimu-state-disabled validate-btn jimu-float-trailing" data-dojo-attach-point\x3d"btnValidate" data-dojo-attach-event\x3d"onclick:_onBtnValidateClick"\x3e${nls.validate}\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"exampleTr" class\x3d"example-tr"\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td" style\x3d"padding-top:5px;"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.example}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd data-dojo-attach-point\x3d"exampleTd" colspan\x3d"2" style\x3d"padding-top:5px;font-style:italic;color:#ccc;"\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\t\x3cdiv class\x3d"service-browser-container" data-dojo-attach-point\x3d"serviceBrowserContainer"\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"operations"\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel" data-dojo-attach-event\x3d"onclick:_onBtnCancelClick"\x3e${nls.cancel}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing jimu-state-disabled ok" data-dojo-attach-point\x3d"btnOk" data-dojo-attach-event\x3d"onclick:_onBtnOkClick"\x3e${nls.ok}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"loading" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Query/setting/SingleQuerySetting.html":'\x3cdiv\x3e\r\n\t\x3ctable data-dojo-attach-point\x3d"generalTable" class\x3d"general" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd class\x3d"first-td"\x3e${nls.querySource}\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"second-td"\x3e\r\n\t\t\t\t\t\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" style\x3d"width:100%;border-collapse:collapse;"\x3e\r\n\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:auto;"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"urlTextBox" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d\'required:true,trim:true,disabled:true\' style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:120px;"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-event\x3d"onclick:_onBtnSetSourceClicked" class\x3d"jimu-btn jimu-float-trailing"\x3e${nls.setSource}\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd class\x3d"first-td"\x3e${nls.queryName}\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"second-td"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"queryNameTextBox" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d\'required:true,trim:true\' style\x3d"width:100%;" data-dojo-attach-event\x3d"change:_onQueryNameChanged"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"detailSection" class\x3d"detail"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"definitionTabNode"\x3e\r\n\t\t\t\x3cdiv style\x3d"position:relative;width:100%;height:100%;" data-dojo-attach-point\x3d"filterDiv"\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"resultsTabNode"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"popupContainer" style\x3d"width:90%;"\x3e\x3c/div\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"symbolSection" class\x3d"symbol-section" style\x3d"margin-top:18px;"\x3e\r\n\t\t\t\t\x3cdiv style\x3d"margin-bottom:11px;"\x3e${nls.setLayerSymbolTip}\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"layerSymbolPicker" data-dojo-type\x3d"jimu/dijit/SymbolPicker"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Query/setting/PopupConfig.html":'\x3cdiv\x3e\r\n\t\x3cdiv style\x3d"margin-top:22px;font-size:12px;"\x3e${nls.resultSettingTip}\x3c/div\x3e\r\n\t\x3ctable class\x3d"title-sorting-table"\x3e\r\n\t\t\x3ccolgroup\x3e\r\n\t\t\t\x3ccol width\x3d"140px"\x3e\x3c/col\x3e\r\n\t\t\t\x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n\t\t\t\x3ccol width\x3d"24px"\x3e\x3c/col\x3e\r\n\t\t\x3c/colgroup\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.resultItemTitle}:\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"titleTextBox" data-dojo-type\x3d"dijit/form/ValidationTextBox"\r\n\t\t\t\t\tdata-dojo-props\x3d\'required:true,trim:true\' style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnAddFields" data-dojo-attach-event\x3d"onclick:_onAddClicked"\r\n\t\t\t\t\t  class\x3d"btn-add-fields jimu-icon jimu-icon-add jimu-float-trailing"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.resultItemSorting}:\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd data-dojo-attach-point\x3d"tdSortFields"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"sortFieldsDiv" class\x3d"sort-fields-div jimu-ellipsis"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnSortFields" class\x3d"btn-sort-fields jimu-float-trailing"\r\n\t\t\t\t\tdata-dojo-attach-event\x3d"onclick:_onBtnSortFieldsClicked"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv style\x3d"margin-top:10px;"\x3e${nls.resultItemContent}:\x3c/div\x3e\r\n\t\x3cdiv style\x3d"margin-top:7px;margin-bottom:8px;font-size:12px;"\x3e${nls.fieldsSetTip}\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"fieldsContainer"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Query/setting/SortFields.html":'\x3cdiv\x3e\r\n\t\x3cdiv\x3e${nls.configureFieldsTip}\x3c/div\x3e\r\n\t\x3cdiv class\x3d"add-with-icon" data-dojo-attach-event\x3d"onclick:_onAddNewClicked"\x3e\r\n\t\t\x3cspan class\x3d"jimu-icon jimu-icon-add"\x3e\x3c/span\x3e\r\n\t\t\x3cspan class\x3d"add-label"\x3e${nls.addNew}\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"tableDiv"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:jimu/dijit/templates/Filter.html":'\x3cdiv\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"contentSection" class\x3d"content-section"\x3e\r\n\t\t\x3cdiv class\x3d"add-btn-section"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnAddExp" data-dojo-attach-event\x3d"click:_onBtnAddExpClick"\r\n\t\t\t class\x3d"add-with-icon jimu-state-disabled add-expression jimu-float-leading"\x3e\r\n\t\t\t\t\x3cspan data-dojo-attach-point\x3d"iconAddExp" class\x3d"jimu-icon jimu-icon-add jimu-state-disabled"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan class\x3d"add-label"\x3e${nls.addAnotherExpression}\x3c/span\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnAddSet" data-dojo-attach-event\x3d"click:_onBtnAddSetClick"\r\n\t\t\t class\x3d"add-with-icon jimu-state-disabled add-set jimu-float-leading"\x3e\r\n\t\t\t\t\x3cspan data-dojo-attach-point\x3d"iconAddSet" class\x3d"jimu-icon jimu-icon-add jimu-state-disabled"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan class\x3d"add-label"\x3e${nls.addSet}\x3c/span\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"matchMsg" style\x3d"margin-top:11px;margin-bottom:11px;display:none;"\x3e\r\n\t\t\t\x3cspan\x3e${nls.strMatchMsgPart1}\x3c/span\x3e\r\n\t\t\t\x3cselect data-dojo-attach-point\x3d"allAnySelect"\x3e\r\n\t\t\t\t\x3coption value\x3d"AND" selected\x3e${nls.all}\x3c/option\x3e\r\n\t\t\t\t\x3coption value\x3d"OR"\x3e${nls.any}\x3c/option\x3e\r\n\t\t\t\x3c/select\x3e\r\n\t\t\t\x3cspan\x3e${nls.strMatchMsgPart2}\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\t\x3cdiv class\x3d"allExpsBox" data-dojo-attach-point\x3d"allExpsBox"\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"errorSection" style\x3d"display:none;"\x3e\r\n\t\t\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"errorTip" class\x3d"error-tip"\x3e\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"noFilterTipSection" class\x3d"no-filter-tip" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"loading" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_SingleFilter.html":'\x3cdiv\x3e\r\n\t\x3ctable class\x3d"setting-table" cellpadding\x3d"0" cellspacing\x3d"0" cellpadding\x3d"10px" style\x3d"table-layout:fixed;"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd class\x3d"fields-td" nowrap\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fieldsSelect" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-attach-event\x3d"change:_onFieldsSelectChange"  data-dojo-props\x3d\'searchAttr:"displayName",required:true,intermediateChanges:true\' class\x3d"dijit-form-FilteringSelect" style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"operators-td" nowrap\x3e\r\n\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"operatorsSelect" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-event\x3d"change:_onOperatorsSelectChange" style\x3d"width:100%;" class\x3d"dijit-form-Select"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"none"\x3e${nls.none}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"value-td" nowrap\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"attributeValueContainer" class\x3d"value-container"\x3e\r\n\t\t\t\t\t\t\x3cdiv\x3e\r\n\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"allValueBoxContainer" style\x3d"width:100%;"\x3e\r\n\t\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"stringTextBoxContainer" style\x3d"width:100%;"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"stringTextBox" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"required:true,trim:true" style\x3d"width:100%;" class\x3d"dijit-form-ValidationTextBox" /\x3e\r\n\r\n\t\t\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"stringCodedValuesFS" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"name",required:true,intermediateChanges:true\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"numberTextBoxContainer" style\x3d"display:none;"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"numberTextBox" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d\'"required":true,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' class\x3d"dijit-form-NumberTextBox" style\x3d"width:100%;" /\x3e\r\n\r\n\t\t\t\t\t\t\t\t\t\x3ctable data-dojo-attach-point\x3d"numberRangeTable" style\x3d"display:none;width:100%;border-collapse:collapse;table-layout:fixed;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"numberTextBox1" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d\'"required":true,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' class\x3d"dijit-form-NumberTextBox" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cspan\x3e${nls.and}\x3c/span\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"numberTextBox2" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d\'"required":true,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' class\x3d"dijit-form-NumberTextBox" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/table\x3e\r\n\r\n\t\t\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"numberCodedValuesFS" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"name",required:true,intermediateChanges:true\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"dateTextBoxContainer" style\x3d"display:none;"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"dateTextBox" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-props\x3d\'value:new Date(),required:true,trim:true\' class\x3d"dijit-form-DateTextBox" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\x3ctable data-dojo-attach-point\x3d"dateRangeTable" style\x3d"display:none;width:100%;border-collapse:collapse;table-layout:fixed;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"dateTextBox1" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-attach-event\x3d"change:_onRangeDateBlur" data-dojo-props\x3d\'value:new Date(),required:true,trim:true\' class\x3d"dijit-form-DateTextBox" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cspan\x3e${nls.and}\x3c/span\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"dateTextBox2" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-attach-event\x3d"change:_onRangeDateBlur" data-dojo-props\x3d\'value:new Date(),required:true,trim:true\' class\x3d"dijit-form-DateTextBox" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fieldsSelect2" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"name"\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;"\x3e\r\n\t\t\t\t\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"uniqueValuesSelect" data-dojo-type\x3d"dijit/form/FilteringSelect"  data-dojo-props\x3d\'searchAttr:"label"\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;"\x3e\r\n\t\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\t\t\t\x3cdiv class\x3d"radio-table-container"\x3e\r\n\t\t\t\t\t\t\t\x3ctable class\x3d"radio-table" cellpadding\x3d"0" cellspacing\x3d"0" style\x3d"table-layout:fixed;"\x3e\r\n\t\t\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cinput type\x3d"radio" data-dojo-attach-point\x3d"valueRadio" checked\x3d"true" disabled  title\x3d"${nls.valueTooltip}" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"valueLabel" title\x3d"${nls.valueTooltip}"\x3e${nls.value}\x3c/label\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cinput type\x3d"radio" data-dojo-attach-point\x3d"fieldRadio" disabled title\x3d"${nls.fieldTooltip}" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"fieldLabel" title\x3d"${nls.fieldTooltip}"\x3e${nls.field}\x3c/label\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd data-dojo-attach-point\x3d"uniqueTd"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cinput type\x3d"radio" data-dojo-attach-point\x3d"uniqueRadio" disabled title\x3d"${nls.uniqueValueTooltip}" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"uniqueLabel" title\x3d"${nls.uniqueValueTooltip}"\x3e${nls.unique}\x3c/label\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"delete-td" nowrap\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"jimu-icon jimu-icon-delete" data-dojo-attach-point\x3d"btnDelete"\r\n\t\t\t\t\t data-dojo-attach-event\x3d"click:_destroySelf"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv class\x3d"askvalues"\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"cbxAskValues" data-dojo-props\x3d\'label:"${nls.askForValues}"\' class\x3d"jimu-trailing-margin6"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"cbxCaseSensitive" data-dojo-props\x3d\'label:"${nls.caseSensitive}"\' style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"promptSection" class\x3d"prompt"\x3e\r\n\t\t\x3ctable data-dojo-attach-point\x3d"promptTable" cellpadding\x3d"0" cellspacing\x3d"0" class\x3d"prompt-table"\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.prompt}\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"second-td"\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"promptTB" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"required:true,trim:true" style\x3d"width:100%;" class\x3d"dijit-form-ValidationTextBox" \x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.hint}\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"second-td"\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"hintTB" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"trim:true" style\x3d"width:100%;" class\x3d"dijit-form-ValidationTextBox" \x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/Calendar.html":'\x3ctable cellspacing\x3d"0" cellpadding\x3d"0" class\x3d"dijitCalendarContainer" role\x3d"grid" aria-labelledby\x3d"${id}_mddb ${id}_year" data-dojo-attach-point\x3d"gridNode"\x3e\r\n\t\x3cthead\x3e\r\n\t\t\x3ctr class\x3d"dijitReset dijitCalendarMonthContainer" valign\x3d"top"\x3e\r\n\t\t\t\x3cth class\x3d\'dijitReset dijitCalendarArrow\' data-dojo-attach-point\x3d"decrementMonth" scope\x3d"col"\x3e\r\n\t\t\t\t\x3cspan class\x3d"dijitInline dijitCalendarIncrementControl dijitCalendarDecrease" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan data-dojo-attach-point\x3d"decreaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e-\x3c/span\x3e\r\n\t\t\t\x3c/th\x3e\r\n\t\t\t\x3cth class\x3d\'dijitReset\' colspan\x3d"5" scope\x3d"col"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"monthNode"\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/th\x3e\r\n\t\t\t\x3cth class\x3d\'dijitReset dijitCalendarArrow\' scope\x3d"col" data-dojo-attach-point\x3d"incrementMonth"\x3e\r\n\t\t\t\t\x3cspan class\x3d"dijitInline dijitCalendarIncrementControl dijitCalendarIncrease" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan data-dojo-attach-point\x3d"increaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e+\x3c/span\x3e\r\n\t\t\t\x3c/th\x3e\r\n\t\t\x3c/tr\x3e\r\n\t\t\x3ctr role\x3d"row"\x3e\r\n\t\t\t${!dayCellsHtml}\r\n\t\t\x3c/tr\x3e\r\n\t\x3c/thead\x3e\r\n\t\x3ctbody data-dojo-attach-point\x3d"dateRowsNode" data-dojo-attach-event\x3d"ondijitclick: _onDayClick" class\x3d"dijitReset dijitCalendarBodyContainer"\x3e\r\n\t\t\t${!dateRowsHtml}\r\n\t\x3c/tbody\x3e\r\n\t\x3ctfoot class\x3d"dijitReset dijitCalendarYearContainer"\x3e\r\n\t\t\x3ctr\x3e\r\n\t\t\t\x3ctd class\x3d\'dijitReset\' valign\x3d"top" colspan\x3d"7" role\x3d"presentation"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"dijitCalendarYearLabel"\x3e\r\n\t\t\t\t\t\x3cspan data-dojo-attach-point\x3d"previousYearLabelNode" class\x3d"dijitInline dijitCalendarPreviousYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\t\t\t\x3cspan data-dojo-attach-point\x3d"currentYearLabelNode" class\x3d"dijitInline dijitCalendarSelectedYear" role\x3d"button" id\x3d"${id}_year"\x3e\x3c/span\x3e\r\n\t\t\t\t\t\x3cspan data-dojo-attach-point\x3d"nextYearLabelNode" class\x3d"dijitInline dijitCalendarNextYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/td\x3e\r\n\t\t\x3c/tr\x3e\r\n\t\x3c/tfoot\x3e\r\n\x3c/table\x3e\r\n',
"url:jimu/dijit/templates/_FilterSet.html":'\x3cdiv\x3e\r\n\t\x3ctable class\x3d"header-table" cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cdiv\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.strMatchMsgPart1}\x3c/span\x3e\r\n\t\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"allAnySelect"\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"AND" selected\x3e${nls.all}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"OR"\x3e${nls.any}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.strMatchMsgPart2}\x3c/span\x3e\r\n\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:15px;padding-right:10px;"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnDelete" data-dojo-attach-event\x3d"onclick:_destroySelf"\r\n\t\t\t\t\t class\x3d"jimu-icon jimu-icon-delete"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:15px;padding-right:14px;"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnAdd" class\x3d"jimu-icon jimu-icon-add"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"allExpsBox"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Query/setting/Setting.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"query-list"\x3e\r\n\t\t\x3cdiv class\x3d"query-list-head" style\x3d"overflow:hidden;"\x3e\r\n\t\t\t\x3cdiv class\x3d"jimu-float-leading"\x3e${nls.queries}\x3c/div\x3e\r\n\t\t\t\x3cdiv class\x3d"jimu-float-trailing"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"add-with-icon" data-dojo-attach-event\x3d"onclick:_onAddNewClicked"\x3e\r\n\t\t\t\t\t\x3cspan class\x3d"jimu-icon jimu-icon-add"\x3e\x3c/span\x3e\r\n\t\t\t\t\t\x3cspan class\x3d"add-label"\x3e${nls.addNew}\x3c/span\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"query-list-content"\x3e\r\n\t\t\t\x3cdiv class\x3d"query-list-table" data-dojo-type\x3d"jimu/dijit/SimpleTable" data-dojo-attach-point\x3d"queryList" data-dojo-attach-event\x3d"row-delete:_onQueryItemRemoved,row-select:_onQueryItemSelected" data-dojo-props\x3d\'autoHeight:false,selectable:true,fields:[{name:"name",title:"${nls.name}",width:"auto",type:"text",editable:false},{name:"actions",title:"",width:"70px",type:"actions",actions:["up","down","delete"]}]\' style\x3d"height:100%;"\x3e\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"single-query-container" data-dojo-attach-point\x3d"singleQueryContainer"\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Query/setting/css/style.css":".jimu-widget-query-setting{margin:0; padding:0; font-size:15px; position: relative; width: 100%; height: 100%;}.jimu-widget-query-setting .query-list{position: absolute; top: 0; left: 0; width: 235px; height: 100%;}.jimu-widget-query-settingRtl .query-list{left: auto; right: 0;}.jimu-widget-query-setting .query-list-content{position: absolute; width: 100%; top: 50px; bottom: 5px;}.jimu-widget-query-setting .single-query-container{position: absolute; left: 265px; right: 0; height: 100%; overflow-y: auto;}.jimu-widget-query-settingRtl .single-query-container{left: 0; right: 265px;}.jimu-widget-single-query-setting{width: 100%;}.jimu-widget-single-query-setting table.general{width: 100%; border-collapse: collapse;}.jimu-widget-single-query-setting table.general\x3etbody\x3etr\x3etd{height: 40px;}.jimu-widget-single-query-setting table.general\x3etbody\x3etr\x3e.first-td{width: 100px;}.jimu-widget-single-query-setting table.general\x3etbody\x3etr\x3e.second-td{width: auto;}.jimu-widget-single-query-setting .detail{width: 100%; margin-top: 15px;}.jimu-widget-single-query-setting .detail .jimu-tab3\x3e.container-node\x3e.view{overflow: auto;}.jimu-widget-single-query-setting .tab-item-div{height: 30px; line-height: 30px;}.jimu-widget-single-query-setting .title-sorting-table{table-layout:fixed; width:100%;}.jimu-widget-single-query-setting .title-sorting-table \x3e tbody \x3e tr \x3e td{padding-top: 3px; padding-bottom: 3px;}.jimu-query-setting-popup-config .btn-add-fields{cursor: pointer;}.jimu-query-setting-popup-config .btn-sort-fields{width: 14px; height: 14px; background: center center no-repeat url(images/edit_disabled.png); cursor: default;}.jimu-query-setting-popup-config .btn-sort-fields.enabled{background: center center no-repeat url(images/edit_enabled.png); cursor: pointer;}.jimu-query-setting-popup-config .sort-fields-div{width: 100%; height: 30px; line-height: 30px; border: 1px solid #d2dae2; background-color: #e3ecf2; color: #7989a0; font-size: 14px;}.jimu-query-setting-popup-config .sort-fields-div span{float: left; display: inline-block; height: 30px; line-height: 30px;}.jimu-query-setting-popup-config .sort-arrow{width: 13px;}.jimu-query-setting-popup-config .sort-arrow.asc{background: center center no-repeat url(images/up_arrow.png);}.jimu-query-setting-popup-config .sort-arrow.desc{background: center center no-repeat url(images/down_arrow.png);}.jimu-query-setting-sort-fields .add-with-icon{margin-top: 4px;}.jimu-query-setting-sort-fields .sort-tip{display: inline-block;}",
"*now":function(l){l(['dojo/i18n!*preload*widgets/Query/setting/nls/Setting*["ar","cs","da","de","en","el","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/on dijit/_WidgetsInTemplateMixin jimu/BaseWidgetSetting jimu/dijit/_QueryableLayerSourcePopup jimu/utils jimu/filterUtils ./SingleQuerySetting jimu/dijit/SimpleTable jimu/dijit/TabContainer".split(" "),function(l,n,t,q,k,e,c,g,b,f){return l([e,k],{baseClass:"jimu-widget-query-setting",currentSQS:null,postMixInProperties:function(){this.inherited(arguments);this.config&&this._updateConfig()},_updateConfig:function(){this.config&&(this.config.queries&&
0<this.config.queries.length)&&t.forEach(this.config.queries,n.hitch(this,function(b){this._rebuildFilter(b.url,b.filter)}))},_rebuildFilter:function(c,e){try{if(e){delete e.expr;var f=new b;f.isHosted=g.isHostedService(c);f.getExprByFilterObj(e)}}catch(a){console.log(a)}},postCreate:function(){this.inherited(arguments);this.config&&this.setConfig(this.config)},setConfig:function(b){this.currentSQS&&this.currentSQS.destroy();this.currentSQS=null;this.queryList.clear();(b=(this.config=b)&&this.config.queries)&&
0<=b.length&&t.forEach(b,n.hitch(this,function(b,c){var a=this.queryList.addRow({name:b.name||""}).tr;a.singleConfig=n.clone(b);0===c&&this.queryList.selectRow(a)}))},getConfig:function(){if(this.currentSQS){var b=this.currentSQS.getConfig();if(b)this.currentSQS.tr.singleConfig=n.clone(b);else return!1}for(var b={queries:[]},c=this.queryList.getRows(),e=0;e<c.length;e++)b.queries.push(n.clone(c[e].singleConfig));this.config=n.clone(b);return b},_createSingleQuerySetting:function(b){this.currentSQS=
new f({map:this.map,nls:this.nls,config:b.singleConfig,tr:b,_layerDefinition:b._layerDefinition,appConfig:this.appConfig});this.currentSQS.placeAt(this.singleQueryContainer);this.own(q(this.currentSQS,"name-change",n.hitch(this,function(c){this.queryList.editRow(b,{name:c})})));this.own(q(this.currentSQS,"show-shelter",n.hitch(this,function(){this.shelter.show()})));this.own(q(this.currentSQS,"hide-shelter",n.hitch(this,function(){this.shelter.hide()})));this.currentSQS.setConfig(this.currentSQS.config);
return this.currentSQS},_onAddNewClicked:function(){if(this.currentSQS){var b=this.currentSQS.getConfig();if(b)this.currentSQS.tr.singleConfig=b;else return}var e=new c({titleLabel:this.nls.setDataSource,dijitArgs:{multiple:!1,createMapResponse:this.map.webMapResponse,portalUrl:this.appConfig.portalUrl,style:{height:"100%"}}});this.own(q(e,"ok",n.hitch(this,function(b){e.close();e=null;this.currentSQS&&(this.currentSQS.destroy(),this.currentSQS=null);var a=b.name||"",c=this.queryList.addRow({name:a});
c.success&&(this.queryList.selectRow(c.tr),this.currentSQS&&this.currentSQS.setNewLayerDefinition(b.name,b.url,b.definition,a))})));this.own(q(e,"cancel",n.hitch(this,function(){e.close();e=null})));e.startup()},_getSuitableQueryName:function(b){for(var c=b,e=this.queryList.getData(),e=t.map(e,n.hitch(this,function(a){return a.name})),a=2;0<=t.indexOf(e,c);)b+=" "+a,a++;return b},_onQueryItemRemoved:function(b){this.currentSQS&&this.currentSQS.tr===b&&(this.currentSQS.destroy(),this.currentSQS=null)},
_onQueryItemSelected:function(b){if(this.currentSQS){if(this.currentSQS.tr!==b){var c=this.currentSQS.getConfig();c?(this.currentSQS.tr.singleConfig=c,this.currentSQS.destroy(),this.currentSQS=null,this._createSingleQuerySetting(b)):this.queryList.selectRow(this.currentSQS.tr)}}else this._createSingleQuerySetting(b)}})});