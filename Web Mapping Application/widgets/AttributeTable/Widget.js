//>>built
require({cache:{"dijit/layout/TabContainer":function(){define(["dojo/_base/lang","dojo/_base/declare","./_TabContainerBase","./TabController","./ScrollingTabController"],function(m,f,n,r,l){return f("dijit.layout.TabContainer",n,{useMenu:!0,useSlider:!0,controllerWidget:"",_makeController:function(f){var d=this.baseClass+"-tabs"+(this.doLayout?"":" dijitTabNoLayout");return new ("string"==typeof this.controllerWidget?m.getObject(this.controllerWidget):this.controllerWidget)({id:this.id+"_tablist",
ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,textDir:this.textDir,tabPosition:this.tabPosition,doLayout:this.doLayout,containerId:this.id,"class":d,nested:this.nested,useMenu:this.useMenu,useSlider:this.useSlider,tabStripClass:this.tabStrip?this.baseClass+(this.tabStrip?"":"No")+"Strip":null},f)},postMixInProperties:function(){this.inherited(arguments);this.controllerWidget||(this.controllerWidget=("top"==this.tabPosition||"bottom"==this.tabPosition)&&!this.nested?l:r)}})})},"dijit/layout/_TabContainerBase":function(){define("dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style ./StackContainer ./utils ../registry ../_TemplatedMixin dojo/text!./templates/TabContainer.html".split(" "),
function(m,f,n,r,l,h,d,p,c){return m("dijit.layout._TabContainerBase",[l,p],{tabPosition:"top",baseClass:"dijitTabContainer",tabStrip:!1,nested:!1,templateString:c,postMixInProperties:function(){this.baseClass+=this.tabPosition.charAt(0).toUpperCase()+this.tabPosition.substr(1).replace(/-.*/,"");this.srcNodeRef&&r.set(this.srcNodeRef,"visibility","hidden");this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);this.tablist=this._makeController(this.tablistNode);this.doLayout||
f.add(this.domNode,"dijitTabContainerNoLayout");this.nested?(f.add(this.domNode,"dijitTabContainerNested"),f.add(this.tablist.containerNode,"dijitTabContainerTabListNested"),f.add(this.tablistSpacer,"dijitTabContainerSpacerNested"),f.add(this.containerNode,"dijitTabPaneWrapperNested")):f.add(this.domNode,"tabStrip-"+(this.tabStrip?"enabled":"disabled"))},_setupChild:function(k){f.add(k.domNode,"dijitTabPane");this.inherited(arguments)},startup:function(){this._started||(this.tablist.startup(),this.inherited(arguments))},
layout:function(){if(this._contentBox&&"undefined"!=typeof this._contentBox.l){var k=this.selectedChildWidget;if(this.doLayout){var c=this.tabPosition.replace(/-h/,"");this.tablist.region=c;c=[this.tablist,{domNode:this.tablistSpacer,region:c},{domNode:this.containerNode,region:"center"}];h.layoutChildren(this.domNode,this._contentBox,c);this._containerContentBox=h.marginBox2contentBox(this.containerNode,c[2]);k&&k.resize&&k.resize(this._containerContentBox)}else{if(this.tablist.resize){c=this.tablist.domNode.style;
c.width="0";var d=n.getContentBox(this.domNode).w;c.width="";this.tablist.resize({w:d})}k&&k.resize&&k.resize()}}},destroy:function(c){this.tablist&&this.tablist.destroy(c);this.inherited(arguments)},selectChild:function(c,f){this._focused&&(c=d.byId(c),this.tablist.pane2button(c.id).focus());return this.inherited(arguments)}})})},"dijit/layout/StackContainer":function(){define("dojo/_base/array dojo/cookie dojo/_base/declare dojo/dom-class dojo/dom-construct dojo/has dojo/_base/lang dojo/on dojo/ready dojo/topic dojo/when ../registry ../_WidgetBase ./_LayoutWidget".split(" "),
function(m,f,n,r,l,h,d,p,c,k,t,q,s,a){h("dijit-legacy-requires")&&c(0,function(){require(["dijit/layout/StackController"])});n=n("dijit.layout.StackContainer",a,{doLayout:!0,persist:!1,baseClass:"dijitStackContainer",buildRendering:function(){this.inherited(arguments);r.add(this.domNode,"dijitLayoutContainer")},postCreate:function(){this.inherited(arguments);this.own(p(this.domNode,"keydown",d.hitch(this,"_onKeyDown")))},startup:function(){if(!this._started){var b=this.getChildren();m.forEach(b,this._setupChild,
this);this.persist?this.selectedChildWidget=q.byId(f(this.id+"_selectedChild")):m.some(b,function(b){b.selected&&(this.selectedChildWidget=b);return b.selected},this);var a=this.selectedChildWidget;!a&&b[0]&&(a=this.selectedChildWidget=b[0],a.selected=!0);k.publish(this.id+"-startup",{children:b,selected:a,textDir:this.textDir});this.inherited(arguments)}},resize:function(){if(!this._hasBeenShown){this._hasBeenShown=!0;var b=this.selectedChildWidget;b&&this._showChild(b)}this.inherited(arguments)},
_setupChild:function(b){var a=b.domNode,g=l.place("\x3cdiv role\x3d'tabpanel' class\x3d'"+this.baseClass+"ChildWrapper dijitHidden'\x3e",b.domNode,"replace"),w=b["aria-label"]||b.title||b.label;w&&g.setAttribute("aria-label",w);l.place(a,g);b._wrapper=g;this.inherited(arguments);"none"==a.style.display&&(a.style.display="block");b.domNode.removeAttribute("title")},addChild:function(b,a){this.inherited(arguments);this._started&&(k.publish(this.id+"-addChild",b,a),this.layout(),this.selectedChildWidget||
this.selectChild(b))},removeChild:function(b){var a=m.indexOf(this.getChildren(),b);this.inherited(arguments);l.destroy(b._wrapper);delete b._wrapper;this._started&&k.publish(this.id+"-removeChild",b);if(!this._descendantsBeingDestroyed){if(this.selectedChildWidget===b&&(this.selectedChildWidget=void 0,this._started)){var g=this.getChildren();g.length&&this.selectChild(g[Math.max(a-1,0)])}this._started&&this.layout()}},selectChild:function(b,a){var g;b=q.byId(b);this.selectedChildWidget!=b&&(g=this._transition(b,
this.selectedChildWidget,a),this._set("selectedChildWidget",b),k.publish(this.id+"-selectChild",b),this.persist&&f(this.id+"_selectedChild",this.selectedChildWidget.id));return t(g||!0)},_transition:function(b,a){a&&this._hideChild(a);var g=this._showChild(b);b.resize&&(this.doLayout?b.resize(this._containerContentBox||this._contentBox):b.resize());return g},_adjacent:function(b){var a=this.getChildren(),g=m.indexOf(a,this.selectedChildWidget),g=g+(b?1:a.length-1);return a[g%a.length]},forward:function(){return this.selectChild(this._adjacent(!0),
!0)},back:function(){return this.selectChild(this._adjacent(!1),!0)},_onKeyDown:function(b){k.publish(this.id+"-containerKeyDown",{e:b,page:this})},layout:function(){var b=this.selectedChildWidget;b&&b.resize&&(this.doLayout?b.resize(this._containerContentBox||this._contentBox):b.resize())},_showChild:function(b){var a=this.getChildren();b.isFirstChild=b==a[0];b.isLastChild=b==a[a.length-1];b._set("selected",!0);b._wrapper&&r.replace(b._wrapper,"dijitVisible","dijitHidden");return b._onShow&&b._onShow()||
!0},_hideChild:function(b){b._set("selected",!1);b._wrapper&&r.replace(b._wrapper,"dijitHidden","dijitVisible");b.onHide&&b.onHide()},closeChild:function(b){b.onClose&&b.onClose(this,b)&&(this.removeChild(b),b.destroyRecursive())},destroyDescendants:function(b){this._descendantsBeingDestroyed=!0;this.selectedChildWidget=void 0;m.forEach(this.getChildren(),function(a){b||this.removeChild(a);a.destroyRecursive(b)},this);this._descendantsBeingDestroyed=!1}});n.ChildWidgetProperties={selected:!1,disabled:!1,
closable:!1,iconClass:"dijitNoIcon",showTitle:!0};d.extend(s,n.ChildWidgetProperties);return n})},"dijit/layout/TabController":function(){define("dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/has dojo/i18n dojo/_base/lang ./StackController ../registry ../Menu ../MenuItem dojo/text!./templates/_TabButton.html dojo/i18n!../nls/common".split(" "),function(m,f,n,r,l,h,d,p,c,k,t,q){q=m("dijit.layout._TabButton"+(l("dojo-bidi")?"_NoBidi":""),p.StackButton,{baseClass:"dijitTab",cssStateNodes:{closeNode:"dijitTabCloseButton"},
templateString:q,_setNameAttr:"focusNode",scrollOnFocus:!1,buildRendering:function(){this.inherited(arguments);f.setSelectable(this.containerNode,!1)},startup:function(){this.inherited(arguments);var c=this.domNode;this.defer(function(){c.className=c.className},1)},_setCloseButtonAttr:function(c){this._set("closeButton",c);r.toggle(this.domNode,"dijitClosable",c);this.closeNode.style.display=c?"":"none";c&&(c=h.getLocalization("dijit","common"),this.closeNode&&n.set(this.closeNode,"title",c.itemClose))},
_setDisabledAttr:function(c){this.inherited(arguments);if(this.closeNode)if(c)n.remove(this.closeNode,"title");else{var a=h.getLocalization("dijit","common");n.set(this.closeNode,"title",a.itemClose)}},_setLabelAttr:function(c){this.inherited(arguments);!this.showLabel&&!this.params.title&&(this.iconNode.alt=d.trim(this.containerNode.innerText||this.containerNode.textContent||""))}});l("dojo-bidi")&&(q=m("dijit.layout._TabButton",q,{_setLabelAttr:function(c){this.inherited(arguments);this.applyTextDir(this.iconNode,
this.iconNode.alt)}}));m=m("dijit.layout.TabController",p,{baseClass:"dijitTabController",templateString:"\x3cdiv role\x3d'tablist' data-dojo-attach-event\x3d'onkeydown:onkeydown'\x3e\x3c/div\x3e",tabPosition:"top",buttonWidget:q,buttonWidgetCloseClass:"dijitTabCloseButton",postCreate:function(){this.inherited(arguments);var d=new k({id:this.id+"_Menu",ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,textDir:this.textDir,targetNodeIds:[this.domNode],selector:function(b){return r.contains(b,
"dijitClosable")&&!r.contains(b,"dijitTabDisabled")}});this.own(d);var a=h.getLocalization("dijit","common"),b=this;d.addChild(new t({label:a.itemClose,ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,textDir:this.textDir,onClick:function(a){a=c.byNode(this.getParent().currentTarget);b.onCloseButtonClick(a.page)}}))}});m.TabButton=q;return m})},"dijit/layout/StackController":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-construct dojo/keys dojo/_base/lang dojo/on dojo/topic ../focus ../registry ../_Widget ../_TemplatedMixin ../_Container ../form/ToggleButton dojo/touch".split(" "),
function(m,f,n,r,l,h,d,p,c,k,t,q,s,a){r=f("dijit.layout._StackButton",a,{tabIndex:"-1",closeButton:!1,_aria_attr:"aria-selected",buildRendering:function(b){this.inherited(arguments);(this.focusNode||this.domNode).setAttribute("role","tab")}});f=f("dijit.layout.StackController",[t,q,s],{baseClass:"dijitStackController",templateString:"\x3cspan role\x3d'tablist' data-dojo-attach-event\x3d'onkeydown'\x3e\x3c/span\x3e",containerId:"",buttonWidget:r,buttonWidgetCloseClass:"dijitStackCloseButton",pane2button:function(b){return k.byId(this.id+
"_"+b)},postCreate:function(){this.inherited(arguments);this.own(p.subscribe(this.containerId+"-startup",h.hitch(this,"onStartup")),p.subscribe(this.containerId+"-addChild",h.hitch(this,"onAddChild")),p.subscribe(this.containerId+"-removeChild",h.hitch(this,"onRemoveChild")),p.subscribe(this.containerId+"-selectChild",h.hitch(this,"onSelectChild")),p.subscribe(this.containerId+"-containerKeyDown",h.hitch(this,"onContainerKeyDown")));this.containerNode.dojoClick=!0;this.own(d(this.containerNode,"click",
h.hitch(this,function(b){var a=k.getEnclosingWidget(b.target);if(a!=this.containerNode&&!a.disabled&&a.page)for(b=b.target;b!==this.containerNode;b=b.parentNode)if(n.contains(b,this.buttonWidgetCloseClass)){this.onCloseButtonClick(a.page);break}else if(b==a.domNode){this.onButtonClick(a.page);break}})))},onStartup:function(b){this.textDir=b.textDir;m.forEach(b.children,this.onAddChild,this);if(b.selected)this.onSelectChild(b.selected);var a=k.byId(this.containerId).containerNode,g=h.hitch(this,"pane2button");
b={title:"label",showtitle:"showLabel",iconclass:"iconClass",closable:"closeButton",tooltip:"title",disabled:"disabled",textdir:"textdir"};var w=function(b,v){return d(a,"attrmodified-"+b,function(b){var a=g(b.detail&&b.detail.widget&&b.detail.widget.id);a&&a.set(v,b.detail.newValue)})},v;for(v in b)this.own(w(v,b[v]))},destroy:function(b){this.destroyDescendants(b);this.inherited(arguments)},onAddChild:function(b,a){var g=new (h.isString(this.buttonWidget)?h.getObject(this.buttonWidget):this.buttonWidget)({id:this.id+
"_"+b.id,name:this.id+"_"+b.id,label:b.title,disabled:b.disabled,ownerDocument:this.ownerDocument,dir:b.dir,lang:b.lang,textDir:b.textDir||this.textDir,showLabel:b.showTitle,iconClass:b.iconClass,closeButton:b.closable,title:b.tooltip,page:b});this.addChild(g,a);b.controlButton=g;if(!this._currentChild)this.onSelectChild(b);g=b._wrapper.getAttribute("aria-labelledby")?b._wrapper.getAttribute("aria-labelledby")+" "+g.id:g.id;b._wrapper.removeAttribute("aria-label");b._wrapper.setAttribute("aria-labelledby",
g)},onRemoveChild:function(b){this._currentChild===b&&(this._currentChild=null);var a=this.pane2button(b.id);a&&(this.removeChild(a),a.destroy());delete b.controlButton},onSelectChild:function(b){if(b){if(this._currentChild){var a=this.pane2button(this._currentChild.id);a.set("checked",!1);a.focusNode.setAttribute("tabIndex","-1")}a=this.pane2button(b.id);a.set("checked",!0);this._currentChild=b;a.focusNode.setAttribute("tabIndex","0");k.byId(this.containerId)}},onButtonClick:function(a){var e=this.pane2button(a.id);
c.focus(e.focusNode);this._currentChild&&this._currentChild.id===a.id&&e.set("checked",!0);k.byId(this.containerId).selectChild(a)},onCloseButtonClick:function(a){k.byId(this.containerId).closeChild(a);this._currentChild&&(a=this.pane2button(this._currentChild.id))&&c.focus(a.focusNode||a.domNode)},adjacent:function(a){if(!this.isLeftToRight()&&(!this.tabPosition||/top|bottom/.test(this.tabPosition)))a=!a;var e=this.getChildren(),g=m.indexOf(e,this.pane2button(this._currentChild.id)),w=e[g],v;do g=
(g+(a?1:e.length-1))%e.length,v=e[g];while(v.disabled&&v!=w);return v},onkeydown:function(a,e){if(!this.disabled&&!a.altKey){var g=null;if(a.ctrlKey||!a._djpage){switch(a.keyCode){case l.LEFT_ARROW:case l.UP_ARROW:a._djpage||(g=!1);break;case l.PAGE_UP:a.ctrlKey&&(g=!1);break;case l.RIGHT_ARROW:case l.DOWN_ARROW:a._djpage||(g=!0);break;case l.PAGE_DOWN:a.ctrlKey&&(g=!0);break;case l.HOME:for(var w=this.getChildren(),v=0;v<w.length;v++){var c=w[v];if(!c.disabled){this.onButtonClick(c.page);break}}a.stopPropagation();
a.preventDefault();break;case l.END:w=this.getChildren();for(v=w.length-1;0<=v;v--)if(c=w[v],!c.disabled){this.onButtonClick(c.page);break}a.stopPropagation();a.preventDefault();break;case l.DELETE:case 87:if(this._currentChild.closable&&(a.keyCode==l.DELETE||a.ctrlKey))this.onCloseButtonClick(this._currentChild),a.stopPropagation(),a.preventDefault();break;case l.TAB:a.ctrlKey&&(this.onButtonClick(this.adjacent(!a.shiftKey).page),a.stopPropagation(),a.preventDefault())}null!==g&&(this.onButtonClick(this.adjacent(g).page),
a.stopPropagation(),a.preventDefault())}}},onContainerKeyDown:function(a){a.e._djpage=a.page;this.onkeydown(a.e)}});f.StackButton=r;return f})},"dijit/layout/ScrollingTabController":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/fx dojo/_base/lang dojo/on dojo/query dojo/sniff ../registry dojo/text!./templates/ScrollingTabController.html dojo/text!./templates/_ScrollingTabControllerButton.html ./TabController ./utils ../_WidgetsInTemplateMixin ../Menu ../MenuItem ../form/Button ../_HasDropDown dojo/NodeList-dom ../a11yclick".split(" "),
function(m,f,n,r,l,h,d,p,c,k,t,q,s,a,b,e,g,w,v,G){q=f("dijit.layout.ScrollingTabController",[a,e],{baseClass:"dijitTabController dijitScrollingTabController",templateString:q,useMenu:!0,useSlider:!0,tabStripClass:"",_minScroll:5,_setClassAttr:{node:"containerNode",type:"class"},buildRendering:function(){this.inherited(arguments);var a=this.domNode;this.scrollNode=this.tablistWrapper;this._initButtons();this.tabStripClass||(this.tabStripClass="dijitTabContainer"+this.tabPosition.charAt(0).toUpperCase()+
this.tabPosition.substr(1).replace(/-.*/,"")+"None",n.add(a,"tabStrip-disabled"));n.add(this.tablistWrapper,this.tabStripClass)},onStartup:function(){this.inherited(arguments);l.set(this.domNode,"visibility","");this._postStartup=!0;this.own(p(this.containerNode,"attrmodified-label, attrmodified-iconclass",d.hitch(this,function(a){this._dim&&this.resize(this._dim)})))},onAddChild:function(a,b){this.inherited(arguments);l.set(this.containerNode,"width",l.get(this.containerNode,"width")+200+"px")},
onRemoveChild:function(a,b){var g=this.pane2button(a.id);this._selectedTab===g.domNode&&(this._selectedTab=null);this.inherited(arguments)},_initButtons:function(){this._btnWidth=0;this._buttons=c("\x3e .tabStripButton",this.domNode).filter(function(a){if(this.useMenu&&a==this._menuBtn.domNode||this.useSlider&&(a==this._rightBtn.domNode||a==this._leftBtn.domNode))return this._btnWidth+=r.getMarginSize(a).w,!0;l.set(a,"display","none");return!1},this)},_getTabsWidth:function(){var a=this.getChildren();
if(a.length){var b=a[this.isLeftToRight()?0:a.length-1].domNode,a=a[this.isLeftToRight()?a.length-1:0].domNode;return a.offsetLeft+a.offsetWidth-b.offsetLeft}return 0},_enableBtn:function(a){var b=this._getTabsWidth();a=a||l.get(this.scrollNode,"width");return 0<b&&a<b},resize:function(a){this._dim=a;this.scrollNode.style.height="auto";var g=this._contentBox=b.marginBox2contentBox(this.domNode,{h:0,w:a.w});g.h=this.scrollNode.offsetHeight;r.setContentSize(this.domNode,g);g=this._enableBtn(this._contentBox.w);
this._buttons.style("display",g?"":"none");this._leftBtn.region="left";this._rightBtn.region="right";this._menuBtn.region=this.isLeftToRight()?"right":"left";b.layoutChildren(this.domNode,this._contentBox,[this._menuBtn,this._leftBtn,this._rightBtn,{domNode:this.scrollNode,region:"center"}]);this._selectedTab&&(this._anim&&"playing"==this._anim.status()&&this._anim.stop(),this.scrollNode.scrollLeft=this._convertToScrollLeft(this._getScrollForSelectedTab()));this._setButtonClass(this._getScroll());
this._postResize=!0;return{h:this._contentBox.h,w:a.w}},_getScroll:function(){return this.isLeftToRight()||8>k("ie")||k("ie")&&k("quirks")||k("webkit")?this.scrollNode.scrollLeft:l.get(this.containerNode,"width")-l.get(this.scrollNode,"width")+(8<=k("ie")?-1:1)*this.scrollNode.scrollLeft},_convertToScrollLeft:function(a){if(this.isLeftToRight()||8>k("ie")||k("ie")&&k("quirks")||k("webkit"))return a;var b=l.get(this.containerNode,"width")-l.get(this.scrollNode,"width");return(8<=k("ie")?-1:1)*(a-b)},
onSelectChild:function(a){var b=this.pane2button(a.id);if(b){b=b.domNode;if(b!=this._selectedTab&&(this._selectedTab=b,this._postResize)){var g=this._getScroll();(g>b.offsetLeft||g+l.get(this.scrollNode,"width")<b.offsetLeft+l.get(b,"width"))&&this.createSmoothScroll().play()}this.inherited(arguments)}},_getScrollBounds:function(){var a=this.getChildren(),b=l.get(this.scrollNode,"width"),g=l.get(this.containerNode,"width")-b,e=this._getTabsWidth();if(a.length&&e>b)return{min:this.isLeftToRight()?
0:a[a.length-1].domNode.offsetLeft,max:this.isLeftToRight()?a[a.length-1].domNode.offsetLeft+a[a.length-1].domNode.offsetWidth-b:g};a=this.isLeftToRight()?0:g;return{min:a,max:a}},_getScrollForSelectedTab:function(){var a=this._selectedTab,b=l.get(this.scrollNode,"width"),g=this._getScrollBounds(),a=a.offsetLeft+l.get(a,"width")/2-b/2;return a=Math.min(Math.max(a,g.min),g.max)},createSmoothScroll:function(a){if(0<arguments.length){var b=this._getScrollBounds();a=Math.min(Math.max(a,b.min),b.max)}else a=
this._getScrollForSelectedTab();this._anim&&"playing"==this._anim.status()&&this._anim.stop();var g=this,e=this.scrollNode,v=new h.Animation({beforeBegin:function(){this.curve&&delete this.curve;var b=e.scrollLeft,w=g._convertToScrollLeft(a);v.curve=new h._Line(b,w)},onAnimate:function(a){e.scrollLeft=a}});this._anim=v;this._setButtonClass(a);return v},_getBtnNode:function(a){for(a=a.target;a&&!n.contains(a,"tabStripButton");)a=a.parentNode;return a},doSlideRight:function(a){this.doSlide(1,this._getBtnNode(a))},
doSlideLeft:function(a){this.doSlide(-1,this._getBtnNode(a))},doSlide:function(a,b){if(!b||!n.contains(b,"dijitTabDisabled")){var g=0.75*l.get(this.scrollNode,"width")*a,g=this._getScroll()+g;this._setButtonClass(g);this.createSmoothScroll(g).play()}},_setButtonClass:function(a){var b=this._getScrollBounds();this._leftBtn.set("disabled",a<=b.min);this._rightBtn.set("disabled",a>=b.max)}});s=f("dijit.layout._ScrollingTabControllerButtonMixin",null,{baseClass:"dijitTab tabStripButton",templateString:s,
tabIndex:"",isFocusable:function(){return!1}});f("dijit.layout._ScrollingTabControllerButton",[v,s]);f("dijit.layout._ScrollingTabControllerMenuButton",[v,G,s],{containerId:"",tabIndex:"-1",isLoaded:function(){return!1},loadDropDown:function(a){this.dropDown=new g({id:this.containerId+"_menu",ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,textDir:this.textDir});var b=t.byId(this.containerId);m.forEach(b.getChildren(),function(a){var g=new w({id:a.id+"_stcMi",label:a.title,iconClass:a.iconClass,
disabled:a.disabled,ownerDocument:this.ownerDocument,dir:a.dir,lang:a.lang,textDir:a.textDir||b.textDir,onClick:function(){b.selectChild(a)}});this.dropDown.addChild(g)},this);a()},closeDropDown:function(a){this.inherited(arguments);this.dropDown&&(this._popupStateNode.removeAttribute("aria-owns"),this.dropDown.destroyRecursive(),delete this.dropDown)}});return q})},"jimu/dijit/Filter":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/Filter.html jimu/filterUtils jimu/utils dijit/registry dojo/_base/lang dojo/_base/html dojo/_base/array dojo/aspect dojo/query dojo/Deferred esri/request ./_SingleFilter ./_FilterSet ./LoadingIndicator".split(" "),
function(m,f,n,r,l,h,d,p,c,k,t,q,s,a,b,e,g){return m([f,n,r,h],{templateString:l,baseClass:"jimu-filter",declaredClass:"jimu.dijit.Filter",nls:null,_validOptions:!1,_layerDefinition:null,_def:null,noFilterTip:"",enableAskForValues:!1,postMixInProperties:function(){this.nls=window.jimuNls.filterBuilder;var a=this.nls.matchMsg.split("${any_or_all}");this.nls.strMatchMsgPart1=a[0]||"";this.nls.strMatchMsgPart2=a[1]||"";this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this.noFilterTip&&
"string"===typeof this.noFilterTip&&(this.noFilterTipSection.innerHTML=this.noFilterTip)},reset:function(){this.isBuilding()||(this.removeAllFilters(),this.url=null,this.isHosted=!1,this.partsObj=this.expr=this._layerDefinition=null)},isBuilding:function(){return this._def&&!this._def.isFulfilled()},buildByExpr:function(b,g,e){var c=new a;this.isBuilding()?c.reject("Filter is already building."):(this._def=null,this.reset(),this.url=b,this.isHosted=d.isHostedService(this.url),this.expr=g||"1\x3d1",
this._layerDefinition=e,c=this._def=this._init("expr"));return c},buildByFilterObj:function(b,g,e){var c=new a;this.isBuilding()?c.reject("Filter is already building."):(this._def=null,this.reset(),this.url=b,this.isHosted=d.isHostedService(this.url),this.partsObj=g,this._layerDefinition=e,c=this._def=this._init("partsObj"));return c},removeAllFilters:function(){this._destroyAllFilters()},_validateLayerDefinition:function(a){return this._isObject(a)},_init:function(g){var e=new a;if(!this._isString(this.url))return e.reject(),
e;var d=c.hitch(this,function(){setTimeout(c.hitch(this,function(){e.resolve()}),1500)}),f=c.hitch(this,function(){k.setStyle(this.contentSection,"display","block");k.setStyle(this.errorSection,"display","none");this.removeAllFilters();var a=this._layerDefinition.fields;a&&0<a.length?(a=t.filter(a,c.hitch(this,function(a){return 0<=this._supportFieldTypes.indexOf(a.type)})))&&0<a.length?(this._validOptions=!0,k.removeClass(this.btnAddSet,"jimu-state-disabled"),k.removeClass(this.btnAddExp,"jimu-state-disabled"),
k.removeClass(this.iconAddExp,"jimu-state-disabled"),k.removeClass(this.iconAddSet,"jimu-state-disabled"),this.createFieldsStore(),"expr"===g?this._isString(this.expr)?("1\x3d1"===this.expr.replace(/\s/gi,"")&&this.removeAllFilters(),this._parseExpr(this.expr)?d():e.reject()):e.reject():"partsObj"===g?this._validatePartsObj(this.partsObj)?(this._parsePartsObj(this.partsObj),d()):e.reject():this._validatePartsObj(this.partsObj)?(this._parsePartsObj(this.partsObj),d()):this._isString(this.expr)?this._parseExpr(this.expr)?
d():e.reject():(this.removeAllFilters(),d())):(this._showErrorOptions(this.nls.error.noFilterFields),e.reject()):e.reject()});this._validateLayerDefinition(this._layerDefinition)?f():(this.loading.show(),b({url:this.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(c.hitch(this,function(a){this.domNode?(this.loading.hide(),this._layerDefinition=a,f()):e.reject()}),c.hitch(this,function(a){console.error(a);e.reject();this.domNode&&this.loading.hide()})));return e},toJson:function(){var a=
{logicalOperator:this.allAnySelect.value,parts:[]},b=this._getAllSingleFiltersAndFilterSets();if(0===b.length)return a.expr="1\x3d1",a;t.forEach(b,c.hitch(this,function(b){b=b.toJson();a.parts.push(b)}));return t.every(a.parts,c.hitch(this,function(a){return!!a}))&&0<a.parts.length?(a.expr=this.getExprByFilterObj(a),a):null},createFieldsStore:function(){if(!this._layerDefinition.fields||0===this._layerDefinition.fields.length)this._showErrorOptions(this.nls.error.noFilterFields);else{var a=c.clone(this._layerDefinition).fields;
0===this.setFieldsStoreByFieldInfos(a)&&this._showErrorOptions(this.nls.error.noFilterFields)}},_parsePartsObj:function(a){this._validatePartsObj(a)&&(this.removeAllFilters(),this._buildEditUIByPartsObj(a))},_parseExpr:function(a){this._destroyAllFilters();var b=null;if(!this._validateLayerDefinition(this._layerDefinition))return b;if(!a||"string"!==typeof a)return this._showErrorOptions(this.nls.error.invalidSQL),b;if("1\x3d1"===this.expr.replace(/\s/gi,""))return b={expr:"1\x3d1",parts:[],logicalOperator:"AND"};
b=this.getFilterObjByExpr(a);a=!1;b&&(a=b.parts&&0<b.parts.length?t.every(b.parts,c.hitch(this,function(a){return a.parts?0<a.parts.length?t.every(a.parts,c.hitch(this,function(a){return!a.error})):!1:!a.error})):!1);a?this._buildEditUIByPartsObj(b):(b=null,this._showErrorOptions(this.nls.error.cantParseSQL));return b},_buildEditUIByPartsObj:function(a){a&&(this._destroyAllFilters(),this.allAnySelect.value=a.logicalOperator,t.forEach(a.parts,c.hitch(this,function(a){a.parts?this._addFilterSet(a):
a.fieldObj&&(a.operator&&a.valueObj)&&this._addSingleFilter(a)})))},_addSingleFilter:function(a){a={url:this.url,layerInfo:this._layerDefinition,stringFieldType:this._stringFieldType,dateFieldType:this._dateFieldType,numberFieldTypes:this._numberFieldTypes,part:a,OPERATORS:c.mixin({},this.OPERATORS),enableAskForValues:this.enableAskForValues,isHosted:this.isHosted};a=new e(a);a.placeAt(this.allExpsBox);a.startup();this.own(q.after(a,"_destroySelf",c.hitch(this,this._checkFilterNumbers)));this._checkFilterNumbers()},
_addFilterSet:function(a){a={url:this.url,layerInfo:this._layerDefinition,stringFieldType:this._stringFieldType,dateFieldType:this._dateFieldType,numberFieldTypes:this._numberFieldTypes,partsObj:a,OPERATORS:c.mixin({},this.OPERATORS),enableAskForValues:this.enableAskForValues,isHosted:this.isHosted};a=new g(a);a.placeAt(this.allExpsBox);a.startup();this.own(q.after(a,"_destroySelf",c.hitch(this,this._checkFilterNumbers)));this._checkFilterNumbers()},_destroyAllFilters:function(){for(var a=this._getAllSingleFiltersAndFilterSets();0<
a.length;)a[0].destroy(),a.splice(0,1);this._checkFilterNumbers()},_getAllSingleFiltersAndFilterSetsDoms:function(){return s(".allExpsBox\x3e.jimu-single-filter,.allExpsBox\x3e.jimu-filter-set",this.contentSection)},_getAllSingleFiltersAndFilterSets:function(){var a=this._getAllSingleFiltersAndFilterSetsDoms();return t.map(a,c.hitch(this,function(a){return p.byNode(a)}))},_checkFilterNumbers:function(){var a=this._getAllSingleFiltersAndFilterSetsDoms();1<a.length?k.setStyle(this.matchMsg,"display",
"block"):k.setStyle(this.matchMsg,"display","none");0<a.length?k.setStyle(this.noFilterTipSection,"display","none"):k.setStyle(this.noFilterTipSection,"display","block");t.forEach(a,c.hitch(this,function(a,b){k.removeClass(a,"even-filter");k.removeClass(a,"odd-filter");k.addClass(a,0===(b+1)%2?"even-filter":"odd-filter")}))},_showErrorOptions:function(a){k.setStyle(this.contentSection,"display","none");k.setStyle(this.errorSection,"display","none");this.errorTip.innerHTML=a;this.loading.hide()},_onBtnAddSetClick:function(){this._layerDefinition&&
this._validOptions&&this._addFilterSet()},_onBtnAddExpClick:function(){this._layerDefinition&&this._validOptions&&this._addSingleFilter()}})})},"jimu/dijit/_SingleFilter":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_SingleFilter.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/json dojo/on dojo/store/Memory esri/request jimu/utils jimu/dijit/CheckBox dijit/form/Select dijit/form/FilteringSelect dijit/form/ValidationTextBox dijit/form/DateTextBox dijit/form/NumberTextBox".split(" "),
function(m,f,n,r,l,h,d,p,c,k,t,q,s){return m([f,n,r],{templateString:l,baseClass:"jimu-single-filter",declaredClass:"jimu.dijit._SingleFilter",nls:null,url:null,layerInfo:null,stringFieldType:"",dateFieldType:"",numberFieldTypes:[],supportFieldTypes:[],part:null,OPERATORS:null,enableAskForValues:!1,isHosted:!1,postMixInProperties:function(){this.supportFieldTypes=[];this.supportFieldTypes.push(this.stringFieldType);this.supportFieldTypes.push(this.dateFieldType);this.supportFieldTypes=this.supportFieldTypes.concat(this.numberFieldTypes);
this.nls=window.jimuNls.filterBuilder;this.nls.caseSensitive||(this.nls.caseSensitive="Case Sensitive")},postCreate:function(){this.inherited(arguments);this._initSelf()},toJson:function(){var a=null,b=this._isUseAskForValues(),e=this._getSelectedFilteringItem(this.fieldsSelect);if(!e)return null;a={fieldObj:"",operator:"",valueObj:"",interactiveObj:"",caseSensitive:!1};if(b){if(!this.promptTB.validate())return this._showValidationErrorTip(this.promptTB),null;a.interactiveObj={prompt:this.promptTB.get("value"),
hint:this.hintTB.get("value")}}a.fieldObj={name:e.name,label:e.name,shortType:e.shortType,type:e.type};if("none"===this.operatorsSelect.get("value"))return null;a.operator=this.operatorsSelect.get("value");a.valueObj={isValid:!0,type:""};var g=e.shortType;if(this.valueRadio.checked)if(a.valueObj.type="value","string"===g)if(a.operator===this.OPERATORS.stringOperatorIsBlank||a.operator===this.OPERATORS.stringOperatorIsNotBlank)a.valueObj.value=null;else if(this._isFieldCoded(e)&&a.operator===this.OPERATORS.stringOperatorIs){if(!this.stringCodedValuesFS.validate())return this._showValidationErrorTip(this.stringCodedValuesFS),
null;b=this._getSelectedFilteringItem(this.stringCodedValuesFS);a.valueObj.value=b?b.code:""}else{if(!this.stringTextBox.validate())return this._showValidationErrorTip(this.stringTextBox),null;a.valueObj.value=this.stringTextBox.get("value")}else if("number"===g)if(a.operator===this.OPERATORS.numberOperatorIsBlank||a.operator===this.OPERATORS.numberOperatorIsNotBlank)a.valueObj.value=null;else if(a.operator===this.OPERATORS.numberOperatorIsBetween||a.operator===this.OPERATORS.numberOperatorIsNotBetween){if(!this.numberTextBox1.validate())return this._showValidationErrorTip(this.numberTextBox1),
null;if(!this.numberTextBox2.validate())return this._showValidationErrorTip(this.numberTextBox2),null;a.valueObj.value1=this._getValueForNumberTextBox(this.numberTextBox1);a.valueObj.value2=this._getValueForNumberTextBox(this.numberTextBox2);a.valueObj.isValid=s.isValidNumber(a.valueObj.value1)&&s.isValidNumber(a.valueObj.value2)}else{if(this._isFieldCoded(e)&&a.operator===this.OPERATORS.numberOperatorIs){if(!this.numberCodedValuesFS.validate())return this._showValidationErrorTip(this.numberCodedValuesFS),
null;b=this._getSelectedFilteringItem(this.numberCodedValuesFS);a.valueObj.value=b?parseFloat(b.code):null}else{if(!this.numberTextBox.validate())return this._showValidationErrorTip(this.numberTextBox),null;a.valueObj.value=this._getValueForNumberTextBox(this.numberTextBox)}a.valueObj.isValid=s.isValidNumber(a.valueObj.value)}else{if("date"===g)if(a.operator===this.OPERATORS.dateOperatorIsBlank||a.operator===this.OPERATORS.dateOperatorIsNotBlank)a.valueObj.value=null;else if(a.operator===this.OPERATORS.dateOperatorIsBetween||
a.operator===this.OPERATORS.dateOperatorIsNotBetween){if(!this.dateTextBox1.validate())return this._showValidationErrorTip(this.dateTextBox1),null;if(!this.dateTextBox2.validate())return this._showValidationErrorTip(this.dateTextBox2),null;a.valueObj.value1=this.dateTextBox1.get("value").toDateString();a.valueObj.value2=this.dateTextBox2.get("value").toDateString()}else{if(!this.dateTextBox.validate())return this._showValidationErrorTip(this.dateTextBox),null;a.valueObj.value=this.dateTextBox.get("value").toDateString()}}else if(this.fieldRadio.checked){b=
this._getSelectedFilteringItem(this.fieldsSelect2);if(!b)return this._showValidationErrorTip(this.fieldsSelect2),null;a.valueObj.value=b.name;a.valueObj.label=b.name;a.valueObj.type="field"}else if(this.uniqueRadio&&this.uniqueRadio.checked)if(a.valueObj.type="unique",e=this._getSelectedFilteringItem(this.uniqueValuesSelect))"string"===g?a.valueObj.value=e.value:"number"===g&&(a.valueObj.value=parseFloat(e.value));else if(b)"string"===g?a.valueObj.value="":"number"===g&&(a.valueObj.value=null,a.valueObj.isValid=
!1);else return this._showValidationErrorTip(this.uniqueValuesSelect),null;if("string"===g)switch(a.operator){case this.OPERATORS.stringOperatorStartsWith:case this.OPERATORS.stringOperatorEndsWith:case this.OPERATORS.stringOperatorContains:case this.OPERATORS.stringOperatorDoesNotContain:a.caseSensitive=this.cbxCaseSensitive.getValue()}return a},showDelteIcon:function(){d.setStyle(this.btnDelete,"display","inline-block")},hideDeleteIcon:function(){d.setStyle(this.btnDelete,"display","none")},_showCaseSensitive:function(){d.setStyle(this.cbxCaseSensitive.domNode,
"display","inline-block")},_hideCaseSensitive:function(){d.setStyle(this.cbxCaseSensitive.domNode,"display","none")},_getProcessedString:function(a){return s.isNotEmptyString(a,!0)?a:""},_getProcessedNumber:function(a){return s.isValidNumber(a)?a:null},_setValueForStringTextBox:function(a,b){b=this._getProcessedString(b);a.set("value",b)},_setValueForNumberTextBox:function(a,b){s.isValidNumber(b)&&a.set("value",b)},_getValueForNumberTextBox:function(a){a=a.get("value");return this._getProcessedNumber(a)},
_initSelf:function(){this.isHosted&&(this.cbxCaseSensitive.setValue(!1),this.cbxCaseSensitive.setStatus(!1),this.cbxCaseSensitive.domNode.title=this.nls.notSupportCaseSensitiveTip);this.own(k(this.cbxAskValues,"status-change",h.hitch(this,this._onCbxAskValuesStatusChanged)));this.cbxAskValues.onChange=h.hitch(this,this._onCbxAskValuesClicked);this.own(k(this.fieldsSelect,"MouseEnter",h.hitch(this,this._updateFieldsSelectTitle)));this.own(k(this.operatorsSelect,"MouseEnter",h.hitch(this,this._updateOperatorsSelectTitle)));
this.own(k(this.dateTextBox1,"MouseEnter",h.hitch(this,this._updateDateTextBox1Title)));this.own(k(this.dateTextBox2,"MouseEnter",h.hitch(this,this._updateDateTextBox2Title)));var a=new t({idProperty:"id",data:[]});this.uniqueValuesSelect.set("store",a);this.enableAskForValues?(d.setStyle(this.cbxAskValues.domNode,"display","inline-block"),d.setStyle(this.promptSection,"display","block")):(d.setStyle(this.cbxAskValues.domNode,"display","none"),d.setStyle(this.promptSection,"display","none"));this.layerInfo=
h.mixin({},this.layerInfo);this._initRadios();a=0;this.layerInfo.currentVersion&&(a=parseFloat(this.layerInfo.currentVersion));if(10.1>a||this._isStreamServer(this.url))d.destroy(this.uniqueTd),this.uniqueRadio=null;if((a=this.layerInfo.fields)&&0<a.length)a=p.filter(a,h.hitch(this,function(a){return 0<=this.supportFieldTypes.indexOf(a.type)})),this._enableRadios(),this._initFieldsSelect(a)},_isStreamServer:function(a){a=(a||"").replace(/\/*$/g,"");return/\/StreamServer$/gi.test(a)},_updateFieldsSelectTitle:function(){this.fieldsSelect.domNode.title=
"";var a=this._getSelectedFilteringItem(this.fieldsSelect);a&&(this.fieldsSelect.domNode.title=a.displayName||a.alias||a.name)},_updateOperatorsSelectTitle:function(){this.operatorsSelect.domNode.title="";var a=this.operatorsSelect.get("value");a&&(a=this.operatorsSelect.getOptions(a),this.operatorsSelect.domNode.title=a.label)},_updateDateTextBox1Title:function(){var a=this.dateTextBox1.get("displayedValue")||"";this.dateTextBox1.domNode.title=a},_updateDateTextBox2Title:function(){var a=this.dateTextBox2.get("displayedValue")||
"";this.dateTextBox2.domNode.title=a},_showValidationErrorTip:function(a){try{!a.validate()&&a.domNode&&a.focusNode&&(a.focusNode.focus(),a.focusNode.blur())}catch(b){console.error(b)}},_focusValidationTextBox:function(a){try{a&&a.focusNode&&a.focusNode.focus()}catch(b){console.error(b)}},_isFieldCoded:function(a){return(a=a.domain)&&"codedValue"===a.type&&a.codedValues&&0<a.codedValues.length},_getSelectedFilteringItem:function(a){if(a.validate()){var b=a.get("item");if(b)return b}this._showValidationErrorTip(a);
return null},_getShortTypeByFieldType:function(a){return a===this.stringFieldType?"string":a===this.dateFieldType?"date":0<=this.numberFieldTypes.indexOf(a)?"number":null},_getOperatorsByShortType:function(a){var b=[];"string"===a?b=[this.OPERATORS.stringOperatorIs,this.OPERATORS.stringOperatorIsNot,this.OPERATORS.stringOperatorStartsWith,this.OPERATORS.stringOperatorEndsWith,this.OPERATORS.stringOperatorContains,this.OPERATORS.stringOperatorDoesNotContain,this.OPERATORS.stringOperatorIsBlank,this.OPERATORS.stringOperatorIsNotBlank]:
"number"===a?b=[this.OPERATORS.numberOperatorIs,this.OPERATORS.numberOperatorIsNot,this.OPERATORS.numberOperatorIsAtLeast,this.OPERATORS.numberOperatorIsLessThan,this.OPERATORS.numberOperatorIsAtMost,this.OPERATORS.numberOperatorIsGreaterThan,this.OPERATORS.numberOperatorIsBetween,this.OPERATORS.numberOperatorIsNotBetween,this.OPERATORS.numberOperatorIsBlank,this.OPERATORS.numberOperatorIsNotBlank]:"date"===a&&(b=[this.OPERATORS.dateOperatorIsOn,this.OPERATORS.dateOperatorIsNotOn,this.OPERATORS.dateOperatorIsBefore,
this.OPERATORS.dateOperatorIsAfter,this.OPERATORS.dateOperatorIsBetween,this.OPERATORS.dateOperatorIsNotBetween,this.OPERATORS.dateOperatorIsBlank,this.OPERATORS.dateOperatorIsNotBlank]);return b},_initFieldsSelect:function(a){a=p.map(a,h.hitch(this,function(a,b){var c=h.mixin({},a);c.id=b;c.shortType=this._getShortTypeByFieldType(a.type);c.alias||(c.alias=c.name);var v="";"string"===c.shortType?v=this.nls.string:"number"===c.shortType?v=this.nls.number:"date"===c.shortType&&(v=this.nls.date);c.displayName=
c.alias+" ("+v+")";return c}));if(0<a.length){var b=new t({data:a});this.fieldsSelect.set("store",b);this.fieldsSelect.set("value",a[0].id)}this.fieldsSelect.focusNode.focus();this.fieldsSelect.focusNode.blur();this._onFieldsSelectChange();this.part&&this._showPart(this.part)},_showPart:function(a){if((this.part=a)&&this.part.fieldObj&&this.part.operator&&this.part.valueObj){a=this.part.fieldObj.name;var b=this.part.operator;this.part.caseSensitive=!!this.part.caseSensitive;a=this.fieldsSelect.store.query({name:a});
if(0!==a.length&&(a=a[0]))this.fieldsSelect.set("value",a.id),setTimeout(h.hitch(this,function(){this.domNode&&(this._onFieldsSelectChange(),this.operatorsSelect.set("value",b),setTimeout(h.hitch(this,function(){this.domNode&&this._resetByFieldAndOperation(this.part)}),50),setTimeout(h.hitch(this,function(){if(this.domNode){var a=this.part.interactiveObj;a&&(this.cbxAskValues.check(),this._updatePrompt(),this.promptTB.set("value",a.prompt||""),this.hintTB.set("value",a.hint||""))}}),100))}),0)}},
_onFieldsSelectChange:function(){this._updateFieldsSelectTitle();this.operatorsSelect.removeOption(this.operatorsSelect.getOptions());this.operatorsSelect.addOption({value:"none",label:this.nls.none});this.valueRadio.checked=!0;var a=this._getSelectedFilteringItem(this.fieldsSelect);a&&(this.operatorsSelect.shortType=a.shortType,a=this._getOperatorsByShortType(a.shortType),this.operatorsSelect.removeOption(this.operatorsSelect.getOptions()),p.forEach(a,h.hitch(this,function(a){this.operatorsSelect.addOption({value:a,
label:this.nls[a]})})));this._onOperatorsSelectChange()},_onOperatorsSelectChange:function(){this._updateOperatorsSelectTitle();this.valueRadio.checked=!0;this._resetByFieldAndOperation()},_onRangeNumberBlur:function(){if(this.numberTextBox1.validate()&&this.numberTextBox2.validate()){var a=this._getValueForNumberTextBox(this.numberTextBox1),b=this._getValueForNumberTextBox(this.numberTextBox2);s.isValidNumber(a)&&s.isValidNumber(b)&&a>b&&(this._setValueForNumberTextBox(this.numberTextBox1,b),this._setValueForNumberTextBox(this.numberTextBox2,
a))}},_onRangeDateBlur:function(){if(this.dateTextBox1.validate()&&this.dateTextBox2.validate()){var a=this.dateTextBox1.get("value"),b=a.getTime(),e=this.dateTextBox2.get("value"),g=e.getTime();b>g&&(this.dateTextBox1.set("value",e),this.dateTextBox2.set("value",a))}},_initRadios:function(){var a="radio_"+s.getRandomString();this.valueRadio.name=a;this.fieldRadio.name=a;s.combineRadioCheckBoxWithLabel(this.valueRadio,this.valueLabel);s.combineRadioCheckBoxWithLabel(this.fieldRadio,this.fieldLabel);
this.own(k(this.valueRadio,"click",h.hitch(this,function(){this._resetByFieldAndOperation()})));this.own(k(this.fieldRadio,"click",h.hitch(this,function(){this._resetByFieldAndOperation()})));this.uniqueRadio&&(this.uniqueRadio.name=a,s.combineRadioCheckBoxWithLabel(this.uniqueRadio,this.uniqueLabel),this.own(k(this.uniqueRadio,"click",h.hitch(this,function(){this._resetByFieldAndOperation()}))));this._resetByFieldAndOperation()},_enableRadios:function(){this.valueRadio.disabled=!1;this.fieldRadio.disabled=
!1;this.uniqueRadio&&(this.uniqueRadio.disabled=!1)},_disableRadios:function(){this.valueRadio.disabled=!0;this.fieldRadio.disabled=!0;this.uniqueRadio&&(this.uniqueRadio.disabled=!0)},_resetByFieldAndOperation:function(a){var b=a&&a.valueObj;d.setStyle(this.attributeValueContainer,"display","block");this._enableRadios();this._hideCaseSensitive();b&&("value"===b.type?this.valueRadio.checked=!0:"field"===b.type?this.fieldRadio.checked=!0:"unique"===b.type&&this.uniqueRadio&&(this.uniqueRadio.checked=
!0));var e=this._getSelectedFilteringItem(this.fieldsSelect),g=e&&e.shortType,c=this.operatorsSelect.get("value");if(e)if("string"===g)switch(c){case this.OPERATORS.stringOperatorStartsWith:case this.OPERATORS.stringOperatorEndsWith:case this.OPERATORS.stringOperatorContains:case this.OPERATORS.stringOperatorDoesNotContain:this.valueRadio.checked=!0,this._disableRadios(),this._showCaseSensitive(),a&&this.cbxCaseSensitive.setValue(a.caseSensitive)}else if("number"===g)switch(c){case this.OPERATORS.numberOperatorIsBetween:case this.OPERATORS.numberOperatorIsNotBetween:this.valueRadio.checked=
!0,this._disableRadios()}else if("date"===g){switch(c){case this.OPERATORS.dateOperatorIsBetween:case this.OPERATORS.dateOperatorIsNotBetween:this.valueRadio.checked=!0,this._disableRadios()}this.uniqueRadio&&(this.uniqueRadio.disabled=!0,this.uniqueRadio.checked&&(this.valueRadio.checked=!0))}this._updateUIOfAttrValueContainer(e,c,b)},_updateUIOfAttrValueContainer:function(a,b,e){this._updatePrompt();var g=a&&a.shortType;if("string"===g||"number"===g||"date"===g)if(d.setStyle(this.attributeValueContainer,
"display","block"),this.valueRadio.checked)if(d.setStyle(this.fieldsSelect2.domNode,"display","none"),d.setStyle(this.uniqueValuesSelect.domNode,"display","none"),this._showAllValueBoxContainer(),this._resetValueTextBox(),"string"===g)d.setStyle(this.stringTextBoxContainer,"display","block"),d.setStyle(this.numberTextBoxContainer,"display","none"),d.setStyle(this.dateTextBoxContainer,"display","none"),this._isFieldCoded(a)&&b===this.OPERATORS.stringOperatorIs?(d.setStyle(this.stringCodedValuesFS.domNode,
"display","inline-block"),d.setStyle(this.stringTextBox.domNode,"display","none"),a=p.map(a.domain.codedValues,h.hitch(this,function(a,b){var g=h.mixin({},a);g.id=b;return g})),g=new t({data:a}),this.stringCodedValuesFS.set("store",g),e?(g=p.filter(a,h.hitch(this,function(a){return a.code===e.value})),0<g.length?this.stringCodedValuesFS.set("value",g[0].id):this.stringCodedValuesFS.set("value",a[0].id)):this.stringCodedValuesFS.set("value",a[0].id)):(d.setStyle(this.stringTextBox.domNode,"display",
"inline-block"),d.setStyle(this.stringCodedValuesFS.domNode,"display","none"),e&&this._setValueForStringTextBox(this.stringTextBox,e.value)),(b===this.OPERATORS.stringOperatorIsBlank||b===this.OPERATORS.stringOperatorIsNotBlank)&&d.setStyle(this.attributeValueContainer,"display","none");else if("number"===g){d.setStyle(this.stringTextBoxContainer,"display","none");d.setStyle(this.numberTextBoxContainer,"display","block");d.setStyle(this.dateTextBoxContainer,"display","none");if(b===this.OPERATORS.numberOperatorIsBetween||
b===this.OPERATORS.numberOperatorIsNotBetween){if(d.setStyle(this.numberTextBox.domNode,"display","none"),d.setStyle(this.numberRangeTable,"display","table"),d.setStyle(this.numberCodedValuesFS.domNode,"display","none"),e){var c;a=s.isValidNumber(e.value1);g=s.isValidNumber(e.value2);a&&g?(g=parseFloat(e.value1),c=parseFloat(e.value2),a=Math.min(g,c),g=Math.max(g,c),this.numberTextBox1.set("value",a),this.numberTextBox2.set("value",g)):a&&!g?(g=parseFloat(e.value1),this.numberTextBox1.set("value",
g)):!a&&g&&(c=parseFloat(e.value2),this.numberTextBox2.set("value",c))}}else if(d.setStyle(this.numberRangeTable,"display","none"),this._isFieldCoded(a)&&b===this.OPERATORS.numberOperatorIs)if(d.setStyle(this.numberTextBox.domNode,"display","none"),d.setStyle(this.numberCodedValuesFS.domNode,"display","inline-block"),a=p.map(a.domain.codedValues,h.hitch(this,function(a,b){var g=h.mixin({},a);g.id=b;return g})),g=new t({data:a}),this.numberCodedValuesFS.set("store",g),e&&!isNaN(e.value)){var v=parseFloat(e.value),
g=p.filter(a,h.hitch(this,function(a){return parseFloat(a.code)===v}));0<g.length?this.numberCodedValuesFS.set("value",g[0].id):this.numberCodedValuesFS.set("value",a[0].id)}else this.numberCodedValuesFS.set("value",a[0].id);else d.setStyle(this.numberTextBox.domNode,"display","inline-block"),d.setStyle(this.numberCodedValuesFS.domNode,"display","none"),e&&this._setValueForNumberTextBox(this.numberTextBox,e.value);(b===this.OPERATORS.numberOperatorIsBlank||b===this.OPERATORS.numberOperatorIsNotBlank)&&
d.setStyle(this.attributeValueContainer,"display","none")}else"date"===g&&(d.setStyle(this.stringTextBoxContainer,"display","none"),d.setStyle(this.numberTextBoxContainer,"display","none"),d.setStyle(this.dateTextBoxContainer,"display","block"),b===this.OPERATORS.dateOperatorIsBetween||b===this.OPERATORS.dateOperatorIsNotBetween?(d.setStyle(this.dateTextBox.domNode,"display","none"),d.setStyle(this.dateRangeTable,"display","table"),e&&(e.value1&&e.value2)&&(this.dateTextBox1.set("value",new Date(e.value1)),
this.dateTextBox2.set("value",new Date(e.value2)))):(d.setStyle(this.dateTextBox.domNode,"display","inline-block"),d.setStyle(this.dateRangeTable,"display","none"),e&&e.value&&this.dateTextBox.set("value",new Date(e.value))),(b===this.OPERATORS.dateOperatorIsBlank||b===this.OPERATORS.dateOperatorIsNotBlank)&&d.setStyle(this.attributeValueContainer,"display","none"));else this.fieldRadio.checked?(this._hideAllValueBoxContainer(),d.setStyle(this.uniqueValuesSelect.domNode,"display","none"),d.setStyle(this.fieldsSelect2.domNode,
"display","inline-block"),this._resetFieldsSelect2(),e&&e.value&&(b=this.fieldsSelect2.store.query({name:e.value}),0<b.length&&(b=b[0])&&this.fieldsSelect2.set("value",b.id))):this.uniqueRadio&&this.uniqueRadio.checked&&(this._hideAllValueBoxContainer(),d.setStyle(this.fieldsSelect2.domNode,"display","none"),d.setStyle(this.uniqueValuesSelect.domNode,"display","inline-block"),this._resetUniqueValuesSelect(e));else d.setStyle(this.attributeValueContainer,"display","none")},_showAllValueBoxContainer:function(){d.setStyle(this.allValueBoxContainer,
"display","block")},_hideAllValueBoxContainer:function(){d.setStyle(this.allValueBoxContainer,"display","none")},_resetValueTextBox:function(){this.stringTextBox.set("value","");this.numberTextBox.set("value","");this.dateTextBox.set("value",new Date)},_resetFieldsSelect2:function(){this.fieldsSelect2.set("displayedValue","");var a=new t({data:[]});this.fieldsSelect2.set("store",a);if(this.fieldsSelect.validate()){var b=this._getSelectedFilteringItem(this.fieldsSelect);if(b){var a=this.fieldsSelect.store.query({shortType:b.shortType}),
e=p.filter(a,h.hitch(this,function(a){return a.id!==b.id})),a=new t({data:e});this.fieldsSelect2.set("store",a);0<e.length&&this.fieldsSelect2.set("value",e[0].id)}}},_tryLocaleNumber:function(a){var b=s.localizeNumber(a);if(null===b||void 0===b)b=a;return b},_resetUniqueValuesSelect:function(a){this.uniqueValuesSelect.reset();this.uniqueValuesSelect.store.setData([]);if(this.layerInfo&&10.1<=parseFloat(this.layerInfo.currentVersion)){var b=this._getSelectedFilteringItem(this.fieldsSelect);if(b){var e=
this.url+"/generateRenderer",g=c.stringify({type:"uniqueValueDef",uniqueValueFields:[b.name]});q({url:e,content:{classificationDef:g,f:"json"},handleAs:"json",callbackParamName:"callback",timeout:15E3}).then(h.hitch(this,function(g){g=g&&g.uniqueValueInfos;var e=this._getSelectedFilteringItem(this.fieldsSelect);if(g&&e&&b.id===e.id){this.uniqueValuesSelect.store.setData([]);var c=-1,d=this._hasCodedValues(e);g=p.map(g,h.hitch(this,function(b,g){var k=b.value,f=k;"number"===e.shortType&&(k=parseFloat(k),
f=this._tryLocaleNumber(k));d&&(f=this._getDisplayNameOfCodedValues(k,e));f={id:g,value:k,label:f};a&&a.value===k&&(c=f.id);return f}));this.uniqueValuesSelect.store.setData(g);0<g.length&&0<=c&&(g=this.uniqueValuesSelect.store.get(c))&&this.uniqueValuesSelect.set("item",g)}}),h.hitch(this,function(a){console.error(a)}))}}},_hasCodedValues:function(a){var b=!1;a.domain&&(a=a.domain.codedValues)&&0<a.length&&(b=!0);return b},_getDisplayNameOfCodedValues:function(a,b){var e=a;p.some(b.domain.codedValues,
function(b){return b.code===a?(e=b.name,!0):!1});return e},_onCbxAskValuesClicked:function(){this._updateRequiredProperty();this._updatePrompt()},_onCbxAskValuesStatusChanged:function(){this._updateRequiredProperty()},_isUseAskForValues:function(){return this.cbxAskValues.status&&this.cbxAskValues.checked},_isValueRequired:function(){return!this._isUseAskForValues()},_updateRequiredProperty:function(){var a=this._isValueRequired();this.stringTextBox.set("required",a);this.stringCodedValuesFS.set("required",
a);this.numberTextBox.set("required",a);this.numberTextBox1.set("required",a);this.numberTextBox2.set("required",a);this.numberCodedValuesFS.set("required",a);this.uniqueValuesSelect.set("required",a)},_updatePrompt:function(){this.promptTB.set("value","");this.hintTB.set("value","");this.cbxAskValues.setStatus(!0);d.setStyle(this.promptTable,"display","table");var a=this.operatorsSelect.get("value"),b=this.nls[a];this.fieldRadio.checked&&this.cbxAskValues.setStatus(!1);a===this.OPERATORS.stringOperatorIsBlank&&
this.cbxAskValues.setStatus(!1);a===this.OPERATORS.stringOperatorIsNotBlank&&this.cbxAskValues.setStatus(!1);a===this.OPERATORS.numberOperatorIsBlank&&this.cbxAskValues.setStatus(!1);a===this.OPERATORS.numberOperatorIsNotBlank&&this.cbxAskValues.setStatus(!1);a===this.OPERATORS.dateOperatorIsBlank&&this.cbxAskValues.setStatus(!1);a===this.OPERATORS.dateOperatorIsNotBlank&&this.cbxAskValues.setStatus(!1);if(this.cbxAskValues.status&&this.cbxAskValues.checked){d.setStyle(this.promptTable,"display",
"table");var e=this._getSelectedFilteringItem(this.fieldsSelect);e&&"none"!==a&&this.promptTB.set("value",(e.alias||e.name)+" "+b)}else d.setStyle(this.promptTable,"display","none")},_destroySelf:function(){this.destroy()}})})},"dijit/form/FilteringSelect":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/when","./MappedTextBox","./ComboBoxMixin"],function(m,f,n,r,l){return m("dijit.form.FilteringSelect",[r,l],{required:!0,_lastDisplayedValue:"",_isValidSubset:function(){return this._opened},
isValid:function(){return!!this.item||!this.required&&""==this.get("displayedValue")},_refreshState:function(){this.searchTimer||this.inherited(arguments)},_callbackSetLabel:function(f,d,p,c){d&&d[this.searchAttr]!==this._lastQuery||!d&&f.length&&this.store.getIdentity(f[0])!=this._lastQuery||(f.length?this.set("item",f[0],c):this.set("value","",c||void 0===c&&!this.focused,this.textbox.value,null))},_openResultList:function(f,d,p){d[this.searchAttr]===this._lastQuery&&(this.inherited(arguments),
void 0===this.item&&this.validate(!0))},_getValueAttr:function(){return this.valueNode.value},_getValueField:function(){return"value"},_setValueAttr:function(h,d,p,c){this._onChangeActive||(d=null);if(void 0===c){if(null===h||""===h)if(h="",!f.isString(p)){this._setDisplayedValueAttr(p||"",d);return}var k=this;this._lastQuery=h;n(this.store.get(h),function(c){k._callbackSetLabel(c?[c]:[],void 0,void 0,d)})}else this.valueNode.value=h,this.inherited(arguments,[h,d,p,c])},_setItemAttr:function(f,d,
p){this.inherited(arguments);this._lastDisplayedValue=this.textbox.value},_getDisplayQueryString:function(f){return f.replace(/([\\\*\?])/g,"\\$1")},_setDisplayedValueAttr:function(h,d){null==h&&(h="");if(!this._created){if(!("displayedValue"in this.params))return;d=!1}if(this.store){this.closeDropDown();var p=f.clone(this.query),c=this._getDisplayQueryString(h),k;this.store._oldAPI?k=c:(k=this._patternToRegExp(c),k.toString=function(){return c});this._lastQuery=p[this.searchAttr]=k;this._lastDisplayedValue=
this.textbox.value=h;this._set("displayedValue",h);var l=this,q={queryOptions:{ignoreCase:this.ignoreCase,deep:!0}};f.mixin(q,this.fetchProperties);this._fetchHandle=this.store.query(p,q);n(this._fetchHandle,function(c){l._fetchHandle=null;l._callbackSetLabel(c||[],p,q,d)},function(c){l._fetchHandle=null;l._cancelingQuery||console.error("dijit.form.FilteringSelect: "+c.toString())})}},undo:function(){this.set("displayedValue",this._lastDisplayedValue)}})})},"dijit/form/DateTextBox":function(){define(["dojo/_base/declare",
"../Calendar","./_DateTimeTextBox"],function(m,f,n){return m("dijit.form.DateTextBox",n,{baseClass:"dijitTextBox dijitComboBox dijitDateTextBox",popupClass:f,_selector:"date",maxHeight:Infinity,value:new Date("")})})},"dijit/Calendar":function(){define("dojo/_base/array dojo/date dojo/date/locale dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/sniff ./CalendarLite ./_Widget ./_CssStateMixin ./_TemplatedMixin ./form/DropDownButton".split(" "),
function(m,f,n,r,l,h,d,p,c,k,t,q,s,a,b,e,g){var w=r("dijit.Calendar",[s,a,b],{baseClass:"dijitCalendar",cssStateNodes:{decrementMonth:"dijitCalendarArrow",incrementMonth:"dijitCalendarArrow",previousYearLabelNode:"dijitCalendarPreviousYear",nextYearLabelNode:"dijitCalendarNextYear"},setValue:function(a){p.deprecated("dijit.Calendar:setValue() is deprecated.  Use set('value', ...) instead.","","2.0");this.set("value",a)},_createMonthWidget:function(){return new w._MonthDropDownButton({id:this.id+"_mddb",
tabIndex:-1,onMonthSelect:k.hitch(this,"_onMonthSelect"),lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},postCreate:function(){this.inherited(arguments);this.own(t(this.domNode,"keydown",k.hitch(this,"_onKeyDown")),t(this.dateRowsNode,"mouseover",k.hitch(this,"_onDayMouseOver")),t(this.dateRowsNode,"mouseout",k.hitch(this,"_onDayMouseOut")),t(this.dateRowsNode,"mousedown",k.hitch(this,"_onDayMouseDown")),t(this.dateRowsNode,"mouseup",k.hitch(this,"_onDayMouseUp")))},_onMonthSelect:function(a){var b=
new this.dateClassObj(this.currentFocus);b.setDate(1);b.setMonth(a);a=this.dateModule.getDaysInMonth(b);var g=this.currentFocus.getDate();b.setDate(Math.min(g,a));this._setCurrentFocusAttr(b)},_onDayMouseOver:function(a){if((a=h.contains(a.target,"dijitCalendarDateLabel")?a.target.parentNode:a.target)&&(a.dijitDateValue&&!h.contains(a,"dijitCalendarDisabledDate")||a==this.previousYearLabelNode||a==this.nextYearLabelNode))h.add(a,"dijitCalendarHoveredDate"),this._currentNode=a},_onDayMouseOut:function(a){this._currentNode&&
!(a.relatedTarget&&a.relatedTarget.parentNode==this._currentNode)&&(a="dijitCalendarHoveredDate",h.contains(this._currentNode,"dijitCalendarActiveDate")&&(a+=" dijitCalendarActiveDate"),h.remove(this._currentNode,a),this._currentNode=null)},_onDayMouseDown:function(a){if((a=a.target.parentNode)&&a.dijitDateValue&&!h.contains(a,"dijitCalendarDisabledDate"))h.add(a,"dijitCalendarActiveDate"),this._currentNode=a},_onDayMouseUp:function(a){(a=a.target.parentNode)&&a.dijitDateValue&&h.remove(a,"dijitCalendarActiveDate")},
handleKey:function(a){var b=-1,g,e=this.currentFocus;switch(a.keyCode){case c.RIGHT_ARROW:b=1;case c.LEFT_ARROW:g="day";this.isLeftToRight()||(b*=-1);break;case c.DOWN_ARROW:b=1;case c.UP_ARROW:g="week";break;case c.PAGE_DOWN:b=1;case c.PAGE_UP:g=a.ctrlKey||a.altKey?"year":"month";break;case c.END:e=this.dateModule.add(e,"month",1),g="day";case c.HOME:e=new this.dateClassObj(e);e.setDate(1);break;default:return!0}g&&(e=this.dateModule.add(e,g,b));this._setCurrentFocusAttr(e);return!1},_onKeyDown:function(a){this.handleKey(a)||
(a.stopPropagation(),a.preventDefault())},onValueSelected:function(){},onChange:function(a){this.onValueSelected(a)},getClassForDate:function(){}});w._MonthDropDownButton=r("dijit.Calendar._MonthDropDownButton",g,{onMonthSelect:function(){},postCreate:function(){this.inherited(arguments);this.dropDown=new w._MonthDropDown({id:this.id+"_mdd",onChange:this.onMonthSelect})},_setMonthAttr:function(a){var b=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a);this.dropDown.set("months",
b);this.containerNode.innerHTML=(6==q("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+this.dropDown.domNode.innerHTML+"\x3c/div\x3e")+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+b[a.getMonth()]+"\x3c/div\x3e"}});w._MonthDropDown=r("dijit.Calendar._MonthDropDown",[a,e,b],{months:[],baseClass:"dijitCalendarMonthMenu dijitMenu",templateString:"\x3cdiv data-dojo-attach-event\x3d'ondijitclick:_onClick'\x3e\x3c/div\x3e",_setMonthsAttr:function(a){this.domNode.innerHTML=
"";m.forEach(a,function(a,b){d.create("div",{className:"dijitCalendarMonthLabel",month:b,innerHTML:a},this.domNode)._cssState="dijitCalendarMonthLabel"},this)},_onClick:function(a){this.onChange(l.get(a.target,"month"))},onChange:function(){}});return w})},"dijit/CalendarLite":function(){define("dojo/_base/array dojo/_base/declare dojo/cldr/supplemental dojo/date dojo/date/locale dojo/date/stamp dojo/dom dojo/dom-class dojo/_base/lang dojo/on dojo/sniff dojo/string ./_WidgetBase ./_TemplatedMixin dojo/text!./templates/Calendar.html ./a11yclick ./hccss".split(" "),
function(m,f,n,r,l,h,d,p,c,k,t,q,s,a,b){var e=f("dijit.CalendarLite",[s,a],{templateString:b,dowTemplateString:'\x3cth class\x3d"dijitReset dijitCalendarDayLabelTemplate" role\x3d"columnheader" scope\x3d"col"\x3e\x3cspan class\x3d"dijitCalendarDayLabel"\x3e${d}\x3c/span\x3e\x3c/th\x3e',dateTemplateString:'\x3ctd class\x3d"dijitReset" role\x3d"gridcell" data-dojo-attach-point\x3d"dateCells"\x3e\x3cspan class\x3d"dijitCalendarDateLabel" data-dojo-attach-point\x3d"dateLabels"\x3e\x3c/span\x3e\x3c/td\x3e',
weekTemplateString:'\x3ctr class\x3d"dijitReset dijitCalendarWeekTemplate" role\x3d"row"\x3e${d}${d}${d}${d}${d}${d}${d}\x3c/tr\x3e',value:new Date(""),datePackage:"",dayWidth:"narrow",tabIndex:"0",currentFocus:new Date,_setSummaryAttr:"gridNode",baseClass:"dijitCalendar dijitCalendarLite",_isValidDate:function(a){return a&&!isNaN(a)&&"object"==typeof a&&a.toString()!=this.constructor.prototype.value.toString()},_getValueAttr:function(){var a=this._get("value");if(a&&!isNaN(a)){var b=new this.dateClassObj(a);
b.setHours(0,0,0,0);b.getDate()<a.getDate()&&(b=this.dateModule.add(b,"hour",1));return b}return null},_setValueAttr:function(a,b){"string"==typeof a&&(a=h.fromISOString(a));a=this._patchDate(a);if(this._isValidDate(a)&&!this.isDisabledDate(a,this.lang)){if(this._set("value",a),this.set("currentFocus",a),this._markSelectedDates([a]),this._created&&(b||"undefined"==typeof b))this.onChange(this.get("value"))}else this._set("value",null),this._markSelectedDates([])},_patchDate:function(a){a&&(a=new this.dateClassObj(a),
a.setHours(1,0,0,0));return a},_setText:function(a,b){for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(a.ownerDocument.createTextNode(b))},_populateGrid:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);var a=this._patchDate(a),b=a.getDay(),e=this.dateModule.getDaysInMonth(a),c=this.dateModule.getDaysInMonth(this.dateModule.add(a,"month",-1)),f=new this.dateClassObj,d=n.getFirstDayOfWeek(this.lang);d>b&&(d-=7);if(!this.summary){var k=this.dateLocaleModule.getNames("months",
"wide","standAlone",this.lang,a);this.gridNode.setAttribute("summary",k[a.getMonth()])}this._date2cell={};m.forEach(this.dateCells,function(k,q){var h=q+d,s=new this.dateClassObj(a),l="dijitCalendar",p=0;h<b?(h=c-b+h+1,p=-1,l+="Previous"):h>=b+e?(h=h-b-e+1,p=1,l+="Next"):(h=h-b+1,l+="Current");p&&(s=this.dateModule.add(s,"month",p));s.setDate(h);this.dateModule.compare(s,f,"date")||(l="dijitCalendarCurrentDate "+l);this.isDisabledDate(s,this.lang)?(l="dijitCalendarDisabledDate "+l,k.setAttribute("aria-disabled",
"true")):(l="dijitCalendarEnabledDate "+l,k.removeAttribute("aria-disabled"),k.setAttribute("aria-selected","false"));(p=this.getClassForDate(s,this.lang))&&(l=p+" "+l);k.className=l+"Month dijitCalendarDateTemplate";l=s.valueOf();this._date2cell[l]=k;k.dijitDateValue=l;this._setText(this.dateLabels[q],s.getDateLocalized?s.getDateLocalized(this.lang):s.getDate())},this)},_populateControls:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);this.monthWidget.set("month",a);var b=
a.getFullYear()-1,e=new this.dateClassObj;m.forEach(["previous","current","next"],function(a){e.setFullYear(b++);this._setText(this[a+"YearLabelNode"],this.dateLocaleModule.format(e,{selector:"year",locale:this.lang}))},this)},goToToday:function(){this.set("value",new this.dateClassObj)},constructor:function(a){this.dateModule=a.datePackage?c.getObject(a.datePackage,!1):r;this.dateClassObj=this.dateModule.Date||Date;this.dateLocaleModule=a.datePackage?c.getObject(a.datePackage+".locale",!1):l},_createMonthWidget:function(){return e._MonthWidget({id:this.id+
"_mddb",lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},buildRendering:function(){var a=this.dowTemplateString,b=this.dateLocaleModule.getNames("days",this.dayWidth,"standAlone",this.lang),e=n.getFirstDayOfWeek(this.lang);this.dayCellsHtml=q.substitute([a,a,a,a,a,a,a].join(""),{d:""},function(){return b[e++%7]});a=q.substitute(this.weekTemplateString,{d:this.dateTemplateString});this.dateRowsHtml=[a,a,a,a,a,a].join("");this.dateCells=[];this.dateLabels=[];this.inherited(arguments);
d.setSelectable(this.domNode,!1);a=new this.dateClassObj(this.currentFocus);this.monthWidget=this._createMonthWidget();this.set("currentFocus",a,!1)},postCreate:function(){this.inherited(arguments);this._connectControls()},_connectControls:function(){var a=c.hitch(this,function(a,b,g){this[a].dojoClick=!0;return k(this[a],"click",c.hitch(this,function(){this._setCurrentFocusAttr(this.dateModule.add(this.currentFocus,b,g))}))});this.own(a("incrementMonth","month",1),a("decrementMonth","month",-1),
a("nextYearLabelNode","year",1),a("previousYearLabelNode","year",-1))},_setCurrentFocusAttr:function(a,b){var e=this.currentFocus,c=this._getNodeByDate(e);a=this._patchDate(a);this._set("currentFocus",a);if(!this._date2cell||0!=this.dateModule.difference(e,a,"month"))this._populateGrid(),this._populateControls(),this._markSelectedDates([this.value]);e=this._getNodeByDate(a);e.setAttribute("tabIndex",this.tabIndex);(this.focused||b)&&e.focus();c&&c!=e&&(t("webkit")?c.setAttribute("tabIndex","-1"):
c.removeAttribute("tabIndex"))},focus:function(){this._setCurrentFocusAttr(this.currentFocus,!0)},_onDayClick:function(a){a.stopPropagation();a.preventDefault();for(a=a.target;a&&!a.dijitDateValue;a=a.parentNode);a&&!p.contains(a,"dijitCalendarDisabledDate")&&this.set("value",a.dijitDateValue)},_getNodeByDate:function(a){return(a=this._patchDate(a))&&this._date2cell?this._date2cell[a.valueOf()]:null},_markSelectedDates:function(a){function b(a,e){p.toggle(e,"dijitCalendarSelectedDate",a);e.setAttribute("aria-selected",
a?"true":"false")}m.forEach(this._selectedCells||[],c.partial(b,!1));this._selectedCells=m.filter(m.map(a,this._getNodeByDate,this),function(a){return a});m.forEach(this._selectedCells,c.partial(b,!0))},onChange:function(){},isDisabledDate:function(){},getClassForDate:function(){}});e._MonthWidget=f("dijit.CalendarLite._MonthWidget",s,{_setMonthAttr:function(a){var b=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a),e=6==t("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+m.map(b,
function(a){return"\x3cdiv\x3e"+a+"\x3c/div\x3e"}).join("")+"\x3c/div\x3e";this.domNode.innerHTML=e+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+b[a.getMonth()]+"\x3c/div\x3e"}});return e})},"dijit/form/_DateTimeTextBox":function(){define("dojo/date dojo/date/locale dojo/date/stamp dojo/_base/declare dojo/_base/lang ./RangeBoundTextBox ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),function(m,f,n,r,l,h,d,p){new Date("X");return r("dijit.form._DateTimeTextBox",
[h,d],{templateString:p,hasDownArrow:!0,cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_unboundedConstraints:{},pattern:f.regexp,datePackage:"",postMixInProperties:function(){this.inherited(arguments);this._set("type","text")},compare:function(c,k){var f=this._isInvalidDate(c),d=this._isInvalidDate(k);if(f||d)return f&&d?0:!f?1:-1;var f=this.format(c,this._unboundedConstraints),d=this.format(k,this._unboundedConstraints),h=this.parse(f,this._unboundedConstraints),a=this.parse(d,this._unboundedConstraints);
return f==d?0:m.compare(h,a,this._selector)},autoWidth:!0,format:function(c,f){return!c?"":this.dateLocaleModule.format(c,f)},parse:function(c,f){return this.dateLocaleModule.parse(c,f)||(this._isEmpty(c)?null:void 0)},serialize:function(c,f){c.toGregorian&&(c=c.toGregorian());return n.toISOString(c,f)},dropDownDefaultValue:new Date,value:new Date(""),_blankValue:null,popupClass:"",_selector:"",constructor:function(c){c=c||{};this.dateModule=c.datePackage?l.getObject(c.datePackage,!1):m;this.dateClassObj=
this.dateModule.Date||Date;this.dateClassObj instanceof Date||(this.value=new this.dateClassObj(this.value));this.dateLocaleModule=c.datePackage?l.getObject(c.datePackage+".locale",!1):f;this._set("pattern",this.dateLocaleModule.regexp);this._invalidDate=this.constructor.prototype.value.toString()},buildRendering:function(){this.inherited(arguments);this.hasDownArrow||(this._buttonNode.style.display="none");this.hasDownArrow||(this._buttonNode=this.domNode,this.baseClass+=" dijitComboBoxOpenOnClick")},
_setConstraintsAttr:function(c){c.selector=this._selector;c.fullYear=!0;var f=n.fromISOString;"string"==typeof c.min&&(c.min=f(c.min),this.dateClassObj instanceof Date||(c.min=new this.dateClassObj(c.min)));"string"==typeof c.max&&(c.max=f(c.max),this.dateClassObj instanceof Date||(c.max=new this.dateClassObj(c.max)));this.inherited(arguments);this._unboundedConstraints=l.mixin({},this.constraints,{min:null,max:null})},_isInvalidDate:function(c){return!c||isNaN(c)||"object"!=typeof c||c.toString()==
this._invalidDate},_setValueAttr:function(c,f,d){void 0!==c&&("string"==typeof c&&(c=n.fromISOString(c)),this._isInvalidDate(c)&&(c=null),c instanceof Date&&!(this.dateClassObj instanceof Date)&&(c=new this.dateClassObj(c)));this.inherited(arguments,[c,f,d]);this.value instanceof Date&&(this.filterString="");this.dropDown&&this.dropDown.set("value",c,!1)},_set:function(c,f){if("value"==c){f instanceof Date&&!(this.dateClassObj instanceof Date)&&(f=new this.dateClassObj(f));var d=this._get("value");
if(d instanceof this.dateClassObj&&0==this.compare(f,d))return}this.inherited(arguments)},_setDropDownDefaultValueAttr:function(c){this._isInvalidDate(c)&&(c=new this.dateClassObj);this._set("dropDownDefaultValue",c)},openDropDown:function(c){this.dropDown&&this.dropDown.destroy();var f=l.isString(this.popupClass)?l.getObject(this.popupClass,!1):this.popupClass,d=this,h=this.get("value");this.dropDown=new f({onChange:function(c){d.set("value",c,!0)},id:this.id+"_popup",dir:d.dir,lang:d.lang,value:h,
textDir:d.textDir,currentFocus:!this._isInvalidDate(h)?h:this.dropDownDefaultValue,constraints:d.constraints,filterString:d.filterString,datePackage:d.datePackage,isDisabledDate:function(c){return!d.rangeCheck(c,d.constraints)}});this.inherited(arguments)},_getDisplayedValueAttr:function(){return this.textbox.value},_setDisplayedValueAttr:function(c,f){this._setValueAttr(this.parse(c,this.constraints),f,c)}})})},"jimu/dijit/_FilterSet":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_FilterSet.html dijit/registry dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/aspect dojo/query ./_SingleFilter".split(" "),
function(m,f,n,r,l,h,d,p,c,k,t,q,s){return m([f,n,r],{templateString:l,baseClass:"jimu-filter-set",nls:null,url:null,layerInfo:null,stringFieldType:"",dateFieldType:"",numberFieldTypes:[],partsObj:null,OPERATORS:null,enableAskForValues:!1,isHosted:!1,postMixInProperties:function(){this.nls=window.jimuNls.filterBuilder;var a=this.nls.matchMsgSet.split("${any_or_all}");this.nls.strMatchMsgPart1=a[0]||"";this.nls.strMatchMsgPart2=a[1]||"";this.inherited(arguments)},postCreate:function(){this.inherited(arguments);
this._initSelf()},toJson:function(){var a=q(".jimu-single-filter",this.allExpsBox),a=c.map(a,d.hitch(this,function(a){return h.byNode(a).toJson()}));return c.every(a,d.hitch(this,function(a){return!!a}))&&0<a.length?{logicalOperator:this.allAnySelect.value,parts:a}:null},showDelteIcon:function(){p.setStyle(this.btnDelete,"display","block")},hideDeleteIcon:function(){p.setStyle(this.btnDelete,"display","none")},_initSelf:function(){this.own(k(this.btnAdd,"click",d.hitch(this,this._addSingleFilter)));
if(this.partsObj){this.allAnySelect.value=this.partsObj.logicalOperator;var a=this.partsObj.parts||[];0===a.length?(this._addSingleFilter(),this._addSingleFilter()):1===a.length?(this._addSingleFilter(a[0]),this._addSingleFilter()):c.forEach(a,d.hitch(this,function(a){this._addSingleFilter(a)}))}else this._addSingleFilter(),this._addSingleFilter()},_addSingleFilter:function(a){a=new s({url:this.url,layerInfo:this.layerInfo,stringFieldType:this.stringFieldType,dateFieldType:this.dateFieldType,numberFieldTypes:this.numberFieldTypes,
part:a,OPERATORS:this.OPERATORS,enableAskForValues:this.enableAskForValues,isHosted:this.isHosted,style:{margin:"15px auto 0 auto",border:0,background:"inherit"}});a.placeAt(this.allExpsBox);a.startup();this.own(t.after(a,"_destroySelf",d.hitch(this,this._checkFilterNumbers)));this._checkFilterNumbers()},_checkFilterNumbers:function(){var a=q(".jimu-single-filter",this.allExpsBox),b=2<a.length;c.forEach(a,d.hitch(this,function(a){a=h.byNode(a);b?a.showDelteIcon():a.hideDeleteIcon()}))},_destroySelf:function(){this.destroy()}})})},
"dijit/Toolbar":function(){define("require dojo/_base/declare dojo/has dojo/keys dojo/ready ./_Widget ./_KeyNavContainer ./_TemplatedMixin".split(" "),function(m,f,n,r,l,h,d,p){n("dijit-legacy-requires")&&l(0,function(){m(["dijit/ToolbarSeparator"])});return f("dijit.Toolbar",[h,p,d],{templateString:'\x3cdiv class\x3d"dijit" role\x3d"toolbar" tabIndex\x3d"${tabIndex}" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e',baseClass:"dijitToolbar",_onLeftArrow:function(){this.focusPrev()},_onRightArrow:function(){this.focusNext()}})})},
"widgets/AttributeTable/_FeatureTable":function(){define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase jimu/dijit/Message dgrid/OnDemandGrid dgrid/Selection dgrid/extensions/ColumnHider dgrid/extensions/ColumnResizer dgrid/extensions/ColumnReorder dojo/Deferred dojo/Evented dojo/store/Memory esri/config esri/lang esri/tasks/RelationParameters esri/layers/GraphicsLayer esri/layers/FeatureLayer esri/tasks/QueryTask esri/tasks/query esri/tasks/ProjectParameters esri/graphic esri/geometry/Point esri/geometry/Multipoint esri/geometry/Polyline esri/geometry/Polygon esri/symbols/SimpleLineSymbol esri/symbols/SimpleFillSymbol esri/Color esri/geometry/normalizeUtils dojo/_base/lang dojo/on dojo/_base/array jimu/dijit/LoadingIndicator ./utils dojo/query".split(" "),
function(m,f,n,r,l,h,d,p,c,k,t,q,s,a,b,e,g,w,v,G,z,I,H,K,E,D,A,J,L,u,x,y,B,F){return m([n,t],{baseClass:"jimu-widget-attributetable-feature-table",_defaultFeatureCount:2E3,_defaultBatchCount:25,_batchCount:0,_filterObj:null,_currentDef:null,_requestStatus:"initial",map:null,matchingMap:!1,layerInfo:null,configedInfo:null,parentWidget:null,noGridHeight:0,footerHeight:25,layer:null,loading:null,grid:null,footer:null,selectedRowsLabel:null,selectionRows:null,griaphicLayer:null,nls:null,actived:!1,constructor:function(a){a=
a||{};this.set("map",a.map||null);this.set("matchingMap",!!a.matchingMap);this.set("layerInfo",a.layerInfo||null);this.set("layer",a.layer||null);this.set("configedInfo",a.configedInfo||null);this.parentWidget=a.parentWidget||null;this.noGridHeight=a.noGridHeight||0},postCreate:function(){this.selectionRows=[];this.loading=new B;this.loading.placeAt(this.domNode);this.get("map")&&this.own(x(this.map,"extent-change",u.hitch(this,"_onExtentChange")))},startup:function(){this.map&&(this.graphicsLayer=
new e,this.map.addLayer(this.graphicsLayer))},setLayerDefinition:function(a){this._layerDefinition=a},getLayerDefinition:function(){return u.clone(this._layerDefinition)},getFilterObj:function(){return this._filterObj},setFilterObj:function(a){this._filterObj=a},cancelThread:function(){"fulfilled"!==this._requestStatus&&this._currentDef&&(this._currentDef.cancel({canceledBySelf:!0}),this._requestStatus="canceled")},isCanceled:function(){return"canceled"===this._requestStatus},startQuery:function(){this.cancelThread();
this._requestStatus="processing";this.loading.show();this._getLayerObject().then(u.hitch(this,function(a){this.domNode&&(this.layer=a,(a=this.matchingMap&&this.map.extent||null)&&a.spatialReference&&a.spatialReference.isWebMercator()?(this._currentDef=L.normalizeCentralMeridian([a],null,u.hitch(this,function(a){return a[0]}))).then(u.hitch(this,function(a){this._doQuery(a)}),u.hitch(this,function(a){console.error(a)})):this._doQuery(a))}))},getSelectedRows:function(){return this.selectionRows},zoomTo:function(){this._zoomToSelected()},
showSelectedRecords:function(){var a=this.layer.objectIdField;this.grid._clickShowSelectedRecords=!0;var b=this._getSelectedIds();0<b.length&&this.grid&&(this.grid.store instanceof q?this.grid.set("query",u.hitch(this,function(e){return"number"===typeof e&&-1<b.indexOf(e)||-1<b.indexOf(e[a])?!0:!1})):this.grid.set("query",function(){return b}))},clearSelection:function(){this.grid.clearSelection();this.selectionRows=[];this.grid.set("query",{});this.graphicsLayer.clear();this.setSelectedNumber();
this.emit("clear-selection")},exportToCSV:function(){return this._getExportData().then(u.hitch(this,function(a){if(this.domNode)return F.createCSVStr(a.data,a.outFields,a.pk,a.types)}))},toggleColumns:function(){this.grid&&this.grid._toggleColumnHiderMenu()},changeHeight:function(a){this.grid&&0<=a-this.noGridHeight-this.footerHeight&&f.setStyle(this.grid.domNode,"height",a-this.noGridHeight-this.footerHeight+"px")},showGraphic:function(){this.graphicsLayer&&this.graphicsLayer.show()},hideGraphic:function(){this.graphicsLayer&&
this.graphicsLayer.hide()},isSupportQueryToServer:function(){var a=this.layer&&"esri.layers.CSVLayer"===this.layer.declaredClass,b=this.layer&&"esri.layers.StreamLayer"===this.layer.declaredClass;return this.layer&&this.layer.url&&this.configedInfo.layer.url&&!a&&!b},isSupportQueryOnClient:function(){var a=this.layer&&"esri.layers.CSVLayer"===this.layer.declaredClass,b=this.layer&&"esri.layers.StreamLayer"===this.layer.declaredClass;return!(this.layer&&this.layer.url&&this.configedInfo.layer.url)||
a||b},destroy:function(){this.layer=this.parentWidget=this.configedInfo=this.layerInfo=null;this.graphicsLayer&&this.graphicsLayer.clear&&(this.graphicsLayer.clear(),this.map.removeLayer(this.graphicsLayer));this.grid&&this.grid.destroy();this.nls=this.map=null;this._currentDef&&!this._currentDef.isCanceled()&&this._currentDef.cancel({canceledBySelf:!0});this.inherited(arguments)},_getLayerObject:function(){return(this._currentDef=this.layerInfo.getLayerObject()).then(u.hitch(this,function(a){var b=
new k;"esri.layers.ArcGISImageServiceLayer"===a.declaredClass||"esri.layers.ArcGISImageServiceVectorLayer"===a.declaredClass?(a=new g(a.url),this.own(x(a,"load",u.hitch(this,function(a){b.resolve(a.layer)})))):b.resolve(a);return b}))},_doQuery:function(a){if(this.layer){var b=this.getSelectedRows(),e=this.layer.objectIdField;this.isSupportQueryToServer()?this._queryToServer(a,e,b):this.isSupportQueryOnClient()&&this._queryOnClient(a,e,b)}},_queryOnClient:function(C,e,g){var c={};c.features="esri.layers.StreamLayer"===
this.layer.declaredClass?this.layer.getLatestObservations():this.layer.graphics;var f=this.layer.fields,d=this.configedInfo.layer.fields;c.fields=d?y.filter(d,u.hitch(this,function(b){a.isDefined(b.show)||(b.show=!0);b.name===e&&"esriFieldTypeOID"===b.type&&(b._pk=!0);for(var C=0,g=f.length;C<g;C++)f[C].name===b.name&&!b.type&&(b.type=f[C].type);return b.show||b._pk})):y.filter(f,u.hitch(this,function(b){a.isDefined(b.show)||(b.show=!0);b.name===e&&"esriFieldTypeOID"===b.type&&(b._pk=!0);return b.show||
b._pk}));for(var d=[],k=c.features.length,h=0;h<k;h++)c&&(c.features&&c.features[h]&&c.features[h].geometry)&&d.push(c.features[h].geometry);c.selectionRows=g;C&&s.defaults.geometryService&&0<d.length?(k=new b,k.geometries1=d,k.geometries2=[C],k.relation=b.SPATIAL_REL_INTERSECTION,(this._currentDef=s.defaults.geometryService.relation(k,u.hitch(this,function(a){return a}))).then(u.hitch(this,function(a,b){for(var C=b.length,e=[],c=0;c<C;c++)e.push(a.features[b[c].geometry1Index]);a.features=e;this.queryExecute(g,
a.fields,a.features.length,!1,a)},c),u.hitch(this,function(a){console.error(a);this.loading.hide()}))):this.queryExecute(g,c.fields,c.features.length,!1,c)},_queryToServer:function(b,e,g){this._getFeatureCount(b).then(u.hitch(this,function(c){if(this.domNode){var f=this.layer,d=a.isDefined(f.maxRecordCount)?f.maxRecordCount:1E3;this._batchCount=Math.min(d,this._defaultBatchCount);if(c<d)this._queryFeatureLayer(b,e,g,c,!1);else{var k=this._getOutFieldsFromLayerInfos(e),h={fields:this.layer.fields};
this.layer._recordCounts=c;f.advancedQueryCapabilities&&f.advancedQueryCapabilities.supportsPagination?this.queryExecute(g,k,c,!0,h,b):this._getFeatureIds(e,b).then(u.hitch(this,function(a){this.domNode&&(this.layer._objectIds=a,this.queryExecute(g,k,c,!0,h))}))}}}))},_getFeatureCount:function(a){var b=new k,e=new v;e.returnGeometry=!1;e.where=this._getLayerFilterExpression();a&&(e.geometry=a);(this._currentDef=this.layer.queryCount(e)).then(u.hitch(this,function(a){b.resolve(a)}),u.hitch(this,function(a){console.error(a);
console.log("Could not get feature count.");b.reject(a)}));return b},_queryFeatureLayer:function(a,b,e,g,c){var f=new w(this.configedInfo.layer.url),d=new v;d.where=this._getLayerFilterExpression();var k=this._getOutFieldsFromLayerInfos(b);0<k.length?(b=y.map(k,function(a){return a.name}),d.outFields=b):d.outFields=["*"];a&&(d.geometry=a,d.spatialRelationship=v.SPATIAL_REL_INTERSECTS);d.outSpatialReference=u.clone(this.map.spatialReference);d.returnGeometry=!1;(this._currentDef=f.execute(d,u.hitch(this,
function(a){return a}))).then(u.hitch(this,function(a){this.queryExecute(e,k,g,c,a)}),u.hitch(this,function(a){console.error(a);this.loading.hide()}))},_getFeatureIds:function(a,b){var e=new k,g=new v;g.returnGeometry=!1;g.returnIdsOnly=!0;g.where=this._getLayerFilterExpression();g.orderByFields=this.layer._orderByFields||[a+" ASC"];b&&(g.geometry=b);(this._currentDef=this.layer.queryIds(g)).then(u.hitch(this,function(a){e.resolve(a)}),u.hitch(this,function(a){console.error(a);console.log("Could not get feature Ids");
e.resolve([])}));return e},queryExecute:function(a,b,e,g,c,f){var d=[],d=null,k={};if(this.domNode){c.fields=this._processExecuteFields(this.layer.fields,b);g?d=F.generateCacheStore(this.layer,e,this._batchCount,this._getLayerFilterExpression(),f):(d=y.map(c.features,u.hitch(this,function(a){return u.clone(a.attributes)})),d=F.generateMemoryStore(d,this.layer.objectIdField));b=this.layer;f=b.advancedQueryCapabilities&&b.advancedQueryCapabilities.supportsPagination;k=F.generateColumnsFromFields(c.fields,
b.typeIdField,b.types,b.advancedQueryCapabilities&&b.advancedQueryCapabilities.supportsOrderBy&&f||!g);this.createTable(k,d,e);if(a&&a.length){for(var h in a)this.grid.select(a[h]);this.selectionRows=a;this.setSelectedNumber()}this.emit("data-loaded")}},createTable:function(a,b,e){if(this.grid)this.grid.set("store",b),this.grid.refresh();else{var g={};g.columns=a;g.store=b;g.keepScrollPosition=!0;g.pagingDelay=1E3;this.grid=new (m([l,h,d,p,c]))(g,f.create("div"));f.place(this.grid.domNode,this.domNode);
this.grid.startup();this.grid._clickShowSelectedRecords=!1;this.own(x(this.grid,".dgrid-row:click",u.hitch(this,this._onRowClick)));this.own(x(this.grid,".dgrid-row:dblclick",u.hitch(this,function(){this.layerInfo&&this.layerInfo.isShowInMap()&&this._zoomToSelected()})));this.own(x(this.grid,"dgrid-refresh-complete",u.hitch(this,this._onRefreshComplete)))}this.footer?f.empty(this.footer):this.footer=f.create("div",null,this.domNode);a=f.create("div",{"class":"dgrid-status self-footer",innerHTML:e+
"\x26nbsp;"+this.nls.features+"\x26nbsp;"},this.footer);this.selectedRowsLabel=f.create("div",{"class":"dgrid-status self-footer",innerHTML:"0\x26nbsp;"+this.nls.selected+"\x26nbsp;"},a,"after");a=f.getStyle(this.parentWidget.domNode,"height");this.changeHeight(a);this._requestStatus="fulfilled";this.configedInfo.opened=!0;this.loading.hide()},_getExportData:function(){if(this.layerInfo&&this.layer){var a=new k,b=null,e=this.layer.objectIdField,g=this.layer.types,c=this.getSelectedRowsData(),b=this._getOutFieldsFromLayerInfos(e),
b=this._processExecuteFields(this.layer.fields,b);c&&0<c.length?a.resolve({data:c,outFields:b,pk:e,types:g}):(c=this.grid.store,c instanceof q?(c=c.data,a.resolve({data:c,outFields:b,pk:e,types:g})):this._getExportDataFromServer(b).then(u.hitch(this,function(c){a.resolve({data:c,outFields:b,pk:e,types:g})})));return a}},_getExportDataFromServer:function(a){var b=new k,e=new w(this.layer.url),g=new v;g.where=this._getLayerFilterExpression();0<a.length?(a=y.map(a,function(a){return a.name}),g.outFields=
a):g.outFields=["*"];g.outSpatialReference=u.clone(this.map.spatialReference);g.returnGeometry=!1;e.execute(g,u.hitch(this,function(a){this.domNode&&(a=y.map(a.features,function(a){return a.attributes}),b.resolve(a))}),u.hitch(this,function(a){console.error(a);b.resolve([])}));return b},getSelectedRowsData:function(){if(!this.grid)return null;var a=this.layer.objectIdField,b=this.grid.store,e=b._entityData||b.data,b=this.getSelectedRows();return y.map(b,u.hitch(this,function(b){for(var g=0,c=e.length;g<
c;g++)if(e[g]&&e[g][a]===b)return e[g];return{}}))||[]},setSelectedNumber:function(){if(this.selectedRowsLabel&&this.grid){var a=this.getSelectedRows();this.selectedRowsLabel.innerHTML="\x26nbsp;\x26nbsp;"+a.length+" "+this.nls.selected+"\x26nbsp;\x26nbsp;"}},selectFeatures:function(a,b){b&&0<b.length?("rowclick"===a||"selectall"===a?this.addGraphics(b,!0):"zoom"===a&&this.getExtent(b).then(u.hitch(this,function(a){if(a)if("point"===a.type){var b=15,b=-1<this.map.getMaxZoom()?this.map.getMaxZoom():
0.1;this.map.centerAndZoom(a,b)}else this.map.setExtent(a.expand(1.1))}),u.hitch(this,function(a){console.error(a)})),this.setSelectedNumber()):this._popupMessage(this.nls.dataNotAvailable)},getGraphicsFromLocalFeatureLayer:function(a){for(var b=[],e,g,c=a.length,d=this.layer.graphics.length,f=this.layer.objectIdField,k=0;k<c;k++)for(var h=0;h<d;h++)if(e=this.layer.graphics[h].attributes[f]+"",g=a[k]+"",e===g){b.push(this.layer.graphics[h]);break}return b},addGraphics:function(a){var b,e,g=a.length;
this.graphicsLayer.clear();for(var c=new D(D.STYLE_SOLID,new J([0,255,255]),2),d=0;d<g;d++)e=null,a[d].geometry?(a[d].geometry.spatialReference.equals(this.map.spatialReference)||console.warn("unable to draw graphic result in different wkid from map"),"point"===a[d].geometry.type?(e=new I(a[d].geometry.toJson()),b=u.clone(this.map.infoWindow.markerSymbol)):"multipoint"===a[d].geometry.type?(e=new H(a[d].geometry.toJson()),b=u.clone(this.map.infoWindow.markerSymbol)):"polyline"===a[d].geometry.type?
(e=new K(a[d].geometry.toJson()),b=c):"polygon"===a[d].geometry.type&&(e=new E(a[d].geometry.toJson()),b=new A(A.STYLE_SOLID,c,new J([255,255,255,0.25]))),e=new z(e,b,a[d].attributes,a[d].infoTemplate),this.graphicsLayer.add(e)):console.error("unable to get geometry of the reocord: ",a[d])},getExtent:function(a){var b=new k,e,g,c=a.length;if(1===c&&a[0].geometry&&"point"===a[0].geometry.type)e=a[0].geometry;else{if(1===c&&!a[0].geometry)return b.reject(Error("AttributeTable.getExtent:: extent was not projected.")),
b;for(var d=0;d<c;d++)a[d].geometry?"point"===a[d].geometry.type?(g||(g=new H(a[d].geometry.spatialReference)),g.addPoint(a[d].geometry),d===c-1&&(e=g.getExtent())):e=e?e.union(a[d].geometry.getExtent()):a[d].geometry.getExtent():console.error("unable to get geometry of the reocord: ",a[d])}if(!e||!e.spatialReference)return b.reject(Error("AttributeTable.getExtent:: extent was not projected.")),b;a=this.map.spatialReference;e.spatialReference.equals(a)?b.resolve(e):(g=new G,g.geometries=[e],g.outSR=
a,s.defaults.geometryService.project(g,u.hitch(this,function(a){this.domNode&&(a&&a.length?b.resolve(a[0]):b.reject(Error("AttributeTable.getExtent:: extent was not projected.")))}),u.hitch(this,function(a){a||(a=Error("AttributeTable.getExtent:: extent was not projected."));b.reject(a)})));return b},_onRefreshComplete:function(a){if(a.grid._clickShowSelectedRecords){var b=this.selectionRows;y.forEach(b,u.hitch(this,function(b){a.grid.select(b)}));a.grid._clickShowSelectedRecords=!1;this.isSupportQueryToServer()?
this._queryFeaturesByIds(b,"selectall"):this.isSupportQueryOnClient()&&this.selectFeatures("selectall",this.getGraphicsFromLocalFeatureLayer(b))}},_zoomToSelected:function(){if(this.configedInfo){var a=this._getSelectedIds();0!==a.length&&(this.isSupportQueryToServer()?this._queryFeaturesByIds(a,"zoom"):this.isSupportQueryOnClient()&&this.selectFeatures("zoom",this.getGraphicsFromLocalFeatureLayer(a)))}},_queryFeaturesByIds:function(a,b){var e=new v;e.objectIds=a;e.returnGeometry=!0;e.outSpatialReference=
u.clone(this.map.spatialReference);e.outFields=["*"];var c=this.layer,d="esri.layers.CSVLayer"===c.declaredClass;c.url&&!d?(new w(c.url)).execute(e,u.hitch(this,function(a){this.selectFeatures(b,a.features)}),u.hitch(this,this._errorSelectFeatures)):c.selectFeatures(e,g.SELECTION_NEW,u.hitch(this,this.selectFeatures,b),u.hitch(this,this._errorSelectFeatures))},_onRowClick:function(){var a=this._getSelectedIds();this.selectionRows=a;a.length?this.isSupportQueryToServer()?this._queryFeaturesByIds(a,
"rowclick"):this.isSupportQueryOnClient()&&this.selectFeatures("rowclick",this.getGraphicsFromLocalFeatureLayer(a)):this.graphicsLayer.clear();this.setSelectedNumber();this.emit("row-click",{table:this,selectedIds:a})},_onExtentChange:function(a){this.matchingMap&&this.actived&&this.startQuery(a.extent)},_getLayerFilterExpression:function(){var a=this._filterObj&&this._filterObj.expr||"",b=this.layerInfo.getFilterOfWebmap();return a?b?a+" AND "+b:a:b?b:"1\x3d1"},_getOutFieldsFromLayerInfos:function(b){var e=
this.configedInfo.layer.fields,g=[];e&&y.forEach(e,u.hitch(this,function(e){a.isDefined(e.show)||(e.show=!0);if(e.name===b&&("esriFieldTypeOID"===e.type||!e.type))e._pk=!0;(e.show||e._pk)&&g.push(e)}));return g},_processExecuteFields:function(a,b){if(a&&0<a.length){var e=[];if(!b.length)return a;for(var g=0,c=b.length;g<c;g++)for(var d=0;d<a.length;d++)if(b[g].name===a[d].name&&(b[g].type===a[d].type||!b[g].type))a[d]=u.mixin(a[d],b[g]),e.push(a[d]);return e}return b},_getSelectedIds:function(){var a=
[],b=this.grid.selection,e;for(e in b)b[e]&&(isFinite(e)?a.push(parseInt(e,10)):a.push(e));return a},_errorQueryTask:function(a){this._popupMessage(a.message)},_errorGeometryServices:function(a){this._popupMessage(a.message)},_errorSelectFeatures:function(a){this._popupMessage(a.message)},_popupMessage:function(a){var b=new r({message:a,buttons:[{label:this.nls.ok,onClick:u.hitch(this,function(){b.close()})}]});this.loading.hide()}})})},"dgrid/extensions/ColumnHider":function(){define("dojo/_base/declare dojo/has dojo/on ../util/misc put-selector/put dojo/i18n!./nls/columnHider xstyle/css!../css/extensions/ColumnHider.css".split(" "),
function(m,f,n,r,l,h){var d,p,c=f("ie"),k=c&&f("quirks"),t=8>c||k?"htmlFor":"for";return m("dgrid.extensions.ColumnHider",null,{hiderMenuNode:null,hiderToggleNode:null,i18nColumnHider:h,_hiderMenuOpened:!1,_columnHiderRules:null,_columnHiderCheckboxes:null,_renderHiderMenuEntries:function(){var c=this.subRows,d=!0,a,b,e,g;delete this._columnHiderFirstCheckbox;e=0;for(a=c.length;e<a;e++){g=0;for(b=c[e].length;g<b;g++)this._renderHiderMenuEntry(c[e][g]),d&&(d=!1,this._columnHiderFirstCheckbox=this._columnHiderCheckboxes[c[e][g].id])}},
_renderHiderMenuEntry:function(c){var d=c.id,a=r.escapeCssIdentifier(d,"-"),b,e;c.hidden&&(c.hidden=!1,this._hideColumn(d),c.hidden=!0);c.unhidable||(b=l("div.dgrid-hider-menu-row"),e=this.domNode.id+"-hider-menu-check-"+a,d=this._columnHiderCheckboxes[d]=l(b,"input.dgrid-hider-menu-check.hider-menu-check-"+a+"[type\x3dcheckbox]"),d.id=e,l(b,"label.dgrid-hider-menu-label.hider-menu-label-"+a+"["+t+"\x3d"+e+"]",c.label||c.field||""),l(this.hiderMenuNode,b),c.hidden||(d.checked=!0))},renderHeader:function(){function f(a){a.stopPropagation()}
var h=this,a=this.hiderMenuNode,b=this.hiderToggleNode,e;this.inherited(arguments);if(a){for(e in this._columnHiderRules)this._columnHiderRules[e].remove();a.innerHTML=""}else b=this.hiderToggleNode=l(this.domNode,"button.ui-icon.dgrid-hider-toggle[type\x3dbutton][aria-label\x3d"+this.i18nColumnHider.popupTriggerLabel+"]"),this._listeners.push(n(b,"click",function(a){h._toggleColumnHiderMenu(a)})),a=this.hiderMenuNode=l("div.dgrid-hider-menu[role\x3ddialog][aria-label\x3d"+this.i18nColumnHider.popupLabel+
"]"),a.id=this.id+"-hider-menu",this._listeners.push(n(a,"keyup",function(a){if(27===(a.charCode||a.keyCode))h._toggleColumnHiderMenu(a),b.focus()})),a.style.display="none",l(this.domNode,a),this._listeners.push(n(a,".dgrid-hider-menu-check:"+(9>c||k?"click":"change"),function(a){h._updateColumnHiddenState(a.target.id.substr(h.id.length+18),!a.target.checked)})),this._listeners.push(n(a,"mousedown",f),n(b,"mousedown",f)),p||(p=n.pausable(document,"mousedown",function(a){d&&d._toggleColumnHiderMenu(a)}),
p.pause());this._columnHiderCheckboxes={};this._columnHiderRules={};this._renderHiderMenuEntries()},destroy:function(){this.inherited(arguments);for(var c in this._columnHiderRules)this._columnHiderRules[c].remove()},left:function(c,d){return this.right(c,-d)},right:function(c,d){c.element||(c=this.cell(c));for(var a=this.inherited(arguments),b=c;a.column.hidden;){a=this.inherited(arguments,[a,0<d?1:-1]);if(b.element===a.element)return c;b=a}return a},isColumnHidden:function(c){return!!this._columnHiderRules[c]},
_toggleColumnHiderMenu:function(){var c=this._hiderMenuOpened,f=this.hiderMenuNode,a=this.domNode,b;f.style.display=c?"none":"";c?f.style.height="":(f.offsetHeight>a.offsetHeight-12&&(f.style.height=a.offsetHeight-12+"px"),(b=this._columnHiderFirstCheckbox)&&b.focus());p[c?"pause":"resume"]();d=c?null:this;this._hiderMenuOpened=!c},_hideColumn:function(c){var d=this,a="#"+r.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-",b;if(!this._columnHiderRules[c]&&(this._columnHiderRules[c]=r.addCssRule(a+
r.escapeCssIdentifier(c,"-"),"display: none;"),(8===f("ie")||10===f("ie"))&&!f("quirks")))b=r.addCssRule(".dgrid-row-table","display: inline-table;"),window.setTimeout(function(){b.remove();d.resize()},0)},_showColumn:function(c){this._columnHiderRules[c]&&(this._columnHiderRules[c].remove(),delete this._columnHiderRules[c])},_updateColumnHiddenState:function(c,d){this[d?"_hideColumn":"_showColumn"](c);this.columns[c].hidden=d;n.emit(this.domNode,"dgrid-columnstatechange",{grid:this,column:this.columns[c],
hidden:d,bubbles:!0});this.resize()},toggleColumnHiddenState:function(c,d){"undefined"===typeof d&&(d=!this._columnHiderRules[c]);this._updateColumnHiddenState(c,d);this._columnHiderCheckboxes[c].checked=!d}})})},"dgrid/extensions/ColumnResizer":function(){define("dojo/_base/declare dojo/on dojo/query dojo/_base/lang dojo/dom dojo/dom-geometry dojo/has ../util/misc put-selector/put dojo/_base/html xstyle/css!../css/extensions/ColumnResizer.css".split(" "),function(m,f,n,r,l,h,d,p,c){function k(a){for(var e=
a.length,c=e,d=a[0].length,f=Array(e);e--;)f[e]=Array(d);for(var k={},e=0;e<c;e++)for(var h=f[e],l=a[e],p=0,m=0;p<d;p++){var q=l[m],s;if("undefined"==typeof h[p]){h[p]=q.id;if(q.rowSpan&&1<q.rowSpan){s=f;for(var r=q.rowSpan,n=e,t=p,u=q.id,x=1;x<r;x++)s[n+x][t]=u}if(0<e&&q.colSpan&&1<q.colSpan)for(s=1;s<q.colSpan;s++)if(h[++p]=q.id,q.rowSpan&&1<q.rowSpan)for(var r=f,n=q.rowSpan,t=e,u=p,x=q.id,y=1;y<n;y++)r[t+y][u]=x;k[q.id]=a[0][p].id;m++}}return k}function t(a,e,c,d,k){if(!(0>=c)){var h=a.columns[e],
l;if(h&&(l={grid:a,columnId:e,width:c,bubbles:!0,cancelable:!0},d&&(l.parentType=d),!a._resizedColumns||f.emit(a.headerNode,"dgrid-columnresize",l)))return"auto"===c?delete h.width:(h.width=c,c+="px"),(d=a._columnSizes[e])?d.set("width",c):d=p.addCssRule("#"+p.escapeCssIdentifier(a.domNode.id)+" .dgrid-column-"+p.escapeCssIdentifier(e,"-"),"width: "+c+";"),a._columnSizes[e]=d,!1!==k&&a.resize(),!0}}var q,s=0,a={create:function(){q=c("div.dgrid-column-resizer")},destroy:function(){c(q,"!");q=null},
show:function(a){a=h.position(a.domNode,!0);q.style.top=a.y+"px";q.style.height=a.h+"px";c(document.body,q)},move:function(a){q.style.left=a+"px"},hide:function(){q.parentNode.removeChild(q)}};return m("dgrid.extensions.ColumnResizer",null,{resizeNode:null,minWidth:40,adjustLastColumn:!0,_resizedColumns:!1,buildRendering:function(){this.inherited(arguments);s++||a.create()},destroy:function(){this.inherited(arguments);for(var b in this._columnSizes)this._columnSizes[b].remove();--s||a.destroy()},
resizeColumnWidth:function(a,e){return t(this,a,e)},configStructure:function(){var a=this._oldColumnSizes=r.mixin({},this._columnSizes),e;this._resizedColumns=!1;this._columnSizes={};this.inherited(arguments);for(e in a)e in this._columnSizes||a[e].remove();delete this._oldColumnSizes},_configColumn:function(a){this.inherited(arguments);var e=a.id,c;"width"in a&&((c=this._oldColumnSizes[e])?c.set("width",a.width+"px"):c=p.addCssRule("#"+p.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+p.escapeCssIdentifier(e,
"-"),"width: "+a.width+"px;"),this._columnSizes[e]=c)},renderHeader:function(){this.inherited(arguments);var a=this,e;if(this.columnSets&&this.columnSets.length)for(var g=this.columnSets.length;g--;)e=r.mixin(e||{},k(this.columnSets[g]));else this.subRows&&1<this.subRows.length&&(e=k(this.subRows));for(var g=n(".dgrid-cell",a.headerNode),h=g.length;h--;){var l=g[h],q=l.columnId,m=a.columns[q],s=l.childNodes;if(m&&!1!==m.resizable){m=c("div.dgrid-resize-header-container");for(l.contents=m;0<s.length;)c(m,
s[0]);l=c(l,m,"div.dgrid-resize-handle.resizeNode-"+p.escapeCssIdentifier(q,"-"));l.columnId=e&&e[q]||q}}a.mouseMoveListen||(f(a.headerNode,".dgrid-resize-handle:mousedown"+(d("touch")?",.dgrid-resize-handle:touchstart":""),function(e){a._resizeMouseDown(e,this);a.mouseMoveListen.resume();a.mouseUpListen.resume()}),a._listeners.push(a.mouseMoveListen=f.pausable(document,"mousemove"+(d("touch")?",touchmove":""),p.throttleDelayed(function(e){a._updateResizerPosition(e)}))),a._listeners.push(a.mouseUpListen=
f.pausable(document,"mouseup"+(d("touch")?",touchend":""),function(e){a._resizeMouseUp(e);a.mouseMoveListen.pause();a.mouseUpListen.pause()})),a.mouseMoveListen.pause(),a.mouseUpListen.pause())},_resizeMouseDown:function(b,e){b.preventDefault();l.setSelectable(this.domNode,!1);this._startX=this._getResizeMouseLocation(b);this._targetCell=n(".dgrid-column-"+p.escapeCssIdentifier(e.columnId,"-"),this.headerNode)[0];this._updateResizerPosition(b);a.show(this)},_resizeMouseUp:function(b){var e=this._columnSizes,
c,d,f;this.adjustLastColumn&&(f=this.headerNode.clientWidth-1);this._resizedColumns||(c=n(".dgrid-cell",this.headerNode),this.columnSets&&this.columnSets.length?c=c.filter(function(a){return"0"==a.columnId.split("-")[0]&&!(a.columnId in e)}):this.subRows&&1<this.subRows.length&&(c=c.filter(function(a){return"0"==a.columnId.charAt(0)&&!(a.columnId in e)})),d=c.map(function(a){return a.offsetWidth}),c.forEach(function(a,b){t(this,a.columnId,d[b],null,!1)},this),this._resizedColumns=!0);l.setSelectable(this.domNode,
!0);c=this._targetCell;var k=this._getResizeMouseLocation(b)-this._startX,h=c.offsetWidth+k,q=this._getResizedColumnWidths(),m=q.totalWidth,q=q.lastColId,s=n(".dgrid-column-"+p.escapeCssIdentifier(q,"-"),this.headerNode)[0].offsetWidth;h<this.minWidth&&(h=this.minWidth);t(this,c.columnId,h,b.type)&&c.columnId!=q&&this.adjustLastColumn&&(m+k<f?t(this,q,"auto",b.type):s-k<=this.minWidth&&t(this,q,this.minWidth,b.type));a.hide();delete this._startX;delete this._targetCell},_updateResizerPosition:function(b){if(this._targetCell){b=
this._getResizeMouseLocation(b);var e=this._targetCell.offsetWidth,c=b;e+(b-this._startX)<this.minWidth&&(c=this._startX-(e-this.minWidth));a.move(c)}},_getResizeMouseLocation:function(a){var e=0;a.pageX?e=a.pageX:a.clientX&&(e=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft);return e},_getResizedColumnWidths:function(){var a=0,e=n((this.columnSets?".dgrid-column-set-cell ":"")+"tr:first-child .dgrid-cell",this.headerNode),c=e.length;if(!c)return{};for(var d=e[c-1].columnId;c--;)a+=
e[c].offsetWidth;return{totalWidth:a,lastColId:d}}})})},"dgrid/extensions/ColumnReorder":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/array dojo/on dojo/query dojo/dnd/Source put-selector/put xstyle/css!../css/extensions/ColumnReorder.css".split(" "),function(m,f,n,r,l,h,d){function p(c,d){var a=d[2],b=c[a?"columnSets":"subRows"][d[1]];return a?b[d[2]]:b}function c(c,d,a){d[2]?c.columnSets[d[1]][d[2]]=a:c.subRows[d[1]]=a}function k(c,d){return d.slice(("dgrid-"+c+"-").length)}
var t=/(\d+)(?:-(\d+))?$/;m=f(h,{copyState:function(){return!1},checkAcceptance:function(c,d){return c==this},_legalMouseDown:function(c){return-1<c.target.className.indexOf("dgrid-resize-handle")?!1:this.inherited(arguments)},onDropInternal:function(d){var f=this.grid,a=t.exec(k(f.id,d[0].getAttribute("dndType"))),b=a[2]?"columnSets":"subRows",e=p(f,a),g=f.columns;this.inherited(arguments);a&&setTimeout(function(){var k=n.map(d[0].parentNode.childNodes,function(a){return g[a.columnId]});c(f,a,k);
k={grid:f,subRow:k,column:g[d[0].columnId],bubbles:!0,cancelable:!0,parentType:"dnd"};k[b]=f[b];r.emit(f.domNode,"dgrid-columnreorder",k)?f.set(b,f[b]):(c(f,a,e),f.renderHeader(),this._sort&&this._sort.length&&this.updateSortArrow(this._sort))},0)}});f=f("dgrid.extensions.ColumnReorder",null,{columnDndConstructor:m,_initSubRowDnd:function(c,f){var a,b,e,g;b=0;for(e=c.length;b<e;b++)g=c[b],!1!==g.reorderable&&(g=g.headerNode,"TH"!=g.tagName&&(g=g.parentNode),d(g,".dojoDndItem[dndType\x3d"+f+"]"),a||
(a=g.parentNode));a&&this._columnDndSources.push(new this.columnDndConstructor(a,{horizontal:!0,grid:this}))},renderHeader:function(){var c="dgrid-"+this.id+"-",d,a;this.inherited(arguments);this._columnDndSources=[];if(this.columnSets){a=0;for(d=this.columnSets.length;a<d;a++)n.forEach(this.columnSets[a],function(b,e){this._initSubRowDnd(b,c+a+"-"+e)},this)}else n.forEach(this.subRows,function(a,e){this._initSubRowDnd(a,c+e)},this)},_destroyColumns:function(){this._columnDndSources&&n.forEach(this._columnDndSources,
function(c){c.destroy()});this.inherited(arguments)}});f.ColumnDndSource=m;return f})},"esri/tasks/RelationParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../geometry/jsonUtils".split(" "),function(m,f,n,r,l,h,d){m=m(null,{declaredClass:"esri.tasks.RelationParameters",geometries1:null,geometries2:null,relation:null,relationParam:null,toJson:function(){var f=n.map(this.geometries1,function(c){return c.toJson()}),c=n.map(this.geometries2,
function(c){return c.toJson()}),k={},h=this.geometries1;h&&0<h.length&&(k.geometries1=r.toJson({geometryType:d.getJsonType(h[0]),geometries:f}),f=this.geometries1[0].spatialReference,k.sr=f.wkid?f.wkid:r.toJson(f.toJson()));if((f=this.geometries2)&&0<f.length)k.geometries2=r.toJson({geometryType:d.getJsonType(f[0]),geometries:c});this.relation&&(k.relation=this.relation);this.relationParam&&(k.relationParam=r.toJson(this.relationParam));return k}});f.mixin(m,{SPATIAL_REL_CROSS:"esriGeometryRelationCross",
SPATIAL_REL_DISJOINT:"esriGeometryRelationDisjoint",SPATIAL_REL_IN:"esriGeometryRelationIn",SPATIAL_REL_INTERIORINTERSECTION:"esriGeometryRelationInteriorIntersection",SPATIAL_REL_INTERSECTION:"esriGeometryRelationIntersection",SPATIAL_REL_COINCIDENCE:"esriGeometryRelationLineCoincidence",SPATIAL_REL_LINETOUCH:"esriGeometryRelationLineTouch",SPATIAL_REL_OVERLAP:"esriGeometryRelationOverlap",SPATIAL_REL_POINTTOUCH:"esriGeometryRelationPointTouch",SPATIAL_REL_TOUCH:"esriGeometryRelationTouch",SPATIAL_REL_WITHIN:"esriGeometryRelationWithin",
SPATIAL_REL_RELATION:"esriGeometryRelationRelation"});return m})},"widgets/AttributeTable/utils":function(){define("dojo/_base/lang dojo/_base/array jimu/LayerInfos/LayerInfos dojo/Deferred dojo/promise/all exports dojo/store/Observable dojo/store/Cache dojo/store/Memory esri/lang ./FeatureLayerQueryStore jimu/utils".split(" "),function(m,f,n,r,l,h,d,p,c,k,t,q){function s(a){var b=[],e=[];f.forEach(a,function(c){var d=b.indexOf(c.name);0>d?b.push(c.name):(e.push(a[d]),e.push(c))});f.forEach(e,function(a){a.name=
a.name+"-"+a.id})}h.readLayerInfosObj=function(a){return n.getInstance(a,a.itemInfo)};h.readLayerInfosFromMap=function(a){var b=new r;n.getInstance(a,a.itemInfo).then(m.hitch(this,function(a){var c=[];a.traversal(m.hitch(this,function(a){c.push(a)}));a=a.getTableInfoArray();c=c.concat(a);b.resolve(c)}),m.hitch(this,function(a){console.error(a);b.reject(a)}));return b.promise};h.createCSVStr=function(a,b,c,d){var k=new r,l="",p=0,m=0,q="",n="";try{f.forEach(b,function(a){l=l+q+(a.alias||a.name);q=
","});for(var l=l+"\r\n",p=a.length,m=b.length,s=0;s<p;s++){for(var q="",t=0;t<m;t++){var D=b[t],n=h.getExportValue(a[s][D.name],D,c,a[s][c],d);!n&&"number"!==typeof n&&(n="");n&&/[",\r\n]/g.test(n)&&(n='"'+n.replace(/(")/g,'""')+'"');l=l+q+n;q=","}l+="\r\n"}k.resolve(l)}catch(A){console.error(A),k.resolve("")}return k};h.getExportValue=function(a,b,c,d,k){var l=!!b.domain,p="esriFieldTypeDate"===b.type,m=c&&b.name===c;return p?h.dateFormatter(a):l?h.getCodeValue(b.domain,a):!l&&!p&&!m?(l=null,c&&
k&&0<k.length&&(c=f.filter(k,function(a){return a.name===d}))&&(c.domains&&c.domains[b.name]&&c.domains[b.name].codedValues)&&(l=h.getCodeValue(c.domains[b.name],a)),null!==l?l:a):a};h.generateColumnsFromFields=function(a,b,c,d){var l={};f.forEach(a,m.hitch(h,function(p,q){var n="field"+q,r=!!p.domain,s="esriFieldTypeDate"===p.type,t=b&&p.name===b;l[n]={label:p.alias||p.name,className:n,hidden:!p.show&&k.isDefined(p.show),unhidable:!p.show&&k.isDefined(p.show)&&p._pk,field:p.name};l[n].sortable=!!d;
if("esriFieldTypeString"===a[q].type)l[n].formatter=m.hitch(h,h.urlFormatter);else if("esriFieldTypeDate"===a[q].type)l[n].formatter=m.hitch(h,h.dateFormatter);else if("esriFieldTypeDouble"===a[q].type||"esriFieldTypeSingle"===a[q].type||"esriFieldTypeInteger"===a[q].type||"esriFieldTypeSmallInteger"===a[q].type)l[n].formatter=m.hitch(h,h.numberFormatter);r?l[n].get=m.hitch(h,function(a,b){return this.getCodeValue(a.domain,b[a.name])},p):t?l[n].get=m.hitch(h,function(a,b,c){return this.getTypeName(c[a.name],
b)},p,c):!r&&(!s&&!t)&&(l[n].get=m.hitch(h,function(a,b,c,e){var d=null;b&&c&&0<c.length&&(c=(c=f.filter(c,m.hitch(h,function(a){return a.name===e[b]})))&&c[0]||null)&&(c.domains&&c.domains[a.name]&&c.domains[a.name].codedValues)&&(d=this.getCodeValue(c.domains[a.name],e[a.name]));return(a=null!==d?d:e[a.name])||isFinite(a)?a:""},p,b,c))}));return l};h.getTypeName=function(a,b){for(var c=b.length,d=0;d<c;d++)if(a===b[d].id)return b[d].name;return a};h.getCodeValue=function(a,b){if(a.codedValues){for(var c=
0,d=a.codedValues.length;c<d;c++){var f=a.codedValues[c];if(b===f.code)return f.name}return b}return b||null};h.urlFormatter=function(a){if(a&&"string"===typeof a){var b=a.indexOf("http:");-1===b&&(b=a.indexOf("https:"));if(-1<b&&-1===a.indexOf("href\x3d")){var c=a.indexOf(" ",b);-1===c&&(c=a.length);var d=a.substring(b,c);a=a.substring(0,b)+'\x3cA href\x3d"'+d+'" target\x3d"_blank"\x3e'+d+"\x3c/A\x3e"+a.substring(c,a.length)}}return a||""};h.dateFormatter=function(a){a&&(a=q.localizeDate(new Date(a),
{fullYear:!0}));return a||""};h.numberFormatter=function(a){if("number"===typeof a){var b=(a.toString().split(".")[1]||"").length;a=q.localizeNumber(a,{places:b});return'\x3cspan class\x3d"jimu-numeric-value"\x3e'+(a||"")+"\x3c/span\x3e"}return a};h.readLayerObjectsFromMap=function(a){var b=new r,c=[];this.readLayerInfosFromMap(a).then(m.hitch(this,function(a){f.forEach(a,m.hitch(this,function(a){c.push(a.getLayerObject())}));l(c).then(m.hitch(this,function(a){b.resolve(a)}),m.hitch(this,function(a){b.reject(a);
console.error(a)}))}),m.hitch(this,function(a){b.reject(a)}));return b.promise};h.readSupportTableInfoFromLayerInfos=function(a){var b=new r,c=[];f.forEach(a,m.hitch(this,function(a){c.push(a.getSupportTableInfo())}));l(c).then(m.hitch(this,function(c){c=m.clone(c);f.forEach(c,function(b,c){b.id=a[c].id});b.resolve(c)}),function(a){b.reject(a)});return b.promise};h.readConfigLayerInfosFromMap=function(a){var b=new r,c=[];this.readLayerInfosFromMap(a).then(m.hitch(this,function(a){var d=[];f.forEach(a,
function(a){c.push(a.getSupportTableInfo())});l(c).then(m.hitch(this,function(c){f.forEach(c,m.hitch(this,function(b,c){b.isSupportedLayer&&(a[c].name=a[c].title,d.push(a[c]))}));s(d);b.resolve(d)}),m.hitch(this,function(a){b.reject(a)}))}),m.hitch(this,function(a){b.reject(a)}));return b.promise};h.getConfigInfosFromLayerInfos=function(a){return f.map(a,function(a){return h.getConfigInfoFromLayerInfo(a)})};h.getConfigInfoFromLayerInfo=function(a){var b={};b.name=a.name||a.title;b.id=a.id;b.show=
a.isShowInMap();b.layer={url:a.getUrl()};if((a=a.getPopupInfo())&&!a.description)b.layer.fields=f.map(a.fieldInfos,function(a){return{name:a.fieldName,alias:a.label,show:a.visible}});return b};h.generateCacheStore=function(a,b,e,d,f){a=new t({layer:a,objectIds:a._objectIds||null,totalCount:b,batchCount:e,where:d||"1\x3d1",spatialFilter:f});b=new c;return new p(a,b,{})};h.generateMemoryStore=function(a,b){return new d(new c({data:a||[],idProperty:b}))}})},"dojo/store/Observable":function(){define(["../_base/kernel",
"../_base/lang","../when","../_base/array"],function(m,f,n,r){m=function(l){function h(c,d){var f=l[c];f&&(l[c]=function(a){var b;"put"===c&&(b=l.getIdentity(a));if(k)return f.apply(this,arguments);k=!0;try{var e=f.apply(this,arguments);n(e,function(c){d("object"==typeof c&&c||a,b)});return e}finally{k=!1}})}var d=[],p=0;l=f.delegate(l);l.notify=function(c,f){p++;for(var k=d.slice(),a=0,b=k.length;a<b;a++)k[a](c,f)};var c=l.query;l.query=function(k,h){h=h||{};var m=c.apply(this,arguments);if(m&&m.forEach){var a=
f.mixin({},h);delete a.start;delete a.count;var b=l.queryEngine&&l.queryEngine(k,a),e=p,g=[],w;m.observe=function(a,c){1==g.push(a)&&d.push(w=function(a,d){n(m,function(f){var k=f.length!=h.count,m,n;if(++e!=p)throw Error("Query is out of date, you must observe() the query prior to any data modifications");var v,s=-1,t=-1;if(void 0!==d){m=0;for(n=f.length;m<n;m++){var z=f[m];if(l.getIdentity(z)==d){v=z;s=m;(b||!a)&&f.splice(m,1);break}}}if(b){if(a&&(b.matches?b.matches(a):b([a]).length))m=-1<s?s:
f.length,f.splice(m,0,a),t=r.indexOf(b(f),a),f.splice(m,1),h.start&&0==t||!k&&t==f.length?t=-1:f.splice(t,0,a)}else a&&(void 0!==d?t=s:h.start||(t=l.defaultIndex||0,f.splice(t,0,a)));if((-1<s||-1<t)&&(c||!b||s!=t)){k=g.slice();for(m=0;f=k[m];m++)f(a||v,s,t)}})});var f={};f.remove=f.cancel=function(){var b=r.indexOf(g,a);-1<b&&(g.splice(b,1),g.length||d.splice(r.indexOf(d,w),1))};return f}}return m};var k;h("put",function(c,d){l.notify(c,d)});h("add",function(c){l.notify(c)});h("remove",function(c){l.notify(void 0,
c)});return l};f.setObject("dojo.store.Observable",m);return m})},"dojo/store/Cache":function(){define(["../_base/lang","../when"],function(m,f){var n=function(n,l,h){h=h||{};return m.delegate(n,{query:function(d,f){var c=n.query(d,f);c.forEach(function(c){(!h.isLoaded||h.isLoaded(c))&&l.put(c)});return c},queryEngine:n.queryEngine||l.queryEngine,get:function(d,h){return f(l.get(d),function(c){return c||f(n.get(d,h),function(c){c&&l.put(c,{id:d});return c})})},add:function(d,h){return f(n.add(d,h),
function(c){l.add(c&&"object"==typeof c?c:d,h);return c})},put:function(d,h){l.remove(h&&h.id||this.getIdentity(d));return f(n.put(d,h),function(c){l.put(c&&"object"==typeof c?c:d,h);return c})},remove:function(d,h){return f(n.remove(d,h),function(c){return l.remove(d,h)})},evict:function(d){return l.remove(d)}})};m.setObject("dojo.store.Cache",n);return n})},"widgets/AttributeTable/FeatureLayerQueryStore":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array esri/tasks/query esri/tasks/QueryTask ./FeatureLayerQueryResult".split(" "),
function(m,f,n,r,l,h){return m(null,{queryUrl:"",idProperty:"id",data:null,_entityData:null,constructor:function(d){m.safeMixin(this,d);this.data=[];this._entityData=[];this.layer=d.layer;this.objectIds=d.objectIds;this.where=d.where;this.orderByFields=d.orderByFields;this.totalCount=d.totalCount;this.batchCount=d.batchCount||25;this.idProperty=this.layer.objectIdField;this.spatialFilter=d.spatialFilter;this.layer&&this.layer.url&&(this.queryTask=new l(this.layer.url))},get:function(d){return this.data[d]},
getIdentity:function(d){return d[this.idProperty]},query:function(d,l){var c=new r,k=l&&l.start||0,m=this.batchCount,q=null;"function"===typeof d?q=d(this._entityData):"[object Array]"===Object.prototype.toString.call(d)&&(q=d);if(this.objectIds)q=q?q:this.objectIds,c.objectIds=q.length>=k+this.batchCount?q.slice(k,k+m):q.slice(k);else if(q&&0<q.length?c.objectIds=q.length>=k+this.batchCount?q.slice(k,k+m):q.slice(k):(c.start=k,c.num=m,c.where=this.where,c.geometry=this.spatialFilter,c.spatialRelationship=
r.SPATIAL_REL_INTERSECTS),(k=l.sort)&&0<k.length)k=n.map(k,function(a){return a.attribute+" "+(a.descending?"DESC":"ASC")}),c.orderByFields=k;c.returnGeometry=!1;c.outFields=["*"];var s=this.totalCount,k=null,k=!c.where;if(!(c.objectIds&&0<c.objectIds.length)&&k)return new h([]);k=this.queryTask?this.queryTask.execute(c):this.layer.queryFeatures(c);k.total=k.then(f.hitch(this,function(a){var b=0,e=this.layer.objectIdField;if(this.objectIds){if(!e)for(b=0;b<a.fields.length;b++)if("esriFieldTypeOID"===
a.fields[b].type){e=a.fields[b].name;break}for(var d={},b=0;b<a.features.length;b++)d[a.features[b].attributes[e]]=a.features[b];a.features=n.map(c.objectIds,function(a){return d[a]})}for(b=0;b<a.features.length;b++)a.features[b]&&(a.features[b]=a.features[b].attributes,this.data[a.features[b][e]]=a.features[b],this._entityData.push(a.features[b]));a=a.features;return s}),function(){console.log("FeatureLayerQueryStore queryFeatures failed.");return 0});return new h(k)}})})},"widgets/AttributeTable/FeatureLayerQueryResult":function(){define("esri/main dojo/_base/lang dojo/_base/kernel dojo/_base/Deferred dojo/DeferredList dojo/_base/array".split(" "),
function(m,f,n,r){var l=function(h){function d(d){h[d]||(h[d]=function(){var c=arguments;return r.when(h,function(f){Array.prototype.unshift.call(c,f.features||f);return l(n[d].apply(n,c))})})}if(!h)return h;h.then&&(h=f.delegate(h));h.total||(h.total=r.when(h,function(d){return m._isDefined(d.total)?d.total:d.length||0}));d("forEach");d("filter");d("map");d("some");d("every");return h};return l})},"widgets/AttributeTable/_RelationshipTable":function(){define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase dgrid/OnDemandGrid dgrid/Selection dgrid/extensions/ColumnHider dgrid/extensions/ColumnResizer dgrid/extensions/ColumnReorder dojo/Deferred dojo/Evented dojo/store/Memory esri/request esri/tasks/RelationshipQuery dojo/_base/lang dojo/on dojo/_base/array jimu/dijit/LoadingIndicator ./utils".split(" "),
function(m,f,n,r,l,h,d,p,c,k,t,q,s,a,b,e,g,w){return m([n,k],{baseClass:"jimu-widget-attributetable-relationship-table",_defaultFeatureCount:2E3,_defaultBatchCount:25,_batchCount:0,_currentDef:null,_requestStatus:"initial",relationship:null,parentWidget:null,noGridHeight:0,footerHeight:25,loading:null,grid:null,footer:null,selectedRowsLabel:null,selectionRows:null,nls:null,constructor:function(a){a=a||{};this.set("relationship",a.relationship||null);this.parentWidget=a.parentWidget||null;this.noGridHeight=
a.noGridHeight||0},postCreate:function(){this.selectionRows=[];this.loading=new g;this.loading.placeAt(this.domNode)},cancelThread:function(){"fulfilled"!==this._requestStatus&&this._currentDef&&(this._currentDef.cancel({canceledBySelf:!0}),this._requestStatus="canceled")},isCanceled:function(){return"canceled"===this._requestStatus},startQuery:function(b,c){var e=this.relationship;if(e&&!e.opened&&c&&0<c.length){this.loading.show();this._requestStatus="processing";var d=new s;d.objectIds=c;d.outFields=
["*"];d.relationshipId=e.id;d.returnGeometry=!1;if(b.url){var g=b.url.split("/");g[g.length-1]=e.relatedTableId;g=g.join("/");this._currentDef=g=q({url:g,content:{f:"json"},hangleAs:"json",callbackParamName:"callback"});g.then(a.hitch(this,function(c){this.domNode&&(this._currentDef=b.queryRelatedFeatures(d,function(a){return a})).then(a.hitch(this,function(a){if(this.domNode){var b={displayFieldName:e.objectIdField,fields:c.fields,features:[],fieldAliases:null},d;for(d in a){var g=a[d];g.features&&
0<g.features.length&&(b.features=b.features.concat(g.features))}0<b.features.length?(this.createTable(c,b),this.emit("data-loaded")):(a=f.toDom("\x3cdiv\x3e"+this.nls.noRelatedRecords+"\x3c/div\x3e"),f.empty(this.domNode),f.place(a,this.domNode),f.place(this.loading.domNode,this.domNode));e.opened=!0;this.loading.hide()}}),a.hitch(this,function(a){console.error(a);a=f.toDom("\x3cdiv\x3e"+this.nls.noRelatedRecords+"\x3c/div\x3e");f.empty(this.domNode);f.place(a,this.domNode);f.place(this.loading.domNode,
this.domNode);this.loading.hide()}))}),a.hitch(this,function(a){console.error(a);this.loading.hide()}))}}else this.loading.hide()},getSelectedRows:function(){return this.selectionRows},zoomTo:function(){},showSelectedRecords:function(){var b=this.relationship.objectIdField;this.grid._clickShowSelectedRecords=!0;var c=this._getSelectedIds();0<c.length&&this.grid&&this.grid.set("query",a.hitch(this,function(a){return"number"===typeof a&&-1<c.indexOf(a)||-1<c.indexOf(a[b])?!0:!1}))},clearSelection:function(){this.grid.clearSelection();
this.selectionRows=[];this.grid.set("query",{});this.setSelectedNumber();this.emit("clear-selection")},exportToCSV:function(){return this._getExportData().then(a.hitch(this,function(a){if(this.domNode)return w.createCSVStr(a.data,a.outFields,a.pk,a.types)}))},toggleColumns:function(){this.grid&&this.grid._toggleColumnHiderMenu()},changeHeight:function(a){this.grid&&0<=a-this.noGridHeight-this.footerHeight&&f.setStyle(this.grid.domNode,"height",a-this.noGridHeight-this.footerHeight+"px")},destroy:function(){this.parentWidget=
this.configedInfo=this.layerInfo=null;this.grid&&this.grid.destroy();this.nls=this.map=null;this.relationship.opened=!1;this.relationship=null;this.inherited(arguments)},createTable:function(c,g){var k=e.map(g.features,a.hitch(this,function(a){return a.attributes})),n=w.generateMemoryStore(k,g.displayFieldName),q=w.generateColumnsFromFields(g.fields,c.typeIdField,c.types);this.grid?(this.grid.set("store",n),this.grid.refresh()):(n={columns:q,store:n},this.grid=new (m([r,l,h,d,p]))(n,f.create("div")),
f.place(this.grid.domNode,this.domNode),this.grid.startup(),this.grid.__pk=g.displayFieldName,this.grid.__outFields=g.fields,this.own(b(this.grid,".dgrid-row:click",a.hitch(this,this._onRowClick))));this.footer?f.empty(this.footer):this.footer=f.create("div",null,this.domNode);k=f.create("div",{"class":"dgrid-status self-footer",innerHTML:k.length+"\x26nbsp;"+this.nls.features+"\x26nbsp;"},this.footer);this.selectedRowsLabel=f.create("div",{"class":"dgrid-status self-footer",innerHTML:"0\x26nbsp;"+
this.nls.selected+"\x26nbsp;"},k,"after");k=f.getStyle(this.parentWidget.domNode,"height");this.changeHeight(k);this._requestStatus="fulfilled"},_getExportData:function(){if(this.relationship){var a=new c,b=this.grid.__outFields,e=this.relationship.objectIdField,d=this.getSelectedRowsData();d&&0<d.length?a.resolve({data:d,outFields:b,pk:e,types:null}):(d=this.grid.store,d instanceof t?(d=d.data,a.resolve({data:d,outFields:b,pk:e,types:null})):a.resolve({data:[],outFields:b,pk:e,types:null}));return a}},
getSelectedRowsData:function(){if(!this.grid)return null;var b=this.relationship.objectIdField,c=this.grid.store,d=c._entityData||c.data,c=this.getSelectedRows();return e.map(c,a.hitch(this,function(a){for(var c=0,e=d.length;c<e;c++)if(d[c]&&d[c][b]===a)return d[c];return{}}))||[]},setSelectedNumber:function(){if(this.selectedRowsLabel&&this.grid){var a=this.getSelectedRows();this.selectedRowsLabel.innerHTML="\x26nbsp;\x26nbsp;"+a.length+" "+this.nls.selected+"\x26nbsp;\x26nbsp;"}},_onRowClick:function(){this.selectionRows=
this._getSelectedIds();this.setSelectedNumber();this.emit("row-click",{table:this,selectedIds:a.clone(this.selectionRows)})},_getSelectedIds:function(){var a=[],b=this.grid.selection,c;for(c in b)b[c]&&(isFinite(c)?a.push(parseInt(c,10)):a.push(c));return a}})})},"widgets/AttributeTable/PopupHandler":function(){define("dojo/_base/declare dojo/_base/lang dijit/_WidgetBase dojo/on jimu/LayerInfos/LayerInfos jimu/InfoWindowAction".split(" "),function(m,f,n,r,l,h){return m([n],{postCreate:function(){this.inherited(arguments);
l.getInstance(this.map,this.map.itemInfo).then(f.hitch(this,function(d){this.layerInfos=d}));this.showRelatedTableBtn=new h({buttonInfo:{title:this.nls.showRelatedRecords,baseClass:"relationship"}});this.own(r(this.showRelatedTableBtn,"buttonClick",f.hitch(this,this._onRealtionshipClick)));this.own(r(this.showRelatedTableBtn,"selectionChange",f.hitch(this,this._onSelectionChange)))},_onRealtionshipClick:function(d){var f=this.layerInfos.getLayerInfoById(d._layer.id);this.attrWidget.showRelatedRecordsFromPopup(f,
[d.attributes[d._layer.objectIdField]])},_onSelectionChange:function(d){this.layerInfos&&d._layer&&d._layer.relationships&&0<d._layer.relationships.length?this.showRelatedTableBtn.enableButtonNode():this.showRelatedTableBtn.disableButtonNode()},destroy:function(){this.showRelatedTableBtn.destroy();this.inherited(arguments)}})})},"jimu/InfoWindowAction":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/_base/html dijit/_WidgetBase dojo/Evented dojo/on dojo/query jimu/MapManager".split(" "),
function(m,f,n,r,l,h,d,p,c){return m([l,h],{popup:null,popupMobile:null,buttonInfo:null,_buttons:null,constructor:function(){this.buttonDomNodes=[];var d=c.getInstance().getMapInfoWindow();this.popup=d.bigScreen;this.popupMobile=d.mobile},postCreate:function(){this.inherited(arguments);this.buttonInfo&&this._addButtonNode()},_addButtonNode:function(){this._addButtonNodeToPopup();this._addButtonNodeToPopupMobile()},_addButtonNodeToPopup:function(){var c=p(".actionList",this.popup.domNode)[0],c=r.create("a",
{"class":"action "+this.buttonInfo.baseClass,href:" javascript:void(0);"},c);this.buttonDomNodes.push(c);this.popupButtonNode=r.create("span",{innerHTML:this.buttonInfo.title,style:"display: none"},c);this.own(d(this.popupButtonNode,"click",n.hitch(this,this._onButtonClick)));this.own(d(this.popup,"selection-change",n.hitch(this,this._onSelectionChange,this.popup)))},_addButtonNodeToPopupMobile:function(){var c=p(".esriMobilePopupInfoView .esriMobileInfoViewItem"),c=r.create("a",{"class":"action "+
this.buttonInfo.baseClass,href:" javascript:void(0);"},c[c.length-1]);this.buttonDomNodes.push(c);this.popupMobileButtonNode=r.create("span",{innerHTML:this.buttonInfo.title,style:"display: none"},c);this.own(d(this.popupMobileButtonNode,"click",n.hitch(this,this._onButtonClick)));this.own(d(this.popupMobile,"selection-change",n.hitch(this,this._onSelectionChange,this.popupMobile)))},enableButtonNode:function(){r.setStyle(this.popupButtonNode,"display","inline");r.setStyle(this.popupMobileButtonNode,
"display","inline")},disableButtonNode:function(){r.setStyle(this.popupButtonNode,"display","none");r.setStyle(this.popupMobileButtonNode,"display","none")},_onButtonClick:function(){this.emit("buttonClick",this._selectedFeature)},_onSelectionChange:function(c,d){-1<d.target.selectedIndex&&(this._selectedFeature=c.getSelectedFeature(),this.emit("selectionChange",this._selectedFeature))},destroy:function(){f.forEach(this.buttonDomNodes,function(c){r.destroy(c)},this);this.inherited(arguments)}})})},
"widgets/AttributeTable/_build-generate_module":function(){define(["dojo/text!./css/style.css","dojo/i18n!./nls/strings","dojo/text!./config.json"],function(){})},"url:dijit/layout/templates/TabContainer.html":'\x3cdiv class\x3d"dijitTabContainer"\x3e\r\n\t\x3cdiv class\x3d"dijitTabListWrapper" data-dojo-attach-point\x3d"tablistNode"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"tablistSpacer" class\x3d"dijitTabSpacer ${baseClass}-spacer"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTabPaneWrapper ${baseClass}-container" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/layout/templates/_TabButton.html":'\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"titleNode,innerDiv,tabContent" class\x3d"dijitTabInner dijitTabContent"\x3e\r\n\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTabButtonIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\x3cspan data-dojo-attach-point\x3d\'containerNode,focusNode\' class\x3d\'tabLabel\'\x3e\x3c/span\x3e\r\n\t\x3cspan class\x3d"dijitInline dijitTabCloseButton dijitTabCloseIcon" data-dojo-attach-point\x3d\'closeNode\'\r\n\t\t  role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d\'closeText\' class\x3d\'dijitTabCloseText\'\x3e[x]\x3c/span\r\n\t\t\t\t\x3e\x3c/span\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/layout/templates/ScrollingTabController.html":'\x3cdiv class\x3d"dijitTabListContainer-${tabPosition}" style\x3d"visibility:hidden"\x3e\r\n\t\x3cdiv data-dojo-type\x3d"dijit.layout._ScrollingTabControllerMenuButton"\r\n\t\t class\x3d"tabStripButton-${tabPosition}"\r\n\t\t id\x3d"${id}_menuBtn"\r\n\t\t data-dojo-props\x3d"containerId: \'${containerId}\', iconClass: \'dijitTabStripMenuIcon\',\r\n\t\t\t\t\tdropDownPosition: [\'below-alt\', \'above-alt\']"\r\n\t\t data-dojo-attach-point\x3d"_menuBtn" showLabel\x3d"false" title\x3d""\x3e\x26#9660;\x3c/div\x3e\r\n\t\x3cdiv data-dojo-type\x3d"dijit.layout._ScrollingTabControllerButton"\r\n\t\t class\x3d"tabStripButton-${tabPosition}"\r\n\t\t id\x3d"${id}_leftBtn"\r\n\t\t data-dojo-props\x3d"iconClass:\'dijitTabStripSlideLeftIcon\', showLabel:false, title:\'\'"\r\n\t\t data-dojo-attach-point\x3d"_leftBtn" data-dojo-attach-event\x3d"onClick: doSlideLeft"\x3e\x26#9664;\x3c/div\x3e\r\n\t\x3cdiv data-dojo-type\x3d"dijit.layout._ScrollingTabControllerButton"\r\n\t\t class\x3d"tabStripButton-${tabPosition}"\r\n\t\t id\x3d"${id}_rightBtn"\r\n\t\t data-dojo-props\x3d"iconClass:\'dijitTabStripSlideRightIcon\', showLabel:false, title:\'\'"\r\n\t\t data-dojo-attach-point\x3d"_rightBtn" data-dojo-attach-event\x3d"onClick: doSlideRight"\x3e\x26#9654;\x3c/div\x3e\r\n\t\x3cdiv class\x3d\'dijitTabListWrapper\' data-dojo-attach-point\x3d\'tablistWrapper\'\x3e\r\n\t\t\x3cdiv role\x3d\'tablist\' data-dojo-attach-event\x3d\'onkeydown:onkeydown\'\r\n\t\t\t data-dojo-attach-point\x3d\'containerNode\' class\x3d\'nowrapTabStrip\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/layout/templates/_ScrollingTabControllerButton.html":'\x3cdiv data-dojo-attach-event\x3d"ondijitclick:_onClick" class\x3d"dijitTabInnerDiv dijitTabContent dijitButtonContents"  data-dojo-attach-point\x3d"focusNode" role\x3d"button"\x3e\r\n\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitTabStripIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\x3cspan data-dojo-attach-point\x3d"containerNode,titleNode" class\x3d"dijitButtonText"\x3e\x3c/span\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/Filter.html":'\x3cdiv\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"contentSection" class\x3d"content-section"\x3e\r\n\t\t\x3cdiv class\x3d"add-btn-section"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnAddExp" data-dojo-attach-event\x3d"click:_onBtnAddExpClick"\r\n\t\t\t class\x3d"add-with-icon jimu-state-disabled add-expression jimu-float-leading"\x3e\r\n\t\t\t\t\x3cspan data-dojo-attach-point\x3d"iconAddExp" class\x3d"jimu-icon jimu-icon-add jimu-state-disabled"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan class\x3d"add-label"\x3e${nls.addAnotherExpression}\x3c/span\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnAddSet" data-dojo-attach-event\x3d"click:_onBtnAddSetClick"\r\n\t\t\t class\x3d"add-with-icon jimu-state-disabled add-set jimu-float-leading"\x3e\r\n\t\t\t\t\x3cspan data-dojo-attach-point\x3d"iconAddSet" class\x3d"jimu-icon jimu-icon-add jimu-state-disabled"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan class\x3d"add-label"\x3e${nls.addSet}\x3c/span\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"matchMsg" style\x3d"margin-top:11px;margin-bottom:11px;display:none;"\x3e\r\n\t\t\t\x3cspan\x3e${nls.strMatchMsgPart1}\x3c/span\x3e\r\n\t\t\t\x3cselect data-dojo-attach-point\x3d"allAnySelect"\x3e\r\n\t\t\t\t\x3coption value\x3d"AND" selected\x3e${nls.all}\x3c/option\x3e\r\n\t\t\t\t\x3coption value\x3d"OR"\x3e${nls.any}\x3c/option\x3e\r\n\t\t\t\x3c/select\x3e\r\n\t\t\t\x3cspan\x3e${nls.strMatchMsgPart2}\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\t\x3cdiv class\x3d"allExpsBox" data-dojo-attach-point\x3d"allExpsBox"\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"errorSection" style\x3d"display:none;"\x3e\r\n\t\t\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"errorTip" class\x3d"error-tip"\x3e\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"noFilterTipSection" class\x3d"no-filter-tip" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"loading" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_SingleFilter.html":'\x3cdiv\x3e\r\n\t\x3ctable class\x3d"setting-table" cellpadding\x3d"0" cellspacing\x3d"0" cellpadding\x3d"10px" style\x3d"table-layout:fixed;"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd class\x3d"fields-td" nowrap\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fieldsSelect" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-attach-event\x3d"change:_onFieldsSelectChange"  data-dojo-props\x3d\'searchAttr:"displayName",required:true,intermediateChanges:true\' class\x3d"dijit-form-FilteringSelect" style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"operators-td" nowrap\x3e\r\n\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"operatorsSelect" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-event\x3d"change:_onOperatorsSelectChange" style\x3d"width:100%;" class\x3d"dijit-form-Select"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"none"\x3e${nls.none}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"value-td" nowrap\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"attributeValueContainer" class\x3d"value-container"\x3e\r\n\t\t\t\t\t\t\x3cdiv\x3e\r\n\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"allValueBoxContainer" style\x3d"width:100%;"\x3e\r\n\t\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"stringTextBoxContainer" style\x3d"width:100%;"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"stringTextBox" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"required:true,trim:true" style\x3d"width:100%;" class\x3d"dijit-form-ValidationTextBox" /\x3e\r\n\r\n\t\t\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"stringCodedValuesFS" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"name",required:true,intermediateChanges:true\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"numberTextBoxContainer" style\x3d"display:none;"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"numberTextBox" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d\'"required":true,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' class\x3d"dijit-form-NumberTextBox" style\x3d"width:100%;" /\x3e\r\n\r\n\t\t\t\t\t\t\t\t\t\x3ctable data-dojo-attach-point\x3d"numberRangeTable" style\x3d"display:none;width:100%;border-collapse:collapse;table-layout:fixed;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"numberTextBox1" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d\'"required":true,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' class\x3d"dijit-form-NumberTextBox" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cspan\x3e${nls.and}\x3c/span\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"numberTextBox2" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d\'"required":true,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' class\x3d"dijit-form-NumberTextBox" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/table\x3e\r\n\r\n\t\t\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"numberCodedValuesFS" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"name",required:true,intermediateChanges:true\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"dateTextBoxContainer" style\x3d"display:none;"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"dateTextBox" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-props\x3d\'value:new Date(),required:true,trim:true\' class\x3d"dijit-form-DateTextBox" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\x3ctable data-dojo-attach-point\x3d"dateRangeTable" style\x3d"display:none;width:100%;border-collapse:collapse;table-layout:fixed;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"dateTextBox1" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-attach-event\x3d"change:_onRangeDateBlur" data-dojo-props\x3d\'value:new Date(),required:true,trim:true\' class\x3d"dijit-form-DateTextBox" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cspan\x3e${nls.and}\x3c/span\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"dateTextBox2" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-attach-event\x3d"change:_onRangeDateBlur" data-dojo-props\x3d\'value:new Date(),required:true,trim:true\' class\x3d"dijit-form-DateTextBox" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fieldsSelect2" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"name"\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;"\x3e\r\n\t\t\t\t\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"uniqueValuesSelect" data-dojo-type\x3d"dijit/form/FilteringSelect"  data-dojo-props\x3d\'searchAttr:"label"\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;"\x3e\r\n\t\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\t\t\t\x3cdiv class\x3d"radio-table-container"\x3e\r\n\t\t\t\t\t\t\t\x3ctable class\x3d"radio-table" cellpadding\x3d"0" cellspacing\x3d"0" style\x3d"table-layout:fixed;"\x3e\r\n\t\t\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cinput type\x3d"radio" data-dojo-attach-point\x3d"valueRadio" checked\x3d"true" disabled  title\x3d"${nls.valueTooltip}" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"valueLabel" title\x3d"${nls.valueTooltip}"\x3e${nls.value}\x3c/label\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cinput type\x3d"radio" data-dojo-attach-point\x3d"fieldRadio" disabled title\x3d"${nls.fieldTooltip}" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"fieldLabel" title\x3d"${nls.fieldTooltip}"\x3e${nls.field}\x3c/label\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd data-dojo-attach-point\x3d"uniqueTd"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cinput type\x3d"radio" data-dojo-attach-point\x3d"uniqueRadio" disabled title\x3d"${nls.uniqueValueTooltip}" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"uniqueLabel" title\x3d"${nls.uniqueValueTooltip}"\x3e${nls.unique}\x3c/label\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"delete-td" nowrap\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"jimu-icon jimu-icon-delete" data-dojo-attach-point\x3d"btnDelete"\r\n\t\t\t\t\t data-dojo-attach-event\x3d"click:_destroySelf"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv class\x3d"askvalues"\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"cbxAskValues" data-dojo-props\x3d\'label:"${nls.askForValues}"\' class\x3d"jimu-trailing-margin6"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"cbxCaseSensitive" data-dojo-props\x3d\'label:"${nls.caseSensitive}"\' style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"promptSection" class\x3d"prompt"\x3e\r\n\t\t\x3ctable data-dojo-attach-point\x3d"promptTable" cellpadding\x3d"0" cellspacing\x3d"0" class\x3d"prompt-table"\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.prompt}\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"second-td"\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"promptTB" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"required:true,trim:true" style\x3d"width:100%;" class\x3d"dijit-form-ValidationTextBox" \x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.hint}\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"second-td"\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"hintTB" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"trim:true" style\x3d"width:100%;" class\x3d"dijit-form-ValidationTextBox" \x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/Calendar.html":'\x3ctable cellspacing\x3d"0" cellpadding\x3d"0" class\x3d"dijitCalendarContainer" role\x3d"grid" aria-labelledby\x3d"${id}_mddb ${id}_year" data-dojo-attach-point\x3d"gridNode"\x3e\r\n\t\x3cthead\x3e\r\n\t\t\x3ctr class\x3d"dijitReset dijitCalendarMonthContainer" valign\x3d"top"\x3e\r\n\t\t\t\x3cth class\x3d\'dijitReset dijitCalendarArrow\' data-dojo-attach-point\x3d"decrementMonth" scope\x3d"col"\x3e\r\n\t\t\t\t\x3cspan class\x3d"dijitInline dijitCalendarIncrementControl dijitCalendarDecrease" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan data-dojo-attach-point\x3d"decreaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e-\x3c/span\x3e\r\n\t\t\t\x3c/th\x3e\r\n\t\t\t\x3cth class\x3d\'dijitReset\' colspan\x3d"5" scope\x3d"col"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"monthNode"\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/th\x3e\r\n\t\t\t\x3cth class\x3d\'dijitReset dijitCalendarArrow\' scope\x3d"col" data-dojo-attach-point\x3d"incrementMonth"\x3e\r\n\t\t\t\t\x3cspan class\x3d"dijitInline dijitCalendarIncrementControl dijitCalendarIncrease" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan data-dojo-attach-point\x3d"increaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e+\x3c/span\x3e\r\n\t\t\t\x3c/th\x3e\r\n\t\t\x3c/tr\x3e\r\n\t\t\x3ctr role\x3d"row"\x3e\r\n\t\t\t${!dayCellsHtml}\r\n\t\t\x3c/tr\x3e\r\n\t\x3c/thead\x3e\r\n\t\x3ctbody data-dojo-attach-point\x3d"dateRowsNode" data-dojo-attach-event\x3d"ondijitclick: _onDayClick" class\x3d"dijitReset dijitCalendarBodyContainer"\x3e\r\n\t\t\t${!dateRowsHtml}\r\n\t\x3c/tbody\x3e\r\n\t\x3ctfoot class\x3d"dijitReset dijitCalendarYearContainer"\x3e\r\n\t\t\x3ctr\x3e\r\n\t\t\t\x3ctd class\x3d\'dijitReset\' valign\x3d"top" colspan\x3d"7" role\x3d"presentation"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"dijitCalendarYearLabel"\x3e\r\n\t\t\t\t\t\x3cspan data-dojo-attach-point\x3d"previousYearLabelNode" class\x3d"dijitInline dijitCalendarPreviousYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\t\t\t\x3cspan data-dojo-attach-point\x3d"currentYearLabelNode" class\x3d"dijitInline dijitCalendarSelectedYear" role\x3d"button" id\x3d"${id}_year"\x3e\x3c/span\x3e\r\n\t\t\t\t\t\x3cspan data-dojo-attach-point\x3d"nextYearLabelNode" class\x3d"dijitInline dijitCalendarNextYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/td\x3e\r\n\t\t\x3c/tr\x3e\r\n\t\x3c/tfoot\x3e\r\n\x3c/table\x3e\r\n',
"url:jimu/dijit/templates/_FilterSet.html":'\x3cdiv\x3e\r\n\t\x3ctable class\x3d"header-table" cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cdiv\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.strMatchMsgPart1}\x3c/span\x3e\r\n\t\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"allAnySelect"\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"AND" selected\x3e${nls.all}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"OR"\x3e${nls.any}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.strMatchMsgPart2}\x3c/span\x3e\r\n\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:15px;padding-right:10px;"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnDelete" data-dojo-attach-event\x3d"onclick:_destroySelf"\r\n\t\t\t\t\t class\x3d"jimu-icon jimu-icon-delete"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:15px;padding-right:14px;"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnAdd" class\x3d"jimu-icon jimu-icon-add"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"allExpsBox"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/AttributeTable/css/style.css":'.jimu-widget-attributetable-main .tabStripButton{height: 24px !important;}.jimu-widget-attributetable,.jimu-widget-attributetable-main{height: 100%; left: 0px; bottom: 0px; background-color: #efefef;}.jimu-widget-attributetable{height: auto;}.jimu-widget-attributetable-main{overflow: hidden;}.jimu-widget-attributetable .jimu-widget-attributetable-main .dijitToolbar {position: relative;}.jimu-widget-attributetable-move{width: 100%; height: 7px; top: 0px;}.jimu-widget-attributetable-move:hover{cursor: n-resize;}.jimu-widget-attributetable-move:hover .jimu-widget-attributetable-thumb{background-color: #fff;}.jimu-widget-attributetable .draging{background-color: gray;}.jimu-widget-attributetable-thumb{background: #B0B0B0 none; height: 1px; width: 19px; margin: 3px auto; position: absolute; left: 0; right: 0;}.jimu-widget-attributetable-indicate-vertical{width: 2px; height: 100%; background-color: black; position: absolute; z-index: 1; opacity: 0;}.jimu-widget-attributetable-indicate-horizontal{width: 100%; height: 2px; background-color: black; position: absolute; z-index: 1; opacity: 0;}.jimu-widget-attributetable-bar{width: 63px; height: 17px; left: 0; right: 0; top: -17px; margin: auto; position: absolute; background-color: #efefef; cursor: pointer; border: 1px solid #fff; border-radius: 2px 2px 0 0; background-position: center; background-repeat: no-repeat;}.jimu-widget-attributetable-bar:hover{background-color: #bfbfbf;}.jimu-widget-attributetable-bar.open{background-image: url(images/arrow_down.png); border: none; border-bottom-left-radius: 0; border-bottom-right-radius: 0;}.jimu-widget-attributetable-bar.close{background-image: url(images/arrow_up.png)}.jimu-widget-attributetable-arrowImage{width: 30px; height: 30px; left: 48%; top: -30px; position: absolute; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-left-radius: 0px; border-bottom-right-radius: 0px; background-position: center center; background-repeat: no-repeat; cursor: ns-resize; background-color: rgba(0, 0, 0, 0.8);}.dijitTabPaneWrapper .dijitTabContainerTop-container .dijitAlignCenter{height: 100%;}.jimu-widget-attributetable .dijitTabContainerTopChildWrapper,.jimu-widget-attributetable .dijitTabContainerTopChildWrapper .dijitContentPane{height: 100% !important; width: 100% !important;}.jimu-widget-attributetable .dijitToggleButton.dijitToggleButtonChecked .dijitButtonText{font-weight: bold; color: #518dca;}.jimu-widget-attributetable .esriAttributeTable{width: 100%; height: 100%; position: relative;}.jimu-widget-attributetable .dgrid-sortable {font-weight: bold;}.jimu-widget-attributetable .dgrid-cell {border-right: solid 1px #ccc; width: 100px;}.jimu-widget-attributetable .dgrid-row .dgrid-cell {border:medium none; padding: 7px 3px; border-right: 1px solid #CCCCCC;}.jimu-rtl .jimu-widget-attributetable .dgrid-cell {text-align: right;}.jimu-widget-attributetable .dgrid-header {overflow: hidden; background-color: #eee;}.jimu-widget-attributetable .dgrid-cell a{color: #21759B; text-decoration: none;}.jimu-widget-attributetable .dgrid-cell a:hover, a:active{text-decoration: underline;}.jimu-widget-attributetable .dgrid-row {border: medium none;}.jimu-widget-attributetable .dgrid-row:hover {background-color:#E1F0FB;}.jimu-widget-attributetable .dgrid-row-even{background-color: #FFF;}.jimu-widget-attributetable .dgrid-row-odd {background-color: #F7F8F8;}.jimu-widget-attributetable .ui-state-active {background-color: #AEC7E3;}.jimu-widget-attributetable .dgrid-status {white-space: pre;}.jimu-widget-attributetable .self-footer {display: inline-block;}.jimu-rtl .dgrid-hider-menu-check{right: 2px; left: auto;}.jimu-rtl .dgrid-hider-menu-label {padding-left: 0; padding-right: 20px;}.jimu-rtl .jimu-widget-attributetable .dgrid-pagination .dgrid-status{float: right !important;}.jimu-rtl .dgrid-pagination .dgrid-navigation,.jimu-rtl .dgrid-pagination .dgrid-page-size{float: left !important;}.esriAttributeTableExportImage{background-image: url("../images/export.png"); width: 13px; height: 13px;}.esriAttributeTableZoomImage{background-image: url("../images/zoom.png"); width: 13px; height: 13px;}.esriAttributeTableSelectAllImage{background-image: url("../images/select.png"); width: 13px; height: 13px;}.esriAttributeTableFilterImage{background-image: url("../images/filter.png"); width: 13px; height: 13px;}.esriAttributeTableSelectPageImage{background-image: url("../images/page.png"); width: 13px; height: 13px;}.esriAttributeTableClearImage{background-image: url("../images/clear.png"); width: 13px; height: 13px;}.esriAttributeTableOptionsImage{background-image: url("../images/more.png"); width: 13px; height: 13px;}.esriAttributeTableRefreshImage{background-image: url("../images/refresh.png"); width: 13px; height: 13px;}.esriAttributeTableSymbolImage{background-image: url("../images/symbol.png"); width: 13px; height: 13px;}.esriAttributeTableCloseImage{background-image: url("../images/close.png"); width: 13px; height: 13px;}.esriAttributeTableColumnsImage{background-image: url("../images/columns.png"); width: 13px; height: 13px;}.jimu-widget-attributetable .jimu-widget-attributetable-main .dijitToolbar .close-button {position: absolute; right: 0;}.jimu-rtl .jimu-widget-attributetable .jimu-widget-attributetable-main .dijitToolbar .close-button {right: auto; left: 0;}.jimu-widget-attributetable .jimu-loading-indicator {z-index: 100;}.jimu-widget-attributetable .jimu-widget-attributetable-feature-table{height: 100%; position: relative;}.jimu-widget-attributetable .jimu-widget-attributetable-relationship-table{height: 100%; position: relative;}',
"url:widgets/AttributeTable/config.json":'{\r\n  "layerInfos": [],\r\n  "table": {\r\n    "pageSizeOptions": [25, 50, 100, 1000]\r\n  },\r\n  "hideExportButton": false,\r\n  "initiallyExpand": false\r\n}',"*now":function(m){m(['dojo/i18n!*preload*widgets/AttributeTable/nls/Widget*["ar","cs","da","de","en","el","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/html dijit/_WidgetsInTemplateMixin jimu/BaseWidget dijit/layout/TabContainer dijit/layout/ContentPane jimu/utils jimu/dijit/Filter jimu/dijit/Popup jimu/dijit/Message dojo/Deferred dojo/when esri/layers/FeatureLayer esri/request esri/lang dojo/_base/lang dojo/on dojo/touch dojo/topic dojo/aspect dojo/_base/array dojo/has dojo/query dijit/Toolbar dijit/form/Button dijit/DropDownMenu dijit/MenuItem dijit/form/ToggleButton dijit/form/DropDownButton jimu/dijit/LoadingIndicator ./_FeatureTable ./_RelationshipTable ./utils ./PopupHandler".split(" "),function(m,
f,n,r,l,h,d,p,c,k,t,q,s,a,b,e,g,w,v,G,z,I,H,K,E,D,A,J,L,u,x,y,B,F){m=m([r,n],{name:"AttributeTable",baseClass:"jimu-widget-attributetable",normalHeight:0,openHeight:0,arrowDivHeight:null,_defaultFeatureCount:2E3,_defaultBatchCount:25,_batchCount:0,_filterPopup:null,_layerTypes:{FEATURELAYER:"FeatureLayer",RELATIONSHIPTABLE:"RelationshipTable"},postMixInProperties:function(){this.nls.features=this.nls.features||"features"},postCreate:function(){this.inherited(arguments);d.loadStyleLink("dgrid",apiUrl+
"dgrid/css/dgrid.css");this.AttributeTableDiv=this._loadInfoDef=null;this.configLayerInfos=[];this._delayedLayerInfos=[];this._allLayerInfos=[];this.grids=[];this.featureTables=[];this.layerTabPages=[];this.relationshipsSet={};this.relationTabPagesSet={};this.relationshipTableSet={};this.refreshButton=this.selectionMenu=this.exportButton=this.zoomButton=this.tableDiv=this.tabContainer=this.toolbarDiv=this.currentRelationshipKey=null;this.moveMode=!1;this.bottomPosition=this.toolbarHeight=this.noGridHeight=
this.previousDomHeight=this.moveY=0;this.matchingCheckBox=null;this.layersIndex=-1;this.matchingMap=!0;this.showing=!1;this.openHeight=this.normalHeight=this._getNormalHeight();this.arrowDivHeight=0;this._dragingHandlers=[];this._createUtilitiesUI();this.popupHandler=new F({map:this.map,attrWidget:this,nls:this.nls});this.own(v.subscribe("changeMapPosition",e.hitch(this,this._onMapPositionChange)));B.readLayerInfosObj(this.map).then(e.hitch(this,function(a){this.own(g(a,"layerInfosIsShowInMapChanged",
e.hitch(this,this.onLayerInfosIsShowInMapChanged)));this.own(a.on("layerInfosChanged",e.hitch(this,this.onLayerInfosChanged)))}))},_createUtilitiesUI:function(){this._createArrowUI();this._createBarUI()},_createArrowUI:function(){this.arrowDiv=f.create("div");f.addClass(this.arrowDiv,"jimu-widget-attributetable-move");f.create("div",{"class":"jimu-widget-attributetable-thumb"},this.arrowDiv);f.place(this.arrowDiv,this.domNode);this.own(g(this.arrowDiv,"mousedown",e.hitch(this,this._onDragStart)));
this.own(g(this.arrowDiv,w.press,e.hitch(this,this._onDragStart)))},_isOnlyTable:function(){return this.closeable||!this.isOnScreen},_createBarUI:function(){this._isOnlyTable()||(this.bar=f.create("div"),f.addClass(this.bar,"jimu-widget-attributetable-bar"),f.place(this.bar,this.domNode),this.own(g(this.bar,"click",e.hitch(this,this._switchTable))))},_processOpenBarUI:function(){this._isOnlyTable()||(f.removeClass(this.bar,"close"),f.addClass(this.bar,"open"),f.setAttr(this.bar,"title",this.nls.closeTableTip))},
_processCloseBarUI:function(){this._isOnlyTable()||(f.removeClass(this.bar,"open"),f.addClass(this.bar,"close"),f.setAttr(this.bar,"title",this.nls.openTableTip))},_switchTable:function(){this.showing?this._closeTable():this._openTable()},_openTable:function(){this._loadInfoDef?this._loadInfoDef.isFulfilled()&&(this.showing=!0,this._processDelayedLayerInfos()):(this._loadInfoDef=new t,this.own(this._loadInfoDef),this.loading||(this.loading=new u),this.loading.placeAt(this.domNode),this.loading.show(),
B.readConfigLayerInfosFromMap(this.map).then(e.hitch(this,function(a){if(this.domNode){if(0===this.config.layerInfos.length){var b=B.getConfigInfosFromLayerInfos(a);this.config.layerInfos=z.filter(b,function(a){return a.show})}else this.config.layerInfos=z.filter(e.delegate(this.config.layerInfos),function(a){return a.show});this._allLayerInfos=a;this._processDelayedLayerInfos();this._init();this.showRefreshing(!1);this.showing=!0;this._loadInfoDef.resolve()}}),e.hitch(this,function(a){console.error(a)})));
this._changeLeftPostion();this._changeHeight(this.openHeight);this._processOpenBarUI();return this._loadInfoDef},_onCloseBtnClicked:function(){this.showing&&this._isOnlyTable()?this.widgetManager.closeWidget(this):this.showing&&this._closeTable()},_closeTable:function(){this._changeHeight(0);this.showRefreshing(!1);this._processCloseBarUI();this.showing=!1;f.setStyle(this.arrowDiv,"display","none");setTimeout(e.hitch(this,function(){f.setStyle(this.arrowDiv,"display","block")}),10)},_init:function(){this.initConfigLayerInfos();
this.initDiv();this.resize();this.own(g(window.document,"mouseup",e.hitch(this,this._onDragEnd)));this.own(g(window.document,"mousemove",e.hitch(this,this._onDraging)));this.own(g(window.document,w.move,e.hitch(this,this._onDraging)));this.own(g(window.document,w.release,e.hitch(this,this._onDragEnd)))},_processDelayedLayerInfos:function(){0<this._delayedLayerInfos.length&&(z.forEach(this._delayedLayerInfos,e.hitch(this,function(a){this._getLayerInfoById(a&&a.id)||this._allLayerInfos.push(a)})),this._delayedLayerInfos=
[])},onLayerInfosIsShowInMapChanged:function(){this.checkMapInteractiveFeature()},onLayerInfosChanged:function(a,b,c){if(c&&a)if("added"===b)c.getSupportTableInfo().then(e.hitch(this,function(a){a.isSupportedLayer&&(0===this._allLayerInfos.length?this._delayedLayerInfos.push(c):0<this._allLayerInfos.length&&!this._getLayerInfoById(c.id)&&(this._allLayerInfos.push(c),this.initConfigLayerInfos(),this.getExistLayerTabPage(c.id)&&(this._startQueryOnLayerTab(c.id),this.resetButtonStatus())))}));else if("removed"===
b){a=this.configLayerInfos.length;for(b=0;b<a;b++)if(this.getLayerInfoId(this.configLayerInfos[b])===this.getLayerInfoId(c)){this.layerTabPageClose(this.layerTabPages[b].paneId,!0);break}}},destroy:function(){if(!this._destroyed){var a,b;if(this.layerTabPages&&0<this.layerTabPages.length){a=this.layerTabPages.length;for(b=0;b<a;b++)this.layerTabPages[b].destroy();this.layerTabPages=null}for(var c in this.relationTabPagesSet)this.relationTabPagesSet[c]&&this.relationTabPagesSet[c].destroy(),this.relationTabPagesSet=
null;this.tabContainer&&(this.tabContainer.destroy(),this.tabContainer=null);this.configLayerInfos=this._allLayerInfos=this.layers=null;this.layersIndex=-1;this.exportButton=this.zoomButton=this.tableDiv=null;this.selectionMenu&&(this.selectionMenu.destroy(),this.selectionMenu=null);this.refreshButton=this.selectionMenu=null;this.AttributeTableDiv&&(f.empty(this.AttributeTableDiv),this.AttributeTableDiv=null);this._loadInfoDef=null;this.popupHandler&&(this.popupHandler.destroy(),this.popupHandler=
null);this._filterPopup&&(this._filterPopup.close(),this._filterPopup=null);this.inherited(arguments)}},onOpen:function(){!this.showing&&this._isOnlyTable()&&this._openTable()},onClose:function(){this.showing&&this._closeTable()},_changeHeight:function(a){f.setStyle(this.domNode,"height",a+"px");this.tabContainer&&(this.tabContainer.domNode&&0<=a-this.toolbarHeight)&&f.setStyle(this.tabContainer.domNode,"height",a-this.toolbarHeight+"px");if(this.featureTables&&0<this.featureTables.length)for(var b=
this.featureTables.length,c=0;c<b;c++){var d=this.featureTables[c];d&&d.changeHeight(a)}for(var e in this.relationshipTableSet)(b=this.relationshipTableSet[e])&&b.changeHeight(a);this.refreshGridHeight();v.publish("changeMapPosition",{bottom:a+this.bottomPosition});0!==a&&(this.arrowDivHeight||(this.arrowDivHeight=(e=f.getMarginBox(this.arrowDiv))&&e.h?e.h:10),this.openHeight=a>=this.arrowDivHeight+this.toolbarHeight?a:this.normalHeight)},_changeLeftPostion:function(){var a=f.getMarginBox(window.jimuConfig.layoutId),
b=f.getMarginBox(this.map.id),a=Math.abs(a.w-b.w);window.isRTL?f.setStyle(this.domNode,"right",a+"px"):f.setStyle(this.domNode,"left",a+"px")},_onMapPositionChange:function(){this._changeLeftPostion();this.tabContainer&&this.tabContainer.resize()},setPosition:function(a){this.position=a;if(!this.domNode.parentNode||this.domNode.parentNode.id!==window.jimuConfig.layoutId)f.place(this.domNode,window.jimuConfig.layoutId),this.setInitialPosition(a),this.refreshGridHeight(),this.showRefreshing(!1)},initConfigLayerInfos:function(){var a=
this.config.layerInfos.length;this.configLayerInfos=[];if(0<a)for(var b=0;b<a;b++){var c=this._getLayerInfoById(this.config.layerInfos[b].id);this.configLayerInfos[b]=c}},initSelectedLayer:function(){},_getLayerInfoByName:function(a){for(var b=0;b<this._allLayerInfos.length;b++)if(this._allLayerInfos[b]&&this._allLayerInfos[b].name===a)return this._allLayerInfos[b]},_getLayerInfoById:function(a){for(var b=0,c=this._allLayerInfos.length;b<c;b++)if(this._allLayerInfos[b]&&this._allLayerInfos[b].id===
a)return this._allLayerInfos[b]},_getRelationShipsByLayer:function(a){var b=[];a=a.relationships;for(var c in this.relationshipsSet)for(var d=0,e=a.length;d<e;d++)c===a[d]._relKey&&b.push(a[d]);return b},_getLayerDifinition:function(b){var c=this.featureTables[b];return(b=c.getLayerDefinition())?q(b):a({url:c.layer.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(function(a){c.setLayerDefinition(a);return c.getLayerDefinition()})},_getFilterableFields:function(a,c){return z.filter(a,
function(a){return z.some(c,function(c){return a.name===c.name&&(c.show||!b.isDefined(c.show))})})},_clipValidFields:function(a,b){if(!a||!a.length)return b||[];if(!b||!b.length)return a;for(var c=[],d=0,e=a.length;d<e;d++)for(var f=a[d],g=0,h=b.length;g<h;g++)if(b[g].name===f.name){c.push(f);break}return c},_getLayerIndexById:function(a){for(var b=0,c=this.config.layerInfos.length,b=0;b<c;b++)if(this.configLayerInfos[b]&&this.getLayerInfoId(this.configLayerInfos[b])===a)return b;return-1},_collectRelationShips:function(a,
b){var c=a.relationships;if(c&&0<c.length)for(var d=0,e=c.length;d<e;d++){var f=b.id+"_"+c[d].name+"_"+c[d].id;c[d]._relKey=f;c[d]._layerInfoId=b.id;this.relationshipsSet[f]||(this.relationshipsSet[f]=c[d],this.relationshipsSet[f].objectIdField=a.objectIdField)}},_hangUpTableThread:function(){z.forEach(this.featureTables,function(a){a&&a.grid&&(a.actived=!1);a&&a.cancelThread()});for(var a in this.relationshipTableSet){var b=this.relationshipTableSet[a];b&&b.cancelThread()}},_startQueryOnLayerTab:function(a){this.layersIndex=
this._getLayerIndexById(a);-1<this.layersIndex&&this.configLayerInfos[this.layersIndex]&&(this._hangUpTableThread(),this.config.layerInfos[this.layersIndex].opened?(this.featureTables[this.layersIndex].actived=!0,this.matchingMap||this.featureTables[this.layersIndex].isCanceled()?this.startQuery(this.layersIndex):this.resetButtonStatus()):this.configLayerInfos[this.layersIndex].getLayerObject().then(e.hitch(this,function(a){this._collectRelationShips(a,this.config.layerInfos[this.layersIndex]);this.configLayerInfos[this.layersIndex].getSupportTableInfo().then(e.hitch(this,
function(b){b.isSupportQuery?(this.checkMapInteractiveFeature(),this.config.layerInfos[this.layersIndex].layer.fields=this._clipValidFields(this.config.layerInfos[this.layersIndex].layer.fields,a.fields),this.startQuery(this.layersIndex),this.featureTables[this.layersIndex].actived=!0):(b=f.toDom("\x3cdiv\x3e"+this.nls.unsupportQueryWarning+"\x3c/div\x3e"),this.layerTabPages[this.layersIndex].set("content",b),this.refreshGridHeight(),this.resetButtonStatus())}),e.hitch(this,function(a){new k({message:a.message||
a})}))}),e.hitch(this,function(a){new k({message:a.message||a})})))},_startQueryOnRelationTab:function(a,b,c){var d=this.relationshipTableSet[a];if((c=this.configLayerInfos[c])&&c.layerObject)this._hangUpTableThread(),d?this.relationshipTableSet[a].startQuery(c.layerObject,b):(d=new y({relationship:this.relationshipsSet[a],parentWidget:this,noGridHeight:this.noGridHeight,nls:this.nls}),d.placeAt(this.relationTabPagesSet[a]),d.startQuery(c.layerObject,b),d.own(g(d,"data-loaded",e.hitch(this,"_onTableDataLoaded"))),
d.own(g(d,"row-click",e.hitch(this,"_onTableRowClick"))),d.own(g(d,"clear-selection",e.hitch(this,"_onTableClearSelection"))),this.relationshipTableSet[a]=d)},tabChanged:function(){this.exportButton&&this.exportButton.set("disabled",!0);if(this.tabContainer&&this.tabContainer.selectedChildWidget){0>=this.noGridHeight&&(this.noGridHeight=this._getGridTopSectionHeight()+5);var a=this.tabContainer.selectedChildWidget.params.layerType;if(a===this._layerTypes.FEATURELAYER)a=this.tabContainer.selectedChildWidget.params.paneId,
this.currentRelationshipKey=null,this._startQueryOnLayerTab(a);else if(a===this._layerTypes.RELATIONSHIPTABLE){var b=this.tabContainer.selectedChildWidget.params,a=b.paneId,c=b.oids,b=b.layersIndex;this.currentRelationshipKey=a;this.relationshipsSet[a]&&this._startQueryOnRelationTab(a,c,b)}}this.resetButtonStatus()},getCurrentTable:function(){if(this.tabContainer&&this.tabContainer.selectedChildWidget){var a=this.tabContainer.selectedChildWidget.params.layerType;if(a===this._layerTypes.FEATURELAYER)return this.featureTables[this.layersIndex];
if(a===this._layerTypes.RELATIONSHIPTABLE)return this.relationshipTableSet[this.currentRelationshipKey]}return null},checkMapInteractiveFeature:function(){var a=this.configLayerInfos[this.layersIndex],b=this.featureTables[this.layersIndex];a&&(a.isShowInMap()?(b&&b.showGraphic(),this.zoomButton.set("disabled",!1)):(b&&b.hideGraphic(),this.zoomButton.set("disabled",!0)))},resetButtonStatus:function(){var a=this.getCurrentTable();if(a){var b=a.getSelectedRows();b&&0<b.length?this.showSelectedRecords.set("disabled",
!1):this.showSelectedRecords.set("disabled",!0);a.layer&&a.layer.relationships&&0<a.layer.relationships.length&&b&&0<b.length?this.showRelatedRecords.set("disabled",!1):this.showRelatedRecords.set("disabled",!0);a instanceof x&&a.isSupportQueryToServer()?this.filter.set("disabled",!1):this.filter.set("disabled",!0);a instanceof x?this.matchingCheckBox.set("disabled",!1):this.matchingCheckBox.set("disabled",!0);this.columns.set("disabled",!1);this.config.hideExportButton||(a.grid&&a.grid.store?this.exportButton.set("disabled",
!1):this.exportButton.set("disabled",!0));a instanceof x&&b&&0<b.length?this.configLayerInfos[this.layersIndex].isShowInMap()?this.zoomButton.set("disabled",!1):this.zoomButton.set("disabled",!0):this.zoomButton.set("disabled",!0)}else this.showSelectedRecords.set("disabled",!0),this.showRelatedRecords.set("disabled",!0),this.matchingCheckBox.set("disabled",!0),this.filter.set("disabled",!0),this.columns.set("disabled",!0),this.config.hideExportButton||this.exportButton.set("disabled",!0),this.zoomButton.set("disabled",
!0)},showRefreshing:function(a){this.loading&&(a?this.loading.show():this.loading.hide())},startQuery:function(a){if(this.config.layerInfos&&0!==this.config.layerInfos.length){if(this.featureTables[this.layersIndex])this.featureTables[this.layersIndex].startQuery();else{var b=new x({map:this.map,matchingMap:this.matchingCheckBox.get("checked"),layerInfo:this.configLayerInfos[a],configedInfo:this.config.layerInfos[a],parentWidget:this,noGridHeight:this.noGridHeight,nls:this.nls});b.placeAt(this.layerTabPages[a]);
b.startQuery();b.own(g(b,"data-loaded",e.hitch(this,"_onTableDataLoaded")));b.own(g(b,"row-click",e.hitch(this,"_onTableRowClick")));b.own(g(b,"clear-selection",e.hitch(this,"_onTableClearSelection")));this.featureTables[a]=b}this.featureTables[this.layersIndex].actived=!0}},_onTableDataLoaded:function(){this.showRefreshing(!1);this.refreshGridHeight();this.resetButtonStatus()},_onTableRowClick:function(){this.resetButtonStatus()},_onTableClearSelection:function(){this.resetButtonStatus()},_onDragStart:function(a){this.moveMode=
!0;this.moveY=a.clientY;this.previousDomHeight=f.getStyle(this.domNode,"height");f.addClass(this.arrowDiv,"draging");this._dragingHandlers=this._dragingHandlers.concat([g(this.ownerDocument,"dragstart",function(a){a.stopPropagation();a.preventDefault()}),g(this.ownerDocumentBody,"selectstart",function(a){a.stopPropagation();a.preventDefault()})])},_onDraging:function(a){this.moveMode&&this._changeHeight(this.moveY-a.clientY+this.previousDomHeight)},_onDragEnd:function(){this.moveMode=!1;f.removeClass(this.arrowDiv,
"draging");for(var a=this._dragingHandlers.pop();a;)a.remove(),a=this._dragingHandlers.pop()},refreshGridHeight:function(){var a=H(".dijitTabPaneWrapper",this.domNode);a&&a.length&&f.setStyle(a[0],"height","100%")},_getNormalHeight:function(){var a=document.body.clientHeight;return window.appInfo.isRunInMobile?a/2:a/3},setInitialPosition:function(a){this.bottomPosition="bottom"in a?parseInt(a.bottom,10):0;f.setStyle(this.domNode,"top","auto");f.setStyle(this.domNode,"left","0px");f.setStyle(this.domNode,
"right","0px");f.setStyle(this.domNode,"bottom",this.bottomPosition+"px");f.setStyle(this.domNode,"position","absolute");this._isOnlyTable()||(this.config&&this.config.initiallyExpand?this._openTable():this._closeTable())},initDiv:function(){this.AttributeTableDiv=f.create("div",{},this.domNode);f.addClass(this.AttributeTableDiv,"jimu-widget-attributetable-main");var a=f.create("div");this.toolbarDiv=a;var b=new K({},f.create("div")),c=new D;this.showSelectedRecords=new A({label:this.nls.showSelectedRecords,
iconClass:"esriAttributeTableSelectPageImage",onClick:e.hitch(this,this._showSelectedRecords)});c.addChild(this.showSelectedRecords);this.showRelatedRecords=new A({label:this.nls.showRelatedRecords,iconClass:"esriAttributeTableSelectAllImage",onClick:e.hitch(this,this._showRelatedRecords)});c.addChild(this.showRelatedRecords);this.filter=new A({label:this.nls.filter,iconClass:"esriAttributeTableFilterImage",onClick:e.hitch(this,this._showFilter)});c.addChild(this.filter);this.columns=new A({label:this.nls.columns,
iconClass:"esriAttributeTableColumnsImage",onClick:e.hitch(this,this._toggleColumns)});c.addChild(this.columns);this.config.hideExportButton||(this.exportButton=new A({label:this.nls.exportFiles,showLabel:!0,iconClass:"esriAttributeTableExportImage",onClick:e.hitch(this,this._onExportButton)}),c.addChild(this.exportButton));this.selectionMenu=new L({label:this.nls.options,iconClass:"esriAttributeTableOptionsImage",dropDown:c});b.addChild(this.selectionMenu);this.matchingCheckBox=new J({checked:!0,
showLabel:!0,label:this.nls.filterByExtent,onChange:e.hitch(this,function(a){(this.matchingMap=a)?z.forEach(this.featureTables,e.hitch(this,function(a){a&&a.set("matchingMap",!0)})):z.forEach(this.featureTables,e.hitch(this,function(a){a&&a.set("matchingMap",!1)}));this.startQuery(this.layersIndex)})});b.addChild(this.matchingCheckBox);this.zoomButton=new E({label:this.nls.zoomto,iconClass:"esriAttributeTableZoomImage",onClick:e.hitch(this,this.onZoomButton)});b.addChild(this.zoomButton);c=new E({label:this.nls.clearSelection,
iconClass:"esriAttributeTableClearImage",onClick:e.hitch(this,this._clearSelection,!1)});b.addChild(c);this.refreshButton=new E({label:this.nls.refresh,showLabel:!0,iconClass:"esriAttributeTableRefreshImage",onClick:e.hitch(this,this.onClickRefreshButton)});b.addChild(this.refreshButton);this.closeButton=new E({title:this.nls.closeMessage,iconClass:"esriAttributeTableCloseImage",onClick:e.hitch(this,this._onCloseBtnClicked)});f.addClass(this.closeButton.domNode,"close-button");b.addChild(this.closeButton);
f.place(b.domNode,a);b=f.create("div");this.tableDiv=f.create("div");f.place(this.tableDiv,b);f.place(a,this.AttributeTableDiv);f.place(b,this.AttributeTableDiv);this.toolbarHeight=a=f.getStyle(a,"height");this.tabContainer=new l({style:"width: 100%;"},b);f.setStyle(this.tabContainer.domNode,"height",this.normalHeight-a+"px");a=this.config.layerInfos.length;for(b=0;b<a;b++)if(this.config.layerInfos[b].show){var c=e.clone(this.config.layerInfos[b]),g={};g.paneId=c.id;g.title=c.name;g.name=c.name;g.layerType=
this._layerTypes.FEATURELAYER;g.style="height: 100%; width: 100%; overflow: visible;";c=new h(g);this.layerTabPages[b]=c;this.tabContainer.addChild(c)}this.tabContainer.startup();0<a&&(this.noGridHeight=this._getGridTopSectionHeight()+5);d.setVerticalCenter(this.tabContainer.domNode);this.tabChanged();this.own(G.after(this.tabContainer,"selectChild",e.hitch(this,this.tabChanged)))},getLayerInfoLabel:function(a){return a.name||a.title},getLayerInfoId:function(a){return a&&a.id||""},_getGridTopSectionHeight:function(){var a=
H(".dijitTabPaneWrapper",this.domNode)[0];if(a){var b=f.position(this.domNode).y;return f.position(a).y-b}return 0},_showSelectedRecords:function(){var a=this.getCurrentTable();a&&a.showSelectedRecords()},_showRelatedRecords:function(){var a=this.configLayerInfos[this.layersIndex];if(a&&a.layerObject)for(var a=a.layerObject.relationships,b=this.featureTables[this.layersIndex].getSelectedRows(),c=0,d=a.length;c<d;c++)this.addNewRelationTab(b,a[c],this.layersIndex)},_showFilter:function(){this.showRefreshing(!0);
this._getLayerDifinition(this.layersIndex).then(e.hitch(this,function(a){if(this.domNode){var b=this.featureTables[this.layersIndex],d=this._getFilterableFields(a.fields,this.config.layerInfos[this.layersIndex].layer.fields);a.fields=d;var f=new p({noFilterTip:this.nls.noFilterTip,style:"width:100%;margin-top:22px;"});this._filterPopup=new c({titleLabel:this.nls.filter,width:680,height:485,content:f,buttons:[{label:this.nls.ok,onClick:e.hitch(this,function(){var a=f.toJson();a&&a.expr?(b.setFilterObj(a),
b.startQuery(),this._filterPopup.close(),this._filterPopup=null):new k({message:this.nls.setFilterTip})})},{label:this.nls.cancel}]});(d=b.getFilterObj())?f.buildByFilterObj(b.layer.url,d,a):f.buildByExpr(b.layer.url,null,a)}}),e.hitch(this,function(a){this.domNode&&console.error(a)})).always(e.hitch(this,function(){this.showRefreshing(!1)}))},_toggleColumns:function(){var a=this.getCurrentTable();a&&a.toggleColumns()},_onExportButton:function(){if(this.config.layerInfos&&0!==this.config.layerInfos.length)var a=
new k({message:this.nls.exportMessage,titleLabel:this.nls.exportFiles,autoHeight:!0,buttons:[{label:this.nls.ok,onClick:e.hitch(this,function(){this.exportToCSV();a.close()})},{label:this.nls.cancel,onClick:e.hitch(this,function(){a.close()})}]})},onZoomButton:function(){var a=this.getCurrentTable();a&&a.zoomTo()},onClickRefreshButton:function(){var a=this.getCurrentTable();a&&(a.grid&&a.grid.clearSelection(),a instanceof x?this.startQuery(this.layersIndex):(this.relationshipsSet[this.currentRelationshipKey].opened=
!1,this._startQueryOnRelationTab(this.currentRelationshipKey)))},_clearSelection:function(){var a=this.getCurrentTable();a&&a.clearSelection()},exportToCSV:function(){var a=this.tabContainer.selectedChildWidget.params,b=this.getCurrentTable();b&&b.exportToCSV().then(e.hitch(this,function(b){this.download(a.title+".csv",b)}))},_isIE11:function(){var a=0,b=/MSIE (\d+\.\d+);/.test(navigator.userAgent),c=!!navigator.userAgent.match(/Trident\/7.0/),d=navigator.userAgent.indexOf("rv:11.0");b&&(a=Number(RegExp.$1));
-1!==navigator.appVersion.indexOf("MSIE 10")&&(a=10);c&&-1!==d&&(a=11);return 11===a},_isEdge:function(){return/Edge\/12/.test(navigator.userAgent)},_getDownloadUrl:function(a){return window.Blob&&window.URL&&window.URL.createObjectURL?(a=new Blob(["\ufeff"+a],{type:"text/csv"}),URL.createObjectURL(a)):"data:attachment/csv;charset\x3dutf-8,\ufeff"+encodeURIComponent(a)},download:function(a,b){if(I("ie")||this._isIE11()||this._isEdge()){var c=window.top.open("about:blank","_blank");c.document.write(b);
c.document.close();c.document.execCommand("SaveAs",!0,a);c.close()}else{c=f.create("a",{href:this._getDownloadUrl(b),target:"_blank",download:a},this.domNode);if(I("safari")){var d=document.createEvent("MouseEvents");d.initEvent("click",!0,!0);c.dispatchEvent(d)}else c.click();f.destroy(c)}},addNewLayerTab:function(a){if(a=this._getLayerInfoById(a.layer.id)||this._getLayerInfoByName(a.layer.name)){var b=this.getLayerInfoId(a);(b=this.getExistLayerTabPage(b))?(this.onOpen(),this.tabContainer.selectChild(b),
this.tabChanged()):(b=B.getConfigInfoFromLayerInfo(a),this.config.layerInfos.push({id:b.id,name:b.name,layer:{url:b.layer.url,fields:b.layer.fields}}),this.configLayerInfos.push(a),this.onOpen(),b={},b.title=this.getLayerInfoLabel(a),b.name=b.title,b.paneId=this.getLayerInfoId(a),b.closable=!0,b.layerType=this._layerTypes.FEATURELAYER,b.style="height: 100%; width: 100%; overflow: visible",a=new h(b),this.layerTabPages.push(a),a.set("title",b.name),this.own(g(a,"close",e.hitch(this,this.layerTabPageClose,
b.paneId))),this.tabContainer.addChild(a),this.tabContainer.selectChild(a))}},addNewRelationTab:function(a,b,c){var d=this.getExistRelationTabPage(b._relKey);d?(b.opened=!1,d.params.oids=a,this.tabContainer.selectChild(d)):(d={},d.oids=a,d.title=b.name,d.name=d.title,d.paneId=b._relKey,d.layersIndex=c,d.closable=!0,d.layerType=this._layerTypes.RELATIONSHIPTABLE,d.style="height: 100%; width: 100%; overflow: visible",a=new h(d),this.relationTabPagesSet[b._relKey]=a,a.set("title",d.name),this.own(g(a,
"close",e.hitch(this,this.relationTabPageClose,d.paneId))),this.tabContainer.addChild(a),this.tabContainer.selectChild(a))},onReceiveData:function(a,b,c){c&&"AttributeTable"===c.target&&(this._isOnlyTable()&&"closed"===this.state?console.warn("Please open Attribute Table!"):this.showing?B.readConfigLayerInfosFromMap(this.map).then(e.hitch(this,function(a){this._allLayerInfos=a;this._processDelayedLayerInfos();this._addLayerToTable(c)})):this._openTable().then(e.hitch(this,function(){this._getLayerInfoById(c.layer.id)?
this._addLayerToTable(c):B.readConfigLayerInfosFromMap(this.map).then(e.hitch(this,function(a){this._allLayerInfos=a;this._processDelayedLayerInfos();this._addLayerToTable(c)}))})))},_addLayerToTable:function(a){var b=null;a.layer.getLayerObject().then(e.hitch(this,function(c){c?(c.id=a.layer.id,c.loaded?this.addNewLayerTab({layer:c}):this.own(g(c,"load",e.hitch(this,this.addNewLayerTab)))):a.url&&(b=new s(a.url),this.own(g(b,"load",e.hitch(this,this.addNewLayerTab))))}),e.hitch(this,function(a){new k({message:a.message||
a})}))},getExistLayerTabPage:function(a){for(var b=this.layerTabPages.length,c=0;c<b;c++)if(this.layerTabPages[c]&&this.layerTabPages[c].get("paneId")===a)return this.layerTabPages[c];return null},getExistRelationTabPage:function(a){return this.relationTabPagesSet[a]},layerTabPageClose:function(a,b){for(var c=this.layerTabPages.length,d=0;d<c;d++)if(this.layerTabPages[d]&&this.layerTabPages[d].paneId===a){!0===b&&this.tabContainer.removeChild(this.layerTabPages[d]);this.featureTables&&this.featureTables.length>=
d&&(this.featureTables[d]&&this.featureTables[d].destroy(),this.featureTables.splice(d,1));this.layerTabPages&&this.layerTabPages[d]&&(this.layerTabPages[d].destroyDescendants(),this.layerTabPages.splice(d,1));if(this.config&&this.config.layerInfos&&this.config.layerInfos[d]){this.config.layerInfos.splice(d,1);this.configLayerInfos.splice(d,1);var f=this._getLayerInfoById(a),f=this._allLayerInfos.indexOf(f);this._allLayerInfos.splice(f,1)}if(1===c){this.layersIndex=-1;this.onClose();return}d<this.layersIndex?
this.layersIndex--:d===this.layersIndex&&(1<c?(this.layersIndex=c-2,this.tabContainer.selectChild(this.layerTabPages[this.layersIndex]),this.tabChanged()):this.layersIndex=0);break}setTimeout(e.hitch(this,function(){this.refreshGridHeight()}),10)},relationTabPageClose:function(a){var b=this.getExistRelationTabPage(a);b&&(this.tabContainer.removeChild(b),this.relationshipTableSet[a]&&(this.relationshipTableSet[a].destroy(),this.relationshipTableSet[a]=null),b&&(b.destroyDescendants(),b.destroy(),this.relationTabPagesSet[a]=
null),this.currentRelationshipKey=null,this.relationshipsSet[a].opened=!1,setTimeout(e.hitch(this,function(){this.refreshGridHeight()}),10))},_processRelatedRecordsFromPopup:function(a,b){var c=this._getLayerIndexById(a.id);-1<c&&this.configLayerInfos[c]&&this.configLayerInfos[c].getLayerObject().then(e.hitch(this,function(d){this.initSelectedLayer(d,c);this._collectRelationShips(d,a);d=d.relationships;for(var e=0,f=d.length;e<f;e++)this.addNewRelationTab(b,d[e],c)}))},showRelatedRecordsFromPopup:function(a,
b){this.showing?B.readConfigLayerInfosFromMap(this.map).then(e.hitch(this,function(c){this._allLayerInfos=c;this._processDelayedLayerInfos();this._processRelatedRecordsFromPopup(a,b)})):this._openTable().then(e.hitch(this,function(){this._getLayerInfoById(a.id)?this._processRelatedRecordsFromPopup(a,b):B.readConfigLayerInfosFromMap(this.map).then(e.hitch(this,function(c){this._allLayerInfos=c;this._processDelayedLayerInfos();this._processRelatedRecordsFromPopup(a,b)}))}))}});m.inPanel=!1;m.hasUIFile=
!1;return m});